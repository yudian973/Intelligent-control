     1                     /*****************************************************************
     2                     * Filename     :  EM78P510_32PIN_TX.ASM
     3                     * Author       :  yu.wei
     4                     * Company      :  ELAN
     5                     * VERSION      :  1.4
     6                     * CRYSTAL	   :  12MHZ
     7                     * Creat date   :  2009/4/13
     8                     * tool ver.    :  WicePlus 2.7
     9                     * Description  :  modify for code conformity
    10                     *****************************************************************/
    11                     ;-----------------------------------------------------------------
    12                     include "EM78P520.H"
     1            C        ;******************************************************;
     2            C        ;                                                      ;
     3            C        ;  Tilte:       EM78x510xx include file                ;
     4            C        ;  Description: The Definition of EM78x510xx Registers ;
     5            C        ;  Company:     Elan Electronic Corp.                  ;
     6            C        ;  Author:      hongxi.tang                            ;
     7            C        ;  Date:        24/05/2006                             ;
     8            C        ;  Version:     v1.0                                   ;
     9            C        ;                                                      ;
    10            C        ;******************************************************;
    11            C        ;
    12            C        ;======================================================;
    13            C        ; Operational Registers Define                         ;
    14            C        ;======================================================;
    15            C        EM78P510.H    EQU    EM78P510.H
    16            C        
    17            C        ;
    18            C        ;======================================================;
    19            C        ; Register R0~R4                                       ;
    20            C        ;======================================================;
    21            C        ;
    22            C        ; Indirect Addressing register
    23            C        ;
    24       0000 C         R0     ==    0x00
    25       0000 C         IAR    ==    0x00
    26            C        ;
    27            C        ; Time Clock/Counter
    28            C        ;
    29       0001 C         R1     ==    0x01
    30       0001 C         TCC    ==    0x01    ; TCC Counter Preset
    31            C        ;
    32            C        ; Program Counter
    33            C        ;
    34       0002 C         R2     ==    0X02
    35       0002 C         PC     ==    0X02
    36            C        ;
    37            C        ; Status Register and Voltage Detect
    38            C        ;
    39       0003 C         R3    ==    0X03
    40       0003 C         SR    ==    0X03
    41       0003 C         STATUS	==	0x03
    42            C        ;
    43            C             ;{
    44       0007 C             	 LVDEN	==    0x07    ; Voltage Detect Enable Bit
    45       0006 C                 LVDS1	==    0x06    ; Detect Voltage Select Bit[1]
    46       0005 C                 LVDS0	==    0x05    ; Detect Voltage Select Bit[0]
    47            C                                       ;
    48            C                                       ; |-------|-------|----------------|
    49            C                                       ; | LVDS1 | LVDS0 | Detect Voltage |
    50            C                                       ; |-------|-------|----------------|
    51            C                                       ; |   0   |   0   |      2.4V      |
    52            C                                       ; |   0   |   1   |      2.7V      |
    53            C                                       ; |   1   |   0   |      3.3V      |
    54            C                                       ; |   1   |   1   |      3.9V      |
    55            C                                       ; |-------|-------|----------------|
    56            C                                       ;
    57       0004 C                 T       ==    0x04    ; Time-Out Bit
    58       0003 C                 P       ==    0x03    ; Power Down Bit
    59       0002 C                 Z       ==    0x02    ; Zero Flag
    60       0001 C                 DC      ==    0x01    ; Auxiliary Carry Flag
    61       0000 C                 C       ==    0x00    ; Carry Flag
    62            C                                       ;
    63            C             ;}
    64            C        ;
    65            C        ; RAM Select Register (RSR)
    66            C        ;
    67       0004 C         R4     ==    0X04
    68       0004 C         RSR    ==    0X04
    69            C             ;{
    70            C                                        ; Bits 5~0 are used to select up to 64 registers in the
    71            C                                        ; indirect addressing mode.
    72            C                                        ;
    73       0007 C                 VDB	  ==    0x07    ; Voltage Detector
    74       0006 C                 BNC      ==    0x06    ; Bank Control Register
    75            C                                        ;
    76       0005 C                 RSR5     ==    0x05    ;
    77       0004 C                 RSR4     ==    0x04    ;
    78       0003 C                 RSR3     ==    0x03    ;
    79       0002 C                 RSR2     ==    0x02    ;
    80       0001 C                 RSR1     ==    0x01    ;
    81       0000 C                 RSR0     ==    0x00    ;
    82            C                                        ;
    83            C             ;}
    84            C        ;======================================================;
    85            C        ; Bank0~6 Register R5~RF                               ;
    86            C        ;======================================================;
    87            C        ;
    88            C        ; Bank0 R5(RAM Bank Select Register)
    89            C        ;
    90       0005 C         B0_R5    ==	0X05
    91       0005 C         BSR      ==    0X05
    92            C        ;
    93            C             ;{
    94            C             				    ; Bit3~7 is "0"
    95       0002 C                 BS2          ==    0x02    ; RAM Bank Select Register Bits[2]
    96       0001 C                 BS1          ==    0x01    ; RAM Bank Select Register Bits[1]
    97       0000 C                 BS0          ==    0x00    ; RAM Bank Select Register Bits[0]
    98            C             ;}
    99            C        ;
   100            C        ; Bank 0 R6(Program Page Select Register)
   101            C        ;
   102       0006 C         B0_R6    ==    0X06
   103       0006 C         PSR      ==    0X06
   104            C        ;
   105            C             ;{
   106            C             			       ; Bit3~7 is "0"
   107       0002 C                 PS2     ==    0x02    ; Program Page Select Register Bits[2]
   108       0001 C                 PS1     ==    0x01    ; Program Page Select Register Bits[1]
   109       0000 C                 PS0     ==    0x00    ; Program Page Select Register Bits[0]
   110            C             ;}
   111            C        ;
   112            C        ; Bank0 R7(Port 7 data Register)
   113            C        ;
   114       0007 C         B0_R7    ==    0X07
   115       0007 C         PORT7    ==    0X07
   116            C        ;
   117            C             ;{
   118       0007 C                 R77     ==    0x07    ; I/O data of P7.7
   119       0006 C                 R76     ==    0x06    ; I/O data of P7.6
   120       0005 C                 R75     ==    0x05    ; I/O data of P7.5
   121       0004 C                 R74     ==    0x04    ; I/O data of P7.4
   122       0003 C                 R73     ==    0x03    ; I/O data of P7.3
   123       0002 C                 R72     ==    0x02    ; I/O data of P7.2
   124       0001 C                 R71     ==    0x01    ; I/O data of P7.1
   125       0000 C                 R70     ==    0x00    ; I/O data of P7.0
   126            C             ;}
   127            C        ;
   128            C        ; Bank0 R8(Port 8 data Register)
   129            C        ;
   130       0008 C         B0_R8    ==    0X08
   131       0008 C         PORT8    ==    0X08
   132            C        ;
   133            C             ;{
   134       0007 C                 R87     ==    0x07    ; I/O data of P8.7
   135       0006 C                 R86     ==    0x06    ; I/O data of P8.6
   136       0005 C                 R85     ==    0x05    ; I/O data of P8.5
   137       0004 C                 R84     ==    0x04    ; I/O data of P8.4
   138       0003 C                 R83     ==    0x03    ; I/O data of P8.3
   139       0002 C                 R82     ==    0x02    ; I/O data of P8.2
   140       0001 C                 R81     ==    0x01    ; I/O data of P8.1
   141       0000 C                 R80     ==    0x00    ; I/O data of P8.0
   142            C             ;}
   143            C        ;
   144            C        ; Bank0 R9(PORT 9 Data Register)
   145            C        ;
   146       0009 C         B0_R9    ==    0X09
   147       0009 C         PORT9    ==    0X09
   148            C        ;
   149            C             ;{
   150       0007 C                 R97     ==    0x07    ; I/O data of P9.7
   151       0006 C                 R96     ==    0x06    ; I/O data of P9.6
   152       0005 C                 R95     ==    0x05    ; I/O data of P9.5
   153       0004 C                 R94     ==    0x04    ; I/O data of P9.4
   154       0003 C                 R93     ==    0x03    ; I/O data of P9.3
   155       0002 C                 R92     ==    0x02    ; I/O data of P9.2
   156       0001 C                 R91     ==    0x01    ; I/O data of P9.1
   157       0000 C                 R90     ==    0X00    ; I/O data of P9.0
   158            C             ;}
   159            C        ;
   160            C        ;  Bank0 RA(PORTA Data Register)
   161            C        ;
   162       000A C         B0_RA	  ==	0X0A
   163       000A C         PORTA	  ==	0X0A
   164            C        ;
   165            C        	;{
   166       0007 C        		RA7	==	0X07	; I/O Data of PA.7
   167       0006 C        		RA6	==	0X06 	; I/O Data of PA.6
   168       0005 C        		RA5	==	0X05	; I/O Data of PA.5
   169       0004 C        		RA4	==	0X04	; I/O Data of PA.4
   170       0003 C        		RA3	==	0X03	; I/O Data of PA.3
   171       0002 C        		RA2	==	0X02	; I/O Data of PA.2
   172       0001 C        		RA1	==	0X01	; I/O Data of PA.1
   173       0000 C        		RA0	==	0X00	; I/O Data of PA.0
   174            C        	;}
   175            C        ;
   176            C        ;  Bank0 RB(PORT8 Data Register)
   177            C        ;
   178       000B C         B0_RB	==	0X0B
   179       000B C         PORTB	==	0X0B
   180            C        ;
   181            C        	;{
   182       0007 C        		RB7	==	0X07	; I/O Data of PB.7
   183       0006 C        		RB6	==	0X06 	; I/O Data of PB.6
   184       0005 C        		RB5	==	0X05	; I/O Data of PB.5
   185       0004 C        		RB4	==	0X04	; I/O Data of PB.4
   186       0003 C        		RB3	==	0X03	; I/O Data of PB.3
   187       0002 C        		RB2	==	0X02	; I/O Data of PB.2
   188       0001 C        		RB1	==	0X01	; I/O Data of PB.1
   189       0000 C        		RB0	==	0X00	; I/O Data of PB.0
   190            C        	;}
   191            C        ;
   192            C        ;  Bank0 RC(System Clock Control Register)
   193            C        ;
   194       000C C         B0_RC	==	0X0C
   195       000C C         SCCR	==	0X0C
   196            C        ;
   197            C        	;{
   198            C        				 ; Bit7 is "0"
   199       0006 C        		CLK2	==  0X06 ;
   200       0005 C        		CLK1	==  0X05 ;
   201       0004 C        		CLK0	==  0X04 ; Main Clock Select Bit for PLL Mode
   202            C        				 ; |------|------|------|------------|---------------|
   203            C        				 ; | CLK2 | CLK1 | CLK0 | Main Clock | Ex:Fs=32.768k |
   204            C        				 ; |------|------|------|------------|---------------|
   205            C        				 ; |  0   |  0   |  0   |   Fs*122   |   3.997 MHz   |
   206            C        				 ; |------|------|------|------------|---------------|
   207            C        				 ; |  0   |  0   |  1   |    Fs*61   |   1.998 MHz   |
   208            C        				 ; |------|------|------|------------|---------------|
   209            C        				 ; |  0   |  1   |  0   |   Fs*61/2  |   0.999 MHz   |
   210            C        				 ; |------|------|------|------------|---------------|
   211            C        				 ; |  0   |  1   |  1   |   Fs*61/4  |   499.7 kHz   |
   212            C        				 ; |------|------|------|------------|---------------|
   213            C        				 ; |  1   |  0   |  0   |   Fs*244   |   7.995 MHz   |
   214            C        				 ; |------|------|------|------------|---------------|
   215            C        				 ; |  1   |  0   |  1   |   Fs*366   |   11.99 MHz   |
   216            C        				 ; |------|------|------|------------|---------------|
   217            C        				 ; |  1   |  1   |  X   |   Fs*488   |   15.99 MHz   |
   218            C        				 ; |------|------|------|------------|---------------|
   219       0003 C        		IDLE	==  0X03 ; Idle Mode Enable Bit.
   220            C        		 		 ; IDLE="0"+SLEP instruction=>sleep mode
   221            C        		 		 ; IDLE="1"+SLEP instruction=>idle mode
   222       0002 C        		BF1	==  0x02 ;
   223       0001 C        		BF0	==  0x01 ; LCD Booster Frequency Select Bit.
   224            C        				 ; |-----|-----|-------------------|
   225            C        				 ; | BF1 | BF0 | Booster frequency |
   226            C        				 ; |-----|-----|-------------------|
   227            C        				 ; |  0  |  0  |        Fs         |
   228            C        				 ; |-----|-----|-------------------|
   229            C        				 ; |  0  |  1  |       Fs/4        |
   230            C        				 ; |-----|-----|-------------------|
   231            C        				 ; |  1  |  0  |       Fs/8        |
   232            C        				 ; |-----|-----|-------------------|
   233            C        				 ; |  1  |  1  |       Fs/16       |
   234            C        				 ; |-----|-----|-------------------|
   235       0000 C        		CPUS	==  0x00 ; CPU Oscillator Source Select.
   236            C        				 ; 0/1=>sub-oscillator(fs)/main oscillator(fm)
   237            C        	;}
   238            C        ;
   239            C        ; Bank0 RD(TCC and WDT Timer control register)
   240            C        ;
   241       000D C         B0_RD	==	0X0D
   242       000D C         TWTCR	==	0X0D
   243            C        ;
   244            C        	;{
   245       0007 C        		WDTE	==  0X07 ; Watchdog Timer Enable.0/1=>disable/enable
   246       0006 C        		WPSR2	==  0X06
   247       0005 C        		WPSR1	==  0X05
   248       0004 C        		WPSR0	==  0X04 ; WDT Prescaler Bits
   249            C        				 ; |-----|-----|-----|-----------|
   250            C        				 ; |WPSR2|WPSR1|WPSR0| Prescaler |
   251            C        				 ; |-----|-----|-----|-----------|
   252            C        				 ; |  0  |  0  |  0  |    1:1    |
   253            C        				 ; |-----|-----|-----|-----------|
   254            C        				 ; |  0  |  0  |  1  |    1:2    |
   255            C        				 ; |-----|-----|-----|-----------|
   256            C        				 ; |  0  |  1  |  0  |    1:4    |
   257            C        				 ; |-----|-----|-----|-----------|
   258            C        				 ; |  0  |  1  |  1  |    1:8    |
   259            C        				 ; |-----|-----|-----|-----------|
   260            C        				 ; |  1  |  0  |  0  |   1:16    |
   261            C        				 ; |-----|-----|-----|-----------|
   262            C        				 ; |  1  |  0  |  1  |   1:32    |
   263            C        				 ; |-----|-----|-----|-----------|
   264            C        				 ; |  1  |  1  |  0  |   1:64    |
   265            C        				 ; |-----|-----|-----|-----------|
   266            C        				 ; |  1  |  1  |  1  |   1:128   |
   267            C        				 ; |-----|-----|-----|-----------|
   268       0003 C        		TCCS	==  0x03 ; TCC Clock Source Select Bit.0/1=>Fm/Fs
   269       0002 C        		TPSR2	==  0x02
   270       0001 C        		TPSR1	==  0X01
   271       0000 C        		TPSR0	==  0X00 ; TCC Prescaler Bits
   272            C        				 ; |-----|-----|-----|-----------|
   273            C        				 ; |TPSR2|TPSR1|TPSR0| Prescaler |
   274            C        				 ; |-----|-----|-----|-----------|
   275            C        				 ; |  0  |  0  |  0  |    1:2    |
   276            C        				 ; |-----|-----|-----|-----------|
   277            C        				 ; |  0  |  0  |  1  |    1:4    |
   278            C        				 ; |-----|-----|-----|-----------|
   279            C        				 ; |  0  |  1  |  0  |    1:8    |
   280            C        				 ; |-----|-----|-----|-----------|
   281            C        				 ; |  0  |  1  |  1  |   1:16    |
   282            C        				 ; |-----|-----|-----|-----------|
   283            C        				 ; |  1  |  0  |  0  |   1:32    |
   284            C        				 ; |-----|-----|-----|-----------|
   285            C        				 ; |  1  |  0  |  1  |   1:64    |
   286            C        				 ; |-----|-----|-----|-----------|
   287            C        				 ; |  1  |  1  |  0  |   1:128   |
   288            C        				 ; |-----|-----|-----|-----------|
   289            C        				 ; |  1  |  1  |  1  |   1:256   |
   290            C        				 ; |-----|-----|-----|-----------|
   291            C        	;}
   292            C        ;
   293            C        ; Bank0 RE (Interrupt Mask Register)
   294            C        ;
   295       000E C         B0_RE	==	0X0E
   296       000E C         RE	==	0X0E							;ADD
   297       000E C         IMR	==	0X0E
   298            C        ;
   299            C        	;{
   300       0007 C        		T1IE	==  0X07 ; Timer1 Interrupt Enable Bit
   301       0006 C        		LVDIE   ==  0X06 ; low Voltage Detect Interrupt Enable Bit
   302       0005 C        		ADIE	==  0X05 ; A/D convert Interrupt Enable Bit
   303       0004 C        		SPIE    ==  0X04 ; SPI transfer Interrupt Enable Bit
   304       0003 C        		URTIE	==  0X03 ; UART transmit Interrupt Enable Bit
   305       0002 C        		EXIE9	==  0X02 ; External interrupt 9 Enable Bit
   306       0001 C        		EXIE8	==  0X01 ; External interrupt 8 Enable Bit
   307       0000 C        		TCIE	==  0X00 ; TCC Overflow Interrupt Enable Bit
   308            C        	;}
   309            C        ;
   310            C        ;  Bank0 RF (Interrupt Status Register)
   311            C        ;
   312       000F C         B0_RF	==	0X0F
   313       000F C         RF     ==  0x0F
   314       000F C         ISR	==	0X0F
   315            C        ;
   316            C        	;{
   317       0007 C        		T1IF	==  0X07 ; interrupt flag of timer1 interrupt
   318       0006 C        		LVDIF	==  0X06 ; interrupt flag of low voltage detector interrupt
   319       0005 C        		ADIF	==  0X05 ; interrupt flag of A/D convert Complete
   320       0004 C        		SPIF	==  0X04 ; interrupt flag of SPI transfer complete
   321       0003 C        		URTIF	==  0X03 ; interrupt flag of UART transfer complete
   322       0002 C        		EXIF9	==  0X02 ; interrupt flag of external interrupt 9 Occur.
   323       0001 C        		EXIF8	==  0X01 ; interrupt flag of external interrupt 8 Occur.
   324       0000 C        		TCIF	==  0X00 ; interrupt flag of TCC Overflow
   325            C        	;}
   326            C        ;
   327            C        ;  Bank1 R5 (LCD Control Register)
   328            C        ;
   329       0005 C         B1_R5	==	0X05
   330       0005 C         LCDCR	==	0X05
   331            C        ;
   332            C        	;{
   333       0007 C        		LCDEN	==  0X07 ; lCD Enable Select Bit.0/1=>disable/enable
   334       0006 C        		LCDTYPE	==  0X06 ; LCD Drive Waveform Type Select Bit
   335       0005 C        		LBS1	==  0x05
   336       0004 C        		LBS0	==  0x04 ; LCD Bias Select Bits
   337            C        				 ; |---|---|---------------|
   338            C        				 ; |BS1|BS0|LCD Bias Select|
   339            C        				 ; |---|---|---------------|
   340            C        				 ; | 0 | 0 |   1/2 Bias    |
   341            C        				 ; |---|---|---------------|
   342            C        				 ; | 0 | 1 |   1/3 Bias    |
   343            C        				 ; |---|---|---------------|
   344            C        				 ; | 1 | X |   1/4 Bias    |
   345            C        				 ; |---|---|---------------|
   346       0003 C        		DS1	==  0x03
   347       0002 C        		DS0	==  0x02 ; LCD Duty Select Bits
   348            C        				 ; |---|---|---------------|
   349            C        				 ; |DS1|DS0|LCD Duty Select|
   350            C        				 ; |---|---|---------------|
   351            C        				 ; | 0 | 0 |    Static     |
   352            C        				 ; |---|---|---------------|
   353            C        				 ; | 0 | 1 |   1/3 Duty    |
   354            C        				 ; |---|---|---------------|
   355            C        				 ; | 1 | 0 |   1/4 Duty    |
   356            C        				 ; |---|---|---------------|
   357            C        				 ; | 1 | 1 |   1/8 Duty    |
   358            C        				 ; |---|---|---------------|
   359       0001 C        		LCDF1	==  0x01 ;
   360       0000 C        		LCDF0	==  0x00 ; LCD Frame Frequency Control Bits
   361            C        				 ; |-----|-----|---------------|---------------|---------------|--------------|
   362            C        				 ; |LCDF1|LCDF0|     Static    |    1/3 Duty   |    1/4 Duty   |   1/8 Duty   |
   363            C        				 ; |-----|-----|---------------|---------------|---------------|--------------|
   364            C        				 ; |  0  |  0  |Fs/(512*1)=64.0|Fs/(172*3)=63.5|Fs/(128*4)=64.0|Fs/(64*8)=64.0|
   365            C        				 ; |-----|-----|---------------|---------------|---------------|--------------|
   366            C        				 ; |  0  |  1  |Fs/(560*1)=58.5|Fs/(188*3)=58.0|Fs/(140*4)=58.5|Fs/(70*8)=58.5|
   367            C        				 ; |-----|-----|---------------|---------------|---------------|--------------|
   368            C        				 ; |  1  |  0  |Fs/(608*1)=53.9|Fs/(204*3)=53.5|Fs/(152*4)=53.9|Fs/(76*8)=53.9|
   369            C        				 ; |-----|-----|---------------|---------------|---------------|--------------|
   370            C        				 ; |  1  |  1  |Fs/(464*1)=70.6|Fs/(156*3)=70.0|Fs/(116*4)=70.6|Fs/(58*8)=70.6|
   371            C        				 ; |-----|-----|---------------|---------------|---------------|--------------|
   372            C        	;}
   373            C        ;
   374            C        ;  Bank1 R6 (LCD Address Register)
   375            C        ;
   376       0006 C         B1_R6	==    0X06
   377       0006 C         LCDAR	==    0X06
   378            C        ;
   379            C        	;{
   380            C        				 ; Bit5~7 is "0"
   381       0004 C        		LCD_A4	==  0x04 ; LCD RAM Address:00H~16H
   382       0003 C        		LCD_A3	==  0x03
   383       0002 C        		LCD_A2  ==  0x02
   384       0001 C        		LCD_A1	==  0x01
   385       0000 C        		LCD_A0	==  0x00
   386            C        	;}
   387            C        ;
   388            C        ; Bank1 R7 (LCD Data Buffer)
   389            C        ;
   390       0007 C         B1_R7	==    0X07
   391       0007 C         LCDBR	==    0X07
   392            C        ;
   393            C        	;{
   394       0007 C        		LCD_D7	==  0x07
   395       0006 C        		LCD_D6	==  0x06
   396       0005 C        		LCD_D5	==  0x05
   397       0004 C        		LCD_D4	==  0x04
   398       0003 C        		LCD_D3	==  0x03
   399       0002 C        		LCD_D2	==  0x02
   400       0001 C        		LCD_D1	==  0x01
   401       0000 C        		LCD_D0	==  0x00
   402            C        	;}
   403            C        ;
   404            C        ;  Bank1 R8 (LCD Voltage Control Register)
   405            C        ;
   406       0008 C         B1_R8	==	0x08
   407       0008 C         LCDVCR	==	0x08
   408            C        ;
   409            C        	;{
   410            C        				 ; Bit5~6 is "0"
   411       0004 C        		LCDC1	==  0x04
   412       0003 C        		LCDC0	==  0x03 ; LCD Clock
   413            C        				 ; |-----|-----|------|--------|
   414            C        				 ; |LCDC1|LCDC0|  Fm  |  Flcd  |
   415            C        				 ; |-----|-----|------|--------|
   416            C        				 ; |  0  |  0  | 16M  | Fc/2^9 |
   417            C        				 ; |-----|-----|------|--------|
   418            C        				 ; |  0  |  1  |  8M  | Fc/2^8 |
   419            C        				 ; |-----|-----|------|--------|
   420            C        				 ; |  1  |  0  |  4M  | Fc/2^7 |
   421            C        				 ; |-----|-----|------|--------|
   422            C        				 ; |  1  |  1  |  2M  | Fc/2^6 |
   423            C        				 ; |-----|-----|------|--------|
   424       0002 C        		LCDVC2	==  0x02
   425       0001 C        		LCDVC1	==  0x01
   426       0000 C        		LCDVC0	==  0x00 ; LCD Voltage Control Bits
   427            C        				 ; |------|------|------|--------------|
   428            C        				 ; |LCDVC2|LCDVC1|LCDVC0|    Output    |
   429            C        				 ; |------|------|------|--------------|
   430            C        				 ; |   0  |   0  |   0  |  0.4VDD~VDD  |
   431            C        				 ; |------|------|------|--------------|
   432            C        				 ; |   0  |   0  |   1  | 0.34VDD~VDD  |
   433            C        				 ; |------|------|------|--------------|
   434            C        				 ; |   0  |   1  |   0  | 0.26VDD~VDD  |
   435            C        				 ; |------|------|------|--------------|
   436            C        				 ; |   0  |   1  |   1  | 0.18VDD~VDD  |
   437            C        				 ; |------|------|------|--------------|
   438            C        				 ; |   1  |   0  |   0  | 0.13VDD~VDD  |
   439            C        				 ; |------|------|------|--------------|
   440            C        				 ; |   1  |   0  |   1  | 0.07VDD~VDD  |
   441            C        				 ; |------|------|------|--------------|
   442            C        				 ; |   1  |   1  |   0  | 0.04VDD~VDD  |
   443            C        				 ; |------|------|------|--------------|
   444            C        				 ; |   1  |   1  |   1  |    0V~VDD    |
   445            C        				 ; |------|------|------|--------------|
   446            C        	;}
   447            C        ;
   448            C        ;  Bank1 R9 (LCD Com Control Register)
   449            C        ;
   450       0009 C         B1_R9	==	0x09
   451       0009 C         LCDCCR	==	0x09
   452            C        ;
   453            C        	;{
   454       0007 C        		COM7	==  0x07 ; 0:I/O Function,1:LCD common driver pin.
   455       0006 C        		COM6	==  0x06
   456       0005 C        		COM5	==  0x05
   457       0004 C        		COM4	==  0x04
   458       0003 C        		COM3	==  0x03
   459       0002 C        		COM2	==  0x02
   460       0001 C        		COM1	==  0x01
   461       0000 C        		COM0	==  0x00
   462            C        	;}
   463            C        ;
   464            C        ;  Bank1 RA (LCD Segment Control Register0)
   465            C        ;
   466       000A C         B1_RA		==	0X0A
   467       000A C         LCDSCR0	==	0X0A
   468            C        ;
   469            C        	;{
   470       0007 C        		SEG7	==  0X07 ; LCD Segment7 Control Bit.0:I/O,1:LCD Driver pin.
   471       0006 C        		SEG6	==  0X06 ; LCD Segment6 Control Bit.0:I/O,1:LCD Driver pin.
   472       0005 C        		SEG5	==  0X05 ; LCD Segment5 Control Bit.0:I/O,1:LCD Driver pin.
   473       0004 C        		SEG4	==  0X04 ; LCD Segment4 Control Bit.0:I/O,1:LCD Driver pin.
   474       0003 C        		SEG3	==  0X03 ; LCD Segment3 Control Bit.0:I/O,1:LCD Driver pin.
   475       0002 C        		SEG2	==  0X02 ; LCD Segment2 Control Bit.0:I/O,1:LCD Driver pin.
   476       0001 C        		SEG1	==  0X01 ; LCD Segment1 Control Bit.0:I/O,1:LCD Driver pin.
   477       0000 C        		SEG0	==  0X00 ; LCD Segment0 Control Bit.0:I/O,1:LCD Driver pin.
   478            C        	;}
   479            C        ;
   480            C        ;  Bank1 RB (LCD Segment Control Register1)
   481            C        ;
   482       000B C         B1_RB		==	0X0B
   483       000B C         LCDSCR1	==	0X0B
   484            C        ;
   485            C        	;{
   486       0007 C        		SEG15	==  0X07 ; LCD Segment15 Control Bit.0:I/O,1:LCD Driver pin.
   487       0006 C        		SEG14	==  0X06 ; LCD Segment14 Control Bit.0:I/O,1:LCD Driver pin.
   488       0005 C        		SEG13	==  0X05 ; LCD Segment13 Control Bit.0:I/O,1:LCD Driver pin.
   489       0004 C        		SEG12	==  0X04 ; LCD Segment12 Control Bit.0:I/O,1:LCD Driver pin.
   490       0003 C        		SEG11	==  0X03 ; LCD Segment11 Control Bit.0:I/O,1:LCD Driver pin.
   491       0002 C        		SEG10	==  0X02 ; LCD Segment10 Control Bit.0:I/O,1:LCD Driver pin.
   492       0001 C        		SEG9	==  0X01 ; LCD Segment9 Control Bit.0:I/O,1:LCD Driver pin.
   493       0000 C        		SEG8	==  0X00 ; LCD Segment8 Control Bit.0:I/O,1:LCD Driver pin.
   494            C        	;}
   495            C        ;
   496            C        ;  Bank1 RC (LCD Segment Control Register2)
   497            C        ;
   498       000C C         B1_RC		==	0X0C
   499       000C C         LCDSCR2	==	0X0C
   500            C        ;
   501            C        	;{
   502            C        				 ; Bit7 not used
   503       0006 C        		SEG22	==  0X06 ; LCD Segment22 Control Bit.0:I/O,1:LCD Driver pin.
   504       0005 C        		SEG21	==  0X05 ; LCD Segment21 Control Bit.0:I/O,1:LCD Driver pin.
   505       0004 C        		SEG20	==  0X04 ; LCD Segment20 Control Bit.0:I/O,1:LCD Driver pin.
   506       0003 C        		SEG19	==  0X03 ; LCD Segment19 Control Bit.0:I/O,1:LCD Driver pin.
   507       0002 C        		SEG18	==  0X02 ; LCD Segment18 Control Bit.0:I/O,1:LCD Driver pin.
   508       0001 C        		SEG17	==  0X01 ; LCD Segment17 Control Bit.0:I/O,1:LCD Driver pin.
   509       0000 C        		SEG16	==  0X00 ; LCD Segment16 Control Bit.0:I/O,1:LCD Driver pin.
   510            C        	;}
   511            C        ;
   512            C        ;  Bank1 RE (External Interrupt Mask Register)
   513            C        ;
   514       000E C         B1_RE	==	0X0E
   515       000E C         EIMR	==	0X0E
   516            C        ;
   517            C        	;{
   518       0007 C        		EXIE7	==  0x07 ; /INT7 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   519       0006 C        		EXIE6	==  0x06 ; /INT6 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   520       0005 C        		EXIE5	==  0x05 ; /INT5 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   521       0004 C        		EXIE4	==  0x04 ; /INT4 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   522       0003 C        		EXIE3	==  0x03 ; /INT3 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   523       0002 C        		EXIE2	==  0x02 ; /INT2 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   524       0001 C        		EXIE1	==  0x01 ; /INT1 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   525       0000 C        		EXIE0	==  0x00 ; /INT0 Interrupt Enable Control Bit.0/1=>Disalbe/Enable.
   526            C        	;}
   527            C        ;
   528            C        ;  Bank1 RF (External Interrupt Status Register)
   529            C        ;
   530       000F C         B1_RF	==	0X0F
   531       000F C         EISR	==	0X0F
   532            C        ;
   533            C        	;{
   534       0007 C        		EXIF7	==  0x07 ; /INT7 Interrupt Flag Bit.
   535       0006 C        		EXIF6	==  0x06 ; /INT6 Interrupt Flag Bit.
   536       0005 C        		EXIF5	==  0x05 ; /INT5 Interrupt Flag Bit.
   537       0004 C        		EXIF4	==  0x04 ; /INT4 Interrupt Flag Bit.
   538       0003 C        		EXIF3	==  0x03 ; /INT3 Interrupt Flag Bit.
   539       0002 C        		EXIF2	==  0x02 ; /INT2 Interrupt Flag Bit.
   540       0001 C        		EXIF1	==  0x01 ; /INT1 Interrupt Flag Bit.
   541       0000 C        		EXIF0	==  0x00 ; /INT0 Interrupt Flag Bit.
   542            C        	;}
   543            C        ;
   544            C        ;  Bank2 R5 (Timer1 Control Register)
   545            C        ;
   546       0005 C         B2_R5	==	0X05
   547       0005 C         T1CR	==	0X05
   548            C        ;
   549            C        	;{
   550       0007 C        		T1S1	==  0x07
   551       0006 C        		T1S0	==  0x06 ; Timer1 and Timer2 Interrupt Type Select Bits.
   552            C        				 ; |----|----|---------------------------------------|
   553            C        				 ; |T1S1|T1S0|Timer1 and Timer2 Interrupt Type Select|
   554            C        				 ; |----|----|---------------------------------------|
   555            C        				 ; |  0 |  0 |           T1PD underflow              |
   556            C        				 ; |----|----|---------------------------------------|
   557            C        				 ; |  0 |  1 |           T1TD underflow              |
   558            C        				 ; |----|----|---------------------------------------|
   559            C        				 ; |  1 |  X |      T1PD and T1TD underflow          |
   560            C        				 ; |----|----|---------------------------------------|
   561       0005 C        		T1MS2	==  0x05
   562       0004 C        		T1MS1	==  0x04
   563       0003 C        		T1MS0	==  0x03 ; Timer1 Operation Mode Select Bits
   564            C        				 ; |-----|-----|-----|-------------------------|
   565            C        				 ; |T1MS2|T1MS1|T1MS0|   Timer1 Mode Select    |
   566            C        				 ; |-----|-----|-----|-------------------------|
   567            C        				 ; |  0  |  0  |  0  |         Timer1          |
   568            C        				 ; |-----|-----|-----|-------------------------|
   569            C        				 ; |  0  |  0  |  1  |        T1OUT Mode       |
   570            C        				 ; |-----|-----|-----|-------------------------|
   571            C        				 ; |  0  |  1  |  0  |Capture Mode Rising Edge |
   572            C        				 ; |-----|-----|-----|-------------------------|
   573            C        				 ; |  0  |  1  |  1  |Capture Mode Falling Edge|
   574            C        				 ; |-----|-----|-----|-------------------------|
   575            C        				 ; |  1  |  0  |  0  |UART Baud Rate Generator |
   576            C        				 ; |-----|-----|-----|-------------------------|
   577            C        				 ; |  1  |  0  |  1  |                         |
   578            C        				 ; |-----|-----|-----|                         |
   579            C        				 ; |  1  |  1  |  0  |          PWM1           |
   580            C        				 ; |-----|-----|-----|                         |
   581            C        				 ; |  1  |  1  |  1  |                         |
   582            C        				 ; |-----|-----|-----|-------------------------|
   583       0002 C        		T1P2	==  0x02
   584       0001 C        		T1P1	==  0x01
   585       0000 C        		T1P0	==  0x00 ; Timer1 Prescaler Bits
   586            C        				 ; |-----|-----|-----|-----------------|
   587            C        				 ; | T1P2| T1P1| T1P0|   Prescalaer    |
   588            C        				 ; |-----|-----|-----|-----------------|
   589            C        				 ; |  0  |  0  |  0  |      1:2        |
   590            C        				 ; |-----|-----|-----|-----------------|
   591            C        				 ; |  0  |  0  |  1  |      1:4        |
   592            C        				 ; |-----|-----|-----|-----------------|
   593            C        				 ; |  0  |  1  |  0  |	    1:8        |
   594            C        				 ; |-----|-----|-----|-----------------|
   595            C        				 ; |  0  |  1  |  1  |      1:16       |
   596            C        				 ; |-----|-----|-----|-----------------|
   597            C        				 ; |  1  |  0  |  0  |      1:32       |
   598            C        				 ; |-----|-----|-----|-----------------|
   599            C        				 ; |  1  |  0  |  1  |      1:64       |
   600            C        				 ; |-----|-----|-----|-----------------|                         |
   601            C        				 ; |  1  |  1  |  0  |      1:128      |
   602            C        				 ; |-----|-----|-----|-----------------|
   603            C        				 ; |  1  |  1  |  1  |      1:256      |
   604            C        				 ; |-----|-----|-----|-----------------|
   605            C        	;}
   606            C        ;
   607            C        ;  Bank2 R6 (Timer Status Register)
   608            C        ;
   609       0006 C         B2_R6	==	0X06
   610       0006 C         TSR	==	0X06
   611            C        ;
   612            C        	;{
   613       0007 C        		T1MOD	==  0X07 ; Timer Operates Mode Select Bit.
   614       0006 C        		TRCB	==  0x06 ; Timer1,2 Read Control Bit.
   615       0005 C        		T1CSS1	==  0x05 ;
   616       0004 C        		T1CSS0	==  0x04 ; Timer1 Clock Source Select Bits
   617            C        				 ; |------|------|--------------------------|
   618            C        				 ; |T1CSS1|T1CSS0|Timer1 Clock Source select|
   619            C        				 ; |------|------|--------------------------|
   620            C        				 ; |  0   |  0   |            Fm            |
   621            C        				 ; |------|------|--------------------------|
   622            C        				 ; |  0   |  1   |            Fs            |
   623            C        				 ; |------|------|--------------------------|
   624            C        				 ; |  1   |  X   |           T1CK           |
   625            C        				 ; |------|------|--------------------------|
   626       0003 C        		T2CSS	==  0x03 ; Timer2 Clock Source Select Bit.0/1=>Fm/Fs.
   627       0002 C        		T1EN	==  0x02 ; Timer1 Start Bit.
   628       0001 C        		T1OMS	==  0x01 ; Timer1 Output Mode Select Bit.0/1=>repeating/on-shot.
   629       0000 C        		T1OC	==  0x00 ; Timer1 Output Flip-Flop Control Bit.
   630            C        	;}
   631            C        ;
   632            C        ;  Bank2 R7 (Timer1 Period Buffer)
   633            C        ;
   634       0007 C         B2_R7	==	0X07
   635       0007 C         T1PD	==	0X07
   636            C        ;
   637            C        ;  Bank2 R8 (Timer1 Duty Buffer)
   638            C        ;
   639       0008 C         B2_R8	==	0X08
   640       0008 C         T1TD	==	0X08
   641            C        ;
   642            C        ;  Bank2 R9 (Timer2 Control Register)
   643            C        ;
   644       0009 C         B2_R9	==	0X09
   645       0009 C         T2CR	==	0X09
   646            C        ;
   647            C        	;{
   648       0007 C        		T2IF	==  0X07 ; Interrupt Flag of Timer2 Interrupt
   649       0006 C        		T2IE	==  0X06 ; Timer2 Interrupt Mask Bit
   650       0005 C        		T2EN	==  0X05 ; Timer2 Start Bit
   651       0005 C        		T2S     ==  0x05 ;
   652       0004 C        		T2MS1	==  0X04 ;
   653       0003 C        		T2MS0	==  0X03 ; Timer2 Operation Mode Select Bits.
   654            C        				 ; |-----|-----|-----------------------|
   655            C        				 ; |T2MS1|T2MS0|   Timer2 Mode Select  |
   656            C        				 ; |-----|-----|-----------------------|
   657            C        				 ; |  0  |  0  |        Timer2         |
   658            C        				 ; |-----|-----|-----------------------|
   659            C        				 ; |  0  |  1  |SPI Baud Rate Generator|
   660            C        				 ; |-----|-----|-----------------------|
   661            C        				 ; |  1  |  0  |                       |
   662            C        				 ; |-----|-----|         PWM2          |
   663            C        				 ; |  1  |  0  |                       |
   664            C        				 ; |-----|-----|-----------------------|
   665       0002 C        		T2P2	==  0x02
   666       0001 C        		T2P1	==  0x01
   667       0000 C        		T2P0	==  0x00 ; Timer2 Prescaler Bits
   668            C        				 ; |-----|-----|-----|-----------------|
   669            C        				 ; | T2P2| T2P1| T2P0|   Prescalaer    |
   670            C        				 ; |-----|-----|-----|-----------------|
   671            C        				 ; |  0  |  0  |  0  |      1:2        |
   672            C        				 ; |-----|-----|-----|-----------------|
   673            C        				 ; |  0  |  0  |  1  |      1:4        |
   674            C        				 ; |-----|-----|-----|-----------------|
   675            C        				 ; |  0  |  1  |  0  |	    1:8        |
   676            C        				 ; |-----|-----|-----|-----------------|
   677            C        				 ; |  0  |  1  |  1  |      1:16       |
   678            C        				 ; |-----|-----|-----|-----------------|
   679            C        				 ; |  1  |  0  |  0  |      1:32       |
   680            C        				 ; |-----|-----|-----|-----------------|
   681            C        				 ; |  1  |  0  |  1  |      1:64       |
   682            C        				 ; |-----|-----|-----|-----------------|                         |
   683            C        				 ; |  1  |  1  |  0  |      1:128      |
   684            C        				 ; |-----|-----|-----|-----------------|
   685            C        				 ; |  1  |  1  |  1  |      1:256      |
   686            C        				 ; |-----|-----|-----|-----------------|
   687            C        	;}
   688            C        ;
   689            C        ;  Bank2 RA (Timer2 Period Buffer)
   690            C        ;
   691       000A C         B2_RA	==	0X0A
   692       000A C         T2PD	==	0X0A
   693            C        ;
   694            C        ; Bank2 RB (Timer Duty Buffer)
   695            C        ;
   696       000B C         B2_RB	==	0X0B
   697       000B C         T2TD	==	0X0B
   698            C        ;
   699            C        ;  Bank2 RC (SPI Status Register)
   700            C        ;
   701       000C C         B2_RC	==	0X0C
   702       000C C         SPIS	==	0X0C
   703            C        ;
   704            C        	;{
   705       0007 C        		DORD	==  0X07 ; Data Shift Control Bit.0/1=>left/right
   706       0006 C        		TD1	==  0X06 ;
   707       0005 C        		TD0	==  0X05 ; SDO Status Output Delay Times Options
   708            C        				 ; |---|---|----------|
   709            C        				 ; |TD1|TD0|Delay Time|
   710            C        				 ; |---|---|----------|
   711            C        				 ; | 0 | 0 |   8 CLK  |
   712            C        				 ; |---|---|----------|
   713            C        				 ; | 0 | 1 |  16 CLK  |
   714            C        				 ; |---|---|----------|
   715            C        				 ; | 1 | 0 |  24 CLK  |
   716            C        				 ; |---|---|----------|
   717            C        				 ; | 1 | 1 |  32 CLK  |
   718            C        				 ; |---|---|----------|
   719            C        				 ; Bit4 Reserved
   720       0003 C        		OD3	==  0X03 ; Open-Drain Control Bit
   721       0002 C        		OD4	==  0X02 ;
   722            C        				 ; Bi1 Reserved
   723       0000 C        		RIBF	==  0X00 ; Read Buffer Full Flag
   724            C        	;}
   725            C        ;
   726            C        ;  Bank2 RD (SPI Control Register)
   727            C        ;
   728       000D C         B2_RD	==	0X0D
   729       000D C         SPIC	==	0X0D
   730            C        ;
   731            C        	;{
   732       0007 C        		CES	==  0X07 ; Clock Edge Select Bit
   733       0006 C        		SPIEB	==  0X06 ; SPI Enable Bit
   734       0005 C        		SRO	==  0X05 ; SPI Read Overflow Bit
   735       0004 C        		SSE	==  0X04 ; SPI Shift Enable Bit
   736       0003 C        		SDOC	==  0X03 ; SDO Output Status Control Bit
   737       0002 C        		SBRS2	==  0X02
   738       0001 C        		SBRS1	==  0X01
   739       0000 C        		SBRS0	==  0X00 ; SPI Baud Rate Select Bits
   740            C        				 ; |-----|-----------|--------|-------------------|
   741            C        				 ; |SBRS2|SBRS1|SBRS0|  Mode  |   SPI Baud Rate   |
   742            C        				 ; |-----|-----------|--------|-------------------|
   743            C        				 ; |  0  |  0  |  0  | Master |       Fcsc/2      |
   744            C        				 ; |-----|-----------|--------|-------------------|
   745            C        				 ; |  0  |  0  |  1  | Master |       Fcsc/4      |
   746            C        				 ; |-----|-----------|--------|-------------------|
   747            C        				 ; |  0  |  1  |  0  | Master |       Fcsc/8      |
   748            C        				 ; |-----|-----------|--------|-------------------|
   749            C        				 ; |  0  |  1  |  1  | Master |      Fcsc/16      |
   750            C        				 ; |-----|-----------|--------|-------------------|
   751            C        				 ; |  1  |  0  |  0  | Master |      Fcsc/32      |
   752            C        				 ; |-----|-----------|--------|-------------------|
   753            C        				 ; |  1  |  0  |  1  | Master |       Timer2      |
   754            C        				 ; |-----|-----------|--------|-------------------|
   755            C        				 ; |  1  |  1  |  0  | Slave  |     /SS enable    |
   756            C        				 ; |-----|-----------|--------|-------------------|
   757            C        				 ; |  1  |  1  |  1  | Slave  |     /SS enable    |
   758            C        				 ; |-----|-----------|--------|-------------------|
   759            C        	;}
   760            C        ;
   761            C        ;  Bank2 RE (SPI Read Buffer)
   762            C        ;
   763       000E C         B2_RE	==	0X0E
   764       000E C         SPIR	==	0X0E
   765            C        ;
   766            C        ;  Bank2 RF (SPI Write Buffer)
   767            C        ;
   768       000F C         B2_RF	==	0X0F
   769       000F C         SPIW	==	0X0F
   770            C        ;
   771            C        ;  Bank3 R5 (UART Control Register)
   772            C        ;
   773       0005 C         B3_R5	==	0X05
   774       0005 C         URC	==	0X05
   775            C        ;
   776            C        	;{
   777       0007 C        		URTD8	==  0X07 ; Transmission Data Bit8
   778       0006 C        		UMODE1	==  0X06
   779       0005 C        		UM0DE0	==  0X05 ; UART Transmission Mode Select Bit
   780            C        				 ; |------|------|-----------|
   781            C        				 ; |UMODE1|UMODE0| UART Mode |
   782            C        				 ; |  0   |   0  |Mode1:7-Bit|
   783            C        				 ; |------|------|-----------|
   784            C        				 ; |  0   |   1  |Mode1:8-Bit|
   785            C        				 ; |------|------|-----------|
   786            C        				 ; |  1   |   0  |Mode1:9-Bit|
   787            C        				 ; |------|------|-----------|
   788            C        				 ; |  1   |   1  | Reserved  |
   789            C        				 ; |------|------|-----------|
   790       0004 C        		BRATE2	==  0X04
   791       0003 C        		BRATE1	==  0X03
   792       0002 C        		BRATE0	==  0X02 ; Transmit Baud Rate Select(Tuart=Fc/16)
   793            C        				 ; |------|------|------|-------------|-------------|
   794            C        				 ; |BRATE2|BRATE1|BRATE0|  Baud Rate  | e.g.FC=8Mhz |
   795            C        				 ; |------|------|------|-------------|-------------|
   796            C        				 ; |  0   |  0   |  0   |   Tuart/13  |    38400    |
   797            C        				 ; |------|------|------|-------------|-------------|
   798            C        				 ; |  0   |  0   |  1   |   Tuart/26  |    19200    |
   799            C        				 ; |------|------|------|-------------|-------------|
   800            C        				 ; |  0   |  1   |  0   |   Tuart/52  |     9600    |
   801            C        				 ; |------|------|------|-------------|-------------|
   802            C        				 ; |  0   |  1   |  1   |  Tuart/104  |     4800    |
   803            C        				 ; |------|------|------|-------------|-------------|
   804            C        				 ; |  1   |  0   |  0   |  Tuart/208  |     2400    |
   805            C        				 ; |------|------|------|-------------|-------------|
   806            C        				 ; |  1   |  0   |  1   |  Tuart/416  |     1200    |
   807            C        				 ; |------|------|------|---------------------------|
   808            C        				 ; |  1   |  1   |  0   |            Timer1         |
   809            C        				 ; |------|------|------|---------------------------|
   810            C        				 ; |  1   |  1   |  1   |           Reserved        |
   811            C        				 ; |------|------|------|---------------------------|
   812       0001 C        		UTBE ==  0X01
   813       0000 C        		TXE	 ==  0X00 ; Enable transmission
   814            C        	;}
   815            C        ;
   816            C        ;  Bank 3 R6 (UART Status)
   817            C        ;
   818       0006 C         B3_R6	==  0X06
   819       0006 C         URS	==  0X06
   820            C        ;
   821            C        	;{
   822       0007 C        		URRD8	==  0X07 	; Receiving Data Bit8
   823       0006 C        		EVEN	==  0X06 	; Select Parity Check
   824       0005 C        		PRE		==  0X05	; Enable Parity Check
   825       0004 C        		PRERR	==  0X04 	; Parity Error Flag
   826       0003 C        		OVERR	==  0X03 	; Over Running Error Flag
   827       0002 C        		FMERR	==  0X02 	; Framing Error Flag
   828       0001 C        		URBF	==  0X01 	; UART Read Buffer Full Flag
   829       0000 C        		RXE	==  0X00 		; Enable Receiving
   830            C        	;}
   831            C        ;
   832            C        ;  Bank3 R7 (UART_RD Data Buffer)
   833            C        ;
   834       0007 C         B3_R7	==	0X07
   835       0007 C         URRD	==	0X07
   836            C        ;
   837            C        ;  Bank3 R8 (UART_TD Data Buffer)
   838            C        ;
   839       0008 C         B3_R8	==	0X08
   840       0008 C         URTD	==	0X08
   841            C        ;
   842            C        ;  Bank3 R9 (A/D Control Register)
   843            C        ;
   844       0009 C         B3_R9	==	0X09
   845       0009 C         ADCR	==	0X09
   846            C        ;
   847            C        	;{
   848       0007 C        		ADRUN	==  0X07 ; AD Conversion Start
   849       0006 C        		ADP	==  0X06 ; A/D Power Control
   850       0005 C        		ADCK1	==  0X05
   851       0004 C        		ADCK0	==  0X04 ; A/D Input Select Bits
   852            C        				 ; |-----|-----|------------|---------------------------|
   853            C        				 ; |ADCK1|ADCK0|Clock Source|Max.Operating Frequency(Fc)|
   854            C        				 ; |-----|-----|------------|---------------------------|
   855            C        				 ; |  0	 |  0  |    Fc/4    |           1MHz            |
   856            C        				 ; |-----|-----|------------|---------------------------|
   857            C        				 ; |  0	 |  1  |   Fc/16    |           4MHz            |
   858            C        				 ; |-----|-----|------------|---------------------------|
   859            C        				 ; |  1	 |  0  |   Fc/32    |           8MHz            |
   860            C        				 ; |-----|-----|------------|---------------------------|
   861            C        				 ; |  1	 |  1  |   Fc/64    |          16MHz            |
   862            C        				 ; |-----|-----|------------|---------------------------|
   863       0003 C        		ADIS3	==  0X03
   864       0002 C        		ADIS2	==  0X02
   865       0001 C        		ADIS1	==  0X01
   866       0000 C        		ADIS0	==  0X00 ; A/D Input Select Bits
   867            C        				 ; |-----|-----|-----|----------------------|
   868            C        				 ; |ADIS3|ADIS2|ADIS1|ADIS0|Analog Input Pin|
   869            C        				 ; |-----|-----|-----|----------------------|
   870            C        				 ; |  0  |  0  |  0  |  0  |      AD0       |
   871            C        				 ; |-----|-----|-----|----------------------|
   872            C        				 ; |  0  |  0  |  0  |  1  |      AD1       |
   873            C        				 ; |-----|-----|-----|----------------------|
   874            C        				 ; |  0  |  0  |  1  |  0  |      AD2       |
   875            C        				 ; |-----|-----|-----|----------------------|
   876            C        				 ; |  0  |  0  |  1  |  1  |      AD3       |
   877            C        				 ; |-----|-----|-----|----------------------|
   878            C        				 ; |  0  |  1  |  0  |  0  |      AD4       |
   879            C        				 ; |-----|-----|-----|----------------------|
   880            C        				 ; |  0  |  1  |  0  |  1  |      AD5       |
   881            C        				 ; |-----|-----|-----|----------------------|
   882            C        				 ; |  0  |  1  |  1  |  0  |      AD6       |
   883            C        				 ; |-----|-----|-----|----------------------|
   884            C        				 ; |  0  |  1  |  1  |  1  |      AD7       |
   885            C        				 ; |-----|-----|-----|----------------------|
   886            C        				 ; |  1  |  0  |  0  |  0  |      AD8       |
   887            C        				 ; |-----|-----|-----|----------------------|
   888            C        				 ; |  1  |  0  |  0  |  1  |      AD9       |
   889            C        				 ; |-----|-----|-----|----------------------|
   890            C        				 ; |  1  |  0  |  1  |  0  |      AD10      |
   891            C        				 ; |-----|-----|-----|----------------------|
   892            C        				 ; |  1  |  0  |  1  |  1  |      AD11      |
   893            C        				 ; |-----|-----|-----|----------------------|
   894            C        	;}
   895            C        ;
   896            C        ;  Bank3 RA (A/D Input Control Register)
   897            C        ;
   898       000A C         B3_RA	==	0X0A
   899       000A C         ADICH	==	0X0A
   900            C        ;
   901            C        	;{
   902       0007 C        		CALI	==  0X07 ; Calibration Enable Bit for A/D Offset
   903       0006 C        		ADREF	==  0X06 ; AD Reference Voltage Input Select
   904            C        				 ; Bit4~5:Reserved
   905       0003 C        		ADE11	==  0X03 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   906       0002 C        		ADE10	==  0X02 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   907       0001 C        		ADE9	==  0x01 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   908       0000 C        		ADE8	==  0X00 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   909            C        	;}
   910            C        ;
   911            C        ;  Bank3 RB (A/D Input Control Register)
   912            C        ;
   913       000B C         B3_RB	==	0X0B
   914       000B C         ADICL	==	0X0B
   915            C        ;
   916            C        	;{
   917       0007 C        		ADE7	==  0X07 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   918       0006 C        		ADE6	==  0X06 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   919       0005 C        		ADE5	==  0x05 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   920       0004 C        		ADE4	==  0X04 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   921       0003 C        		ADE3	==  0X03 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   922       0002 C        		ADE2	==  0X02 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   923       0001 C        		ADE1	==  0x01 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   924       0000 C        		ADE0	==  0X00 ; AD Input Pin Enalbe Control.0//1=>I/O//Analog.
   925            C        	;}
   926            C        ;
   927            C        ;  Bank3 RC (A/D High 8-bits Data Buffer)
   928            C        ;
   929       000C C         B3_RC	==	0X0C
   930       000C C         ADDH	==	0X0C
   931            C        ;
   932            C        ;  Bank3 RD (A/D Low 4-bits Data Buffer)
   933            C        ;
   934       000D C         B3_RD	==	0X0D
   935       000D C         ADDL	==	0X0D
   936            C        ;
   937            C        	;{
   938       0007 C        		SIGN	==  0X07 ; Polarity Bit of Offset Voltage.0/1=>Negative/Positive
   939       0006 C        		VOF2	==  0X06
   940       0005 C        		VOF1	==  0X05
   941       0004 C        		VOF0	==  0X04 ; Offset Voltage Bits.
   942            C        				 ; |----|----|----|---------|
   943            C        				 ; |VOF2|VOF1|VOF0|EM78P510N|
   944            C        				 ; |----|----|----|---------|
   945            C        				 ; |  0 |  0 |  0 |   0LSB  |
   946            C        				 ; |----|----|----|---------|
   947            C        				 ; |  0 |  0 |  1 |   2LSB  |
   948            C        				 ; |----|----|----|---------|
   949            C        				 ; |  0 |  1 |  0 |   4LSB  |
   950            C        				 ; |----|----|----|---------|
   951            C        				 ; |  0 |  1 |  1 |   6LSB  |
   952            C        				 ; |----|----|----|---------|
   953            C        				 ; |  1 |  0 |  0 |   8LSB  |
   954            C        				 ; |----|----|----|---------|
   955            C        				 ; |  1 |  0 |  1 |  10LSB  |
   956            C        				 ; |----|----|----|---------|
   957            C        				 ; |  1 |  1 |  0 |  12LSB  |
   958            C        				 ; |----|----|----|---------|
   959            C        				 ; |  1 |  1 |  1 |  14LSB  |
   960            C        				 ; |----|----|----|---------|
   961       0003 C        		ADD3	==  0X03
   962       0002 C        		ADD2	==  0X02
   963       0001 C        		ADD1	==  0X01
   964       0000 C        		ADD0	==  0X00
   965            C        	;}
   966            C        ;
   967            C        ;  Bank3 RE (External Interrupt Edge Select Control Register High Byte)
   968            C        ;
   969       000E C         B3_RE	==	0X0E
   970       000E C         EIESH	==	0X0E
   971            C        ;
   972            C        	;{
   973       0007 C        		EIES7	==  0X07 ; External Interrupt 7 Edge Select Bit.0/1=>Falling/Rising
   974       0006 C        		EIES6	==  0X06 ; External Interrupt 6 Edge Select Bit.0/1=>Falling/Rising
   975       0005 C        		EIES5	==  0X05 ; External Interrupt 5 Edge Select Bit.0/1=>Falling/Rising
   976       0004 C        		EIES4	==  0X04 ; External Interrupt 4 Edge Select Bit.0/1=>Falling/Rising
   977       0003 C        		EIES3	==  0X03 ; External Interrupt 3 Edge Select Bit.0/1=>Falling/Rising
   978       0002 C        		EIES2	==  0X02 ; External Interrupt 2 Edge Select Bit.0/1=>Falling/Rising
   979       0001 C        		EIES1	==  0X01 ; External Interrupt 1 Edge Select Bit.0/1=>Falling/Rising
   980       0000 C        		EIES0	==  0X00 ; External Interrupt 0 Edge Select Bit.0/1=>Falling/Rising
   981            C        	;}
   982            C        ;
   983            C        ;  Bank3 RF (External Interrupt Edge Select Control Register Low Byte)
   984            C        ;
   985       000F C         B3_RF	==	0X0F
   986       000F C         EIESL	==	0X0F
   987            C        ;
   988            C        	;{
   989            C        				 ;Bit4~7 is "0"
   990       0004 C        		ADWK	==  0X04 ; A/D Converter Wake Up Function Enable Bit
   991       0003 C        		INTWK9	==  0X03 ; External Interrupt 9 Wake Up Function Enable Bit
   992       0002 C        		INTWK8	==  0X02 ; External Interrupt 8 Wake Up Function Enable Bit
   993       0001 C        		EIES9	==  0X01 ; External Interrupt 9 Edge Select Bit
   994       0000 C        		EIES8	==  0x00 ; External Interrupt 8 Edge Select Bit
   995            C        	;}
   996            C        ;
   997            C        ;  Bank4 R5 (LED Drive Control Register)
   998            C        ;
   999       0005 C         B4_R5	==	0X05
  1000       0005 C         LEDDCR	==	0X05
  1001            C        ;
  1002            C        	;{
  1003       0007 C        		LEDD7	==  0X07 ; 0:P9.7 as normal I/O,1:P9.7 as LED direct drive I/O.
  1004       0006 C        		LEDD6	==  0X06 ; 0:P9.6 as normal I/O,1:P9.6 as LED direct drive I/O.
  1005       0005 C        		LEDD5	==  0X05 ; 0:P9.5 as normal I/O,1:P9.5 as LED direct drive I/O.
  1006       0004 C        		LEDD4	==  0X04 ; 0:P9.4 as normal I/O,1:P9.4 as LED direct drive I/O.
  1007       0003 C        		LEDD3	==  0X03 ; 0:P9.3 as normal I/O,1:P9.3 as LED direct drive I/O.
  1008       0002 C        		LEDD2	==  0X02 ; 0:P9.2 as normal I/O,1:P9.2 as LED direct drive I/O.
  1009       0001 C        		LEDD1	==  0X01 ; 0:P9.1 as normal I/O,1:P9.1 as LED direct drive I/O.
  1010       0000 C        		LEDD0	==  0X00 ; 0:P9.0 as normal I/O,1:P9.0 as LED direct drive I/O.
  1011            C        	;}
  1012            C        ;
  1013            C        ;  Bank4 R6 (Watch Timer and Buzzer Control Register)
  1014            C        ;
  1015       0006 C         B4_R6	==	0X06
  1016       0006 C         WBCR	==	0X06
  1017            C        ;
  1018            C        	;{
  1019       0007 C        		WTCS	==  0X07 ; Watch Timer and Buzzer Clock Source Select Bit.
  1020       0006 C        		WTIE	==  0X06 ; Watch Timer Enable Bit and Interrupt Mask
  1021       0005 C        		WTIF	==  0X05 ; Watch Timer Interrupt Flag
  1022       0004 C        		WTSSB1	==  0X04 ;
  1023       0003 C        		WTSSB0  ==  0X03 ; Watch Timer Interval Select Bits
  1024            C        				 ; |------|------|-----------------------------------|
  1025            C        				 ; |WTSSB1|WTSSB0|Watch Timer Interval Select(WTCS=1)|
  1026            C        				 ; |  0   |   0  |                1.0S               |
  1027            C        				 ; |------|------|-----------------------------------|
  1028            C        				 ; |  0   |   1  |                0.5S               |
  1029            C        				 ; |------|------|-----------------------------------|
  1030            C        				 ; |  1   |   0  |               0.25S               |
  1031            C        				 ; |------|------|-----------------------------------|
  1032            C        				 ; |  1   |   1  |              3.91MS               |
  1033            C        				 ; |------|------|-----------------------------------|
  1034       0002 C        		BUZE	==  0X02 ; Buzzer Enable and PORT91 as Buzzer Output Pin
  1035       0001 C        		BSSB1	==  0X01
  1036       0000 C        		BSSB0	==  0X00 ; Buzzer Output Frequency Select Bits
  1037            C        				 ; |-----|-----|----------------------------|
  1038            C        				 ; |BSSB1|BSSB0|Buzzer Signal Select(WTCS=1)|
  1039            C        				 ; |-----|-----|----------------------------|
  1040            C        				 ; |  0  |  0  |           0.5KHz           |
  1041            C        				 ; |-----|-----|----------------------------|
  1042            C        				 ; |  0  |  1  |           1.0KHz           |
  1043            C        				 ; |-----|-----|----------------------------|
  1044            C        				 ; |  1  |  0  |           2.0KHz           |
  1045            C        				 ; |-----|-----|----------------------------|
  1046            C        				 ; |  1  |  1  |           4.0KHz           |
  1047            C        				 ; |-----|-----|----------------------------|
  1048            C        	;}
  1049            C        ;
  1050            C        ;  Bank4 R7 (PORT7 I/O Control Register)
  1051            C        ;
  1052       0007 C         B4_R7	==	0X07
  1053       0007 C         IOC7	==	0X07
  1054       0007 C         P7IOCR	==	0X07
  1055            C        ;
  1056            C        ;  Bank4 R8 (PORT8 I/O Control Register)
  1057            C        ;
  1058       0008 C         B4_R8	==	0X08
  1059       0008 C         IOC8	==	0X08
  1060       0008 C         P8IOCR	==	0X08
  1061            C        ;
  1062            C        ;  Bank4 R9 (PORT9 I/O Control Register)
  1063            C        ;
  1064       0009 C         B4_R9	==	0X09
  1065       0009 C         IOC9	==	0X09
  1066       0009 C         P9IOCR	==	0X09
  1067            C        ;
  1068            C        ;  Bank4 RA (PORTA I/O Control Register)
  1069            C        ;
  1070       000A C         B4_RA	==	0X0A
  1071       000A C         IOCA	==	0X0A
  1072       000A C         PAIOCR	==	0X0A
  1073            C        ;
  1074            C        ;  Bank4 RB (PORTB I/O Control Register)
  1075            C        ;
  1076       000B C         B4_RB	==	0X0B
  1077       000B C         IOCB	==	0X0B
  1078       000B C         PBIOCR	==	0X0B
  1079            C        ;
  1080            C        ;  Bank4 RC (PORTC I/O Control Register)
  1081            C        ;
  1082       000C C         B4_RC	==	0X0C
  1083       000C C         IOCC	==	0X0C
  1084       000C C         PCIOCR	==	0X0C
  1085            C        ;
  1086            C        ;  Bank4 RF (Wake Up Control Register)
  1087            C        ;
  1088       000F C         B4_RF	==	0X0F
  1089       000F C         WKCR	==	0X0F
  1090            C        ;
  1091            C        	;{
  1092       0007 C        		INTWK7	==  0X07 ; External Interrupt 7 Wake Up Function Enable Bit.
  1093       0006 C        		INTWK6	==  0X06 ; External Interrupt 6 Wake Up Function Enable Bit.
  1094       0005 C        		INTWK5	==  0X05 ; External Interrupt 5 Wake Up Function Enable Bit.
  1095       0004 C        		INTWK4	==  0X04 ; External Interrupt 4 Wake Up Function Enable Bit.
  1096       0003 C        		INTWK3	==  0X03 ; External Interrupt 3 Wake Up Function Enable Bit.
  1097       0002 C        		INTWK2	==  0X02 ; External Interrupt 2 Wake Up Function Enable Bit.
  1098       0001 C        		INTWK1	==  0X01 ; External Interrupt 1 Wake Up Function Enable Bit.
  1099       0000 C        		INTWK0	==  0X00 ; External Interrupt 0 Wake Up Function Enable Bit.
  1100            C        	;}
  1101            C        ;
  1102            C        ;  Bank4 R6 (UART Control Register 2)
  1103            C        ;
  1104       0006 C         B5_R6	==	0X06
  1105       0006 C         UARC2	==	0X06
  1106            C        ;
  1107            C        	;{
  1108       0005 C        		UARTE	==  0X05  ; UART Function Enable
  1109       0003 C        		UINVEN	==  0X03  ; Enable UART TX and RX Port Inverse Ouput
  1110            C        				  ; other Bits is "0"
  1111            C        	;}
  1112            C        ;
  1113            C        ; Bank5 R7 (PORT7 Pull High Control Register)
  1114            C        ;
  1115       0007 C         B5_R7	==	0X07
  1116       0007 C         P7PHCR	==	0X07
  1117            C        ;
  1118            C        	;{
  1119       0007 C        		PH77	==  0X07 ;
  1120       0006 C        		PH76	==  0X06 ;
  1121       0005 C        		PH75	==  0X05 ;
  1122       0004 C        		PH74	==  0X04 ;
  1123       0003 C        		PH73	==  0X03 ;
  1124       0002 C        		PH72	==  0X02 ;
  1125       0001 C        		PH71	==  0X01 ;
  1126       0000 C        		PH70	==  0X00 ;
  1127            C        	;}
  1128            C        ;
  1129            C        ; Bank5 R8 (PORT8 Pull High Control Register)
  1130            C        ;
  1131       0008 C         B5_R8	==	0X08
  1132       0008 C         P8PHCR	==	0X08
  1133            C        ;
  1134            C        	;{
  1135       0007 C        		PH87	==  0X07 ;
  1136       0006 C        		PH86	==  0X06 ;
  1137       0005 C        		PH85	==  0X05 ;
  1138       0004 C        		PH84	==  0X04 ;
  1139       0003 C        		PH83	==  0X03 ;
  1140       0002 C        		PH82	==  0X02 ;
  1141       0001 C        		PH81	==  0X01 ;
  1142       0000 C        		PH80	==  0X00 ;
  1143            C        	;}
  1144            C        ;
  1145            C        ; Bank5 R9 (PORT9 Pull High Control Register)
  1146            C        ;
  1147       0009 C         B5_R9	==	0X09
  1148       0009 C         P9PHCR	==	0X09
  1149            C        ;
  1150            C        	;{
  1151       0007 C        		PH97	==  0X07 ;
  1152       0006 C        		PH96	==  0X06 ;
  1153       0005 C        		PH95	==  0X05 ;
  1154       0004 C        		PH94	==  0X04 ;
  1155       0003 C        		PH93	==  0X03 ;
  1156       0002 C        		PH92	==  0X02 ;
  1157       0001 C        		PH91	==  0X01 ;
  1158       0000 C        		PH90	==  0X00 ;
  1159            C        	;}
  1160            C        ;
  1161            C        ; Bank5 RA (PORTA Pull High Control Register)
  1162            C        ;
  1163       000A C         B5_RA	==	0X0A
  1164       000A C         PAPHCR	==	0X0A
  1165            C        ;
  1166            C        	;{
  1167       0007 C        		PHA7	==  0X07 ;
  1168       0006 C        		PHA6	==  0X06 ;
  1169       0005 C        		PHA5	==  0X05 ;
  1170       0004 C        		PHA4	==  0X04 ;
  1171       0003 C        		PHA3	==  0X03 ;
  1172       0002 C        		PHA2	==  0X02 ;
  1173       0001 C        		PHA1	==  0X01 ;
  1174       0000 C        		PHA0	==  0X00 ;
  1175            C        	;}
  1176            C        ;
  1177            C        ; Bank5 RB (PORTB Pull High Control Register)
  1178            C        ;
  1179       000B C         B5_RB	==	0X0B
  1180       000B C         PBPHCR	==	0X0B
  1181            C        ;
  1182            C        	;{
  1183       0007 C        		PHB7	==  0X07 ;
  1184       0006 C        		PHB6	==  0X06 ;
  1185       0005 C        		PHB5	==  0X05 ;
  1186       0004 C        		PHB4	==  0X04 ;
  1187       0003 C        		PHB3	==  0X03 ;
  1188       0002 C        		PHB2	==  0X02 ;
  1189       0001 C        		PHB1	==  0X01 ;
  1190       0000 C        		PHB0	==  0X00 ;
  1191            C        	;}
  1192            C        ;
  1193            C        ; Bank5 RC (PORTC Pull High Control Register)
  1194            C        ;
  1195       000C C         B5_RC	==	0X0C
  1196       000C C         PCPHCR	==	0X0C
  1197            C        ;
  1198            C        	;{
  1199       0003 C        		PHC3	==  0X03 ;
  1200       0002 C        		PHC2	==  0X02 ;
  1201       0001 C        		PHC1	==  0X01 ;
  1202       0000 C        		PHC0	==  0X00 ;
  1203            C        				 ; Other Bits is "0"
  1204            C        	;}
  1205            C        ;
  1206            C        ;  Bank6 R6 (Low Voltage Reset Control Register)
  1207            C        ;
  1208       0006 C         B6_R6  ==  0x06
  1209       0006 C         LVRCR  ==  0x06
  1210            C        ;
  1211            C            ;{
  1212       0002 C                LVREN   ==  0x02 ;
  1213       0001 C                LVRS1   ==  0x01 ;
  1214       0000 C                LVRS0   ==  0x00 ;
  1215            C            ;}
  1216            C        
  1217            C        ;  Bank6 R7 (PORT7 Open Drain Control Reister)
  1218            C        ;
  1219       0007 C         B6_R7	==	0X07
  1220       0007 C         P7ODCR	==	0X07
  1221            C        ;
  1222            C        	;{
  1223       0007 C        		P7OD7	==  0X07 ;
  1224       0006 C        		P7OD6	==  0X06 ;
  1225       0005 C        		P7OD5	==  0X05 ;
  1226       0004 C        		P7OD4	==  0X04 ;
  1227       0003 C        		P7OD3	==  0X03 ;
  1228       0002 C        		P7OD2	==  0X02 ;
  1229       0001 C        		P7OD1	==  0X01 ;
  1230       0000 C        		P7OD0	==  0X00 ;
  1231            C        	;}
  1232            C        ;
  1233            C        ;  Bank6 R8 (PORT8 Open Drain Control Reister)
  1234            C        ;
  1235       0008 C         B6_R8	==	0X08
  1236       0008 C         P8ODCR	==	0X08
  1237            C        ;
  1238            C        	;{
  1239       0007 C        		P8OD7	==  0X07 ;
  1240       0006 C        		P8OD6	==  0X06 ;
  1241       0005 C        		P8OD5	==  0X05 ;
  1242       0004 C        		P8OD4	==  0X04 ;
  1243       0003 C        		P8OD3	==  0X03 ;
  1244       0002 C        		P8OD2	==  0X02 ;
  1245       0001 C        		P8OD1	==  0X01 ;
  1246       0000 C        		P8OD0	==  0X00 ;
  1247            C        	;}
  1248            C        ;
  1249            C        ;  Bank6 R9 (PORT9 Open Drain Control Reister)
  1250            C        ;
  1251       0009 C         B6_R9	==	0X09
  1252       0009 C         P9ODCR	==	0X09
  1253            C        ;
  1254            C        	;{
  1255       0007 C        		P9OD7	==  0X07 ;
  1256       0006 C        		P9OD6	==  0X06 ;
  1257       0005 C        		P9OD5	==  0X05 ;
  1258       0004 C        		P9OD4	==  0X04 ;
  1259       0003 C        		P9OD3	==  0X03 ;
  1260       0002 C        		P9OD2	==  0X02 ;
  1261       0001 C        		P9OD1	==  0X01 ;
  1262       0000 C        		P9OD0	==  0X00 ;
  1263            C        	;}
  1264            C        ;
  1265            C        ;  Bank6 RA (PORTA Open Drain Control Reister)
  1266            C        ;
  1267       000A C         B6_RA	==	0X0A
  1268       000A C         PAODCR	==	0X0A
  1269            C        ;
  1270            C        	;{
  1271       0007 C        		PAOD7	==  0X07 ;
  1272       0006 C        		PAOD6	==  0X06 ;
  1273       0005 C        		PAOD5	==  0X05 ;
  1274       0004 C        		PAOD4	==  0X04 ;
  1275       0003 C        		PAOD3	==  0X03 ;
  1276       0002 C        		PAOD2	==  0X02 ;
  1277       0001 C        		PAOD1	==  0X01 ;
  1278       0000 C        		PAOD0	==  0X00 ;
  1279            C        	;}
  1280            C        ;
  1281            C        ;  Bank6 RB (PORTB Open Drain Control Reister)
  1282            C        ;
  1283       000B C         B6_RB	==	0X0B
  1284       000B C         PBODCR	==	0X0B
  1285            C        ;
  1286            C        	;{
  1287       0007 C        		PBOD7	==  0X07 ;
  1288       0006 C        		PBOD6	==  0X06 ;
  1289       0005 C        		PBOD5	==  0X05 ;
  1290       0004 C        		PBOD4	==  0X04 ;
  1291       0003 C        		PBOD3	==  0X03 ;
  1292       0002 C        		PBOD2	==  0X02 ;
  1293       0001 C        		PBOD1	==  0X01 ;
  1294       0000 C        		PBOD0	==  0X00 ;
  1295            C        	;}
  1296            C        ;
  1297            C        ;  Bank6 RC (PORTC Open Drain Control Reister)
  1298            C        ;
  1299       000C C         B6_RC	==	0X0C
  1300       000C C         PCODCR	==	0X0C
  1301            C        ;
  1302            C        	;{
  1303            C        				 ; Other
  1304       0003 C        		PCOD3	==  0X03 ;
  1305       0002 C        		PCOD2	==  0X02 ;
  1306       0001 C        		PCOD1	==  0X01 ;
  1307       0000 C        		PCOD0	==  0X00 ;
  1308            C        	;}
  1309            C        ;
  1310            C        ;======================================================;
  1311            C        ; Register R10~R3F                                     ;
  1312            C        ;======================================================;
  1313            C        ;
  1314            C        ; (R10 ~ R3F): General Purpose Register
  1315            C        ;
  1316       0010 C         R10    ==    0x10
  1317       0011 C         R11    ==    0x11
  1318       0012 C         R12    ==    0x12
  1319       0013 C         R13    ==    0x13
  1320       0014 C         R14    ==    0x14
  1321       0015 C         R15    ==    0x15
  1322       0016 C         R16    ==    0x16
  1323       0017 C         R17    ==    0x17
  1324       0018 C         R18    ==    0x18
  1325       0019 C         R19    ==    0x19
  1326       001A C         R1A    ==    0x1A
  1327       001B C         R1B    ==    0x1B
  1328       001C C         R1C    ==    0x1C
  1329       001D C         R1D    ==    0x1D
  1330       001E C         R1E    ==    0x1E
  1331       001F C         R1F    ==    0x1F
  1332            C        ;
  1333       0020 C         R20    ==    0x20
  1334       0021 C         R21    ==    0x21
  1335       0022 C         R22    ==    0x22
  1336       0023 C         R23    ==    0x23
  1337       0024 C         R24    ==    0x24
  1338       0025 C         R25    ==    0x25
  1339       0026 C         R26    ==    0x26
  1340       0027 C         R27    ==    0x27
  1341       0028 C         R28    ==    0x28
  1342       0029 C         R29    ==    0x29
  1343       002A C         R2A    ==    0x2A
  1344       002B C         R2B    ==    0x2B
  1345       002C C         R2C    ==    0x2C
  1346       002D C         R2D    ==    0x2D
  1347       002E C         R2E    ==    0x2E
  1348       002F C         R2F    ==    0x2F
  1349            C        ;
  1350       0030 C         R30    ==    0x30
  1351       0031 C         R31    ==    0x31
  1352       0032 C         R32    ==    0x32
  1353       0033 C         R33    ==    0x33
  1354       0034 C         R34    ==    0x34
  1355       0035 C         R35    ==    0x35
  1356       0036 C         R36    ==    0x36
  1357       0037 C         R37    ==    0x37
  1358       0038 C         R38    ==    0x38
  1359       0039 C         R39    ==    0x39
  1360       003A C         R3A    ==    0x3A
  1361       003B C         R3B    ==    0x3B
  1362       003C C         R3C    ==    0x3C
  1363       003D C         R3D    ==    0x3D
  1364       003E C         R3E    ==    0x3E
  1365       003F C         R3F    ==    0x3F
  1366            C        
    13                     include "EM78CtrlIns.H"
     1            C        
     2            C        EM78CtrlIns.H    EQU         EM78CtrlIns.H
     3            C        ;-------------------------------------------------------
     4            C        
     5            C        ;***********************************************************
     6            C        ;
     7            C        ;***********************************************************
     8            C        ; reg.bit exchange
     9            C        ;========================================
    10            C        COM MACRO REG,BIT
    11            C        	IF        BIT == 0
    12            C        		XOR        REG,@0B00000001
    13            C        	ELSEIF    BIT == 1
    14            C        		XOR        REG,@0B00000010
    15            C        	ELSEIF    BIT == 2
    16            C        		XOR        REG,@0B00000100
    17            C        	ELSEIF    BIT == 3
    18            C        		XOR        REG,@0B00001000
    19            C        	ELSEIF    BIT == 4
    20            C        		XOR        REG,@0B00010000
    21            C        	ELSEIF    BIT == 5
    22            C        		XOR        REG,@0B00100000
    23            C        	ELSEIF    BIT == 6
    24            C        		XOR        REG,@0B01000000
    25            C        	ELSEIF    BIT == 7
    26            C        		XOR        REG,@0B10000000
    27            C        	ELSE
    28            C        		MESSAGE    "BIT select ERROR"
    29            C        	ENDIF
    30            C        ENDM
    31            C        
    32            C        ;===============================================
    33            C        ; TO reg.bit1 = reg2.bit2
    34            C        ;================================================
    35            C        MOVB MACRO REG1,BIT1,REG2,BIT2
    36            C        	JBS       REG2,BIT2
    37            C        	BC        REG1,BIT1
    38            C        	JBC       REG2,BIT2
    39            C        	BS        REG1,BIT1
    40            C        ENDM
    41            C        
    42            C        ;===============================================
    43            C        ; TO reg1.bit1 = /reg2.bit2
    44            C        ;===============================================
    45            C        MOVBCPL MACRO REG1,BIT1,REG2,BIT2
    46            C        	JBS       REG2,BIT2
    47            C        	BS        REG1,BIT1
    48            C        	JBC       REG2,BIT2
    49            C        	BC        REG1,BIT1
    50            C        ENDM
    51            C        
    52            C        ;===============================================
    53            C        ; TO REG1=@DATA
    54            C        ;===============================================
    55            C        MOV MACRO REG,@DATA
    56            C        	MOV       A,@DATA
    57            C        	MOV       REG,A
    58            C        ENDM
    59            C        
    60            C        ;===============================================
    61            C        ; TO REG1=REG2
    62            C        ;===============================================
    63            C        MOV MACRO REG1,REG2
    64            C        	MOV       A,REG2
    65            C        	MOV       REG1,A
    66            C        ENDM
    67            C        
    68            C        
    69            C        
    70            C        ;***********************************************************
    71            C        ;
    72            C        ;***********************************************************
    73            C        ;===============================================
    74            C        ;decrement reg and jump when not zero
    75            C        ;================================================
    76            C        DJNZ MACRO REG,ADDRESS
    77            C        	DJZ       REG
    78            C        	JMP       ADDRESS
    79            C        ENDM
    80            C        
    81            C        ;=====================================================
    82            C        ; INC reg and jump when not zero
    83            C        ;=====================================================
    84            C        IJNZ MACRO REG,ADDRESS
    85            C        	JZ        REG
    86            C        	JMP       ADDRESS
    87            C        ENDM
    88            C        
    89            C        ;=====================================================
    90            C        ; compare and jump
    91            C        ; if reg1 > reg2 jump to add1
    92            C        ; if reg1 < reg2 jump to add2
    93            C        ;=====================================================
    94            C        CJLJG MACRO REG1,REG2,ADD1,ADD2
    95            C        	MOV       A,REG2
    96            C        	SUB       A,REG1
    97            C        	JBS       0X03,0 ;R3==0X03
    98            C        	JMP       ADD1
    99            C        	JBS       0X03,2
   100            C        	JMP       ADD2
   101            C        ENDM
   102            C        
   103            C        ;=====================================================
   104            C        ; compare and jump if in range
   105            C        ; if @LITE1 <= REG <= @LITE2 jump to ADDR
   106            C        ;=====================================================
   107            C        CJIN MACRO REG,@LITE1,@LITE2,ADDR
   108            C        	MOV       A,REG
   109            C        	ADD       A,@255-LITE2
   110            C        	ADD       A,@LITE2-LITE1+1
   111            C        	JBC       0X03,0
   112            C        	JMP       ADDR
   113            C        ENDM
   114            C        
   115            C        ;=====================================================
   116            C        ; COMPARE AND JUMP IF OUT RANGE
   117            C        ; if REG > @LITE2 or REG < @LITE1 jump to ADDR
   118            C        ;=====================================================
   119            C        CJOUT MACRO REG,@LITE1,@LITE2,ADDR
   120            C        	MOV       A,REG
   121            C        	ADD       A,@255-LITE2
   122            C        	ADD       A,@LITE2-LITE1+1
   123            C        	JBS       0X03,0
   124            C        	JMP       ADDR
   125            C        ENDM
   126            C        
   127            C        ;=====================================================
   128            C        ; compare and jump if REG1 > REG2
   129            C        ;=====================================================
   130            C        CJG       MACRO REG1,REG2,ADDRESS
   131            C        	MOV       A,REG1
   132            C        	SUB       A,REG2
   133            C        	JBS       0X03,0
   134            C        	JMP       ADDRESS
   135            C        ENDM
   136            C        
   137            C        ;=====================================================
   138            C        ; compare and jump if REG1 >= REG2
   139            C        ;=====================================================
   140            C        CJGE MACRO REG1,REG2,ADDRESS
   141            C        	MOV       A,REG2
   142            C        	SUB       A,REG1
   143            C        	JBC       0X03,0
   144            C        	JMP       ADDRESS
   145            C        ENDM
   146            C        
   147            C        ;=====================================================
   148            C        ; compare and jump if REG1 < REG2
   149            C        ;=====================================================
   150            C        CJL MACRO REG1,REG2,ADDRESS
   151            C        	MOV       A,REG2
   152            C        	SUB       A,REG1
   153            C        	JBS       0X03,0
   154            C        	JMP       ADDRESS
   155            C        ENDM
   156            C        
   157            C        ;=====================================================
   158            C        ; compare and jump if REG1 <= REG2
   159            C        ;=====================================================
   160            C        CJLE MACRO REG1,REG2,ADDRESS
   161            C        	MOV       A,REG1
   162            C        	SUB       A,REG2
   163            C        	JBC       0X03,0
   164            C        	JMP       ADDRESS
   165            C        ENDM
   166            C        
   167            C        ;=====================================================
   168            C        ; compare and jump if REG1 = REG2
   169            C        ;=====================================================
   170            C        CJE MACRO REG1,REG2,ADDRESS
   171            C        	MOV       A,REG2
   172            C        	SUB       A,REG1
   173            C        	JBC       0X03,2
   174            C        	JMP       ADDRESS
   175            C        ENDM
   176            C        
   177            C        ;=====================================================
   178            C        ; compare and jump if REG1 = @DATA jmp to ADDRESS
   179            C        ;=====================================================
   180            C        CJE MACRO REG,@DATA,ADDRESS
   181            C        	MOV       A,REG
   182            C        	SUB       A,@DATA
   183            C        	JBC       0X03,2
   184            C        	JMP       ADDRESS
   185            C        ENDM
   186            C        
   187            C        ;=====================================================
   188            C        ; compare and jump if REG1=REG2=@DATA jmp to ADDRESS
   189            C        ;=====================================================
   190            C        CJE MACRO REG1,REG2,@DATA,ADDRESS
   191            C        	MOV       A,REG2
   192            C        	SUB       A,REG1
   193            C        	JBS       0X03,2
   194            C        	JMP       $_CJE_DONE
   195            C        	MOV       A,REG1
   196            C        	SUB       A,@DATA
   197            C        	JBC       0X03,2
   198            C        	JMP       ADDRESS
   199            C        $_CJE_DONE:
   200            C        ENDM
   201            C        
   202            C        ;=====================================================
   203            C        ; compare and jump if REG1 <> REG2
   204            C        ;=====================================================
   205            C        CJNE MACRO REG1,REG2,ADDRESS
   206            C        	MOV       A,REG2
   207            C        	SUB       A,REG1
   208            C        	JBS       0X03,2
   209            C        	JMP       ADDRESS
   210            C        ENDM
   211            C        
   212            C        ;=====================================================
   213            C        ;compare and jump if REG = 0 JMP ADDRESS
   214            C        ;=====================================================
   215            C        CJZ MACRO REG,ADDRESS
   216            C        	MOV       REG,REG
   217            C        	JBC       0X03,2
   218            C        	JMP       ADDRESS
   219            C        ENDM
   220            C        
   221            C        ;=====================================================
   222            C        ; compare and jump if REG <> 0
   223            C        ;=====================================================
   224            C        CJNZ MACRO REG,ADDRESS
   225            C        	MOV       REG,REG
   226            C        	JBS       0X03,2
   227            C        	JMP       ADDRESS
   228            C        ENDM
   229            C        
   230            C        ;=====================================================
   231            C        ; compare and jump if REG.BIT = 0
   232            C        ;=====================================================
   233            C        CJBC MACRO REG,BIT,ADDRESS
   234            C        	JBS       REG,BIT
   235            C        	JMP       ADDRESS
   236            C        ENDM
   237            C        
   238            C        ;=====================================================
   239            C        ; compare and jump if REG.BIT = 1
   240            C        ;=====================================================
   241            C        CJBS MACRO REG,BIT,ADDRESS
   242            C        	JBC       REG,BIT
   243            C        	JMP       ADDRESS
   244            C        ENDM
   245            C        
   246            C        ;=====================================================
   247            C        ; compare and jump if REG.BIT = 0 JMP ADDRESS1
   248            C        ;                  if REG.BIT = 1 JMP ADDRESS2
   249            C        ;=====================================================
   250            C        CJBCS MACRO REG,BIT,ADDRESS1,ADDRESS2
   251            C        	JBC       REG,BIT
   252            C        	JMP       ADDRESS1
   253            C        	JBS       REG,BIT
   254            C        	JMP       ADDRESS2
   255            C        ENDM
   256            C        
   257            C        
   258            C        
   259            C        
   260            C        
   261            C        ;***********************************************************
   262            C        ;
   263            C        ;***********************************************************
   264            C        ;===============================================
   265            C        ; 
   266            C        ; :,ACC,R3
   267            C        ; A      -> A_TEMP
   268            C        ; RSR    -> RSR_TEMP
   269            C        ; STATUS -> STATUS_TEMP
   270            C        ;================================================
   271            C        PUSH MACRO
   272            C        	MOV                 A_TEMP,A       ;A_TEMP,A         ;SAVE A
   273            C        	SWAP                A_TEMP         ;A_TEMP
   274            C        	SWAPA               0X03           ;STATUS           ;SAVE STATUS(R3)
   275            C        	MOV                 STATUS_TEMP,A  ;STATUS_TEMP,A
   276            C        IFDEF EM78P510.H
   277            C        	SWAPA               0X05           ;RSR              ;SAVE RSR(R4)
   278            C        	MOV                 RSR_TEMP,A     ;RSR_TEMP,A
   279            C        ELSE
   280            C        	SWAPA               0X04           ;RSR              ;SAVE RSR(R4)
   281            C        	MOV                 RSR_TEMP,A     ;RSR_TEMP,A
   282            C        ENDIF
   283            C        	CLR                 0X03           ;STATUS           ;SELECT PAGE0
   284            C        ENDM
   285            C        
   286            C        POP MACRO
   287            C        	SWAPA               STATUS_TEMP    ;STATUS_TEMP    ;R3
   288            C        	MOV                 0X03,A         ;STATUS,A
   289            C        IFDEF EM78P510.H
   290            C        	SWAPA               RSR_TEMP       ;RSR_TEMP       ;R4
   291            C        	MOV                 0X05,A         ;RSR,A
   292            C        ELSE
   293            C        	SWAPA               RSR_TEMP       ;RSR_TEMP       ;R4
   294            C        	MOV                 0X04,A         ;RSR,A
   295            C        ENDIF
   296            C        	SWAPA               A_TEMP         ;A_TEMP
   297            C        ENDM
   298            C        
   299            C        
   300            C        
   301            C        ;***********************************************************
   302            C        ; 
   303            C        ;***********************************************************
   304            C        ;===================================================
   305            C        ; 
   306            C        ;===================================================
   307            C        PAGE MACRO NUM
   308            C        IFDEF     EM78P510.H
   309            C        	ERROR
   310            C        	MESSAGE "ERROR:THe EM78510 Not Support PAGE insruction but used LCALL or LJMP"
   311            C        	MESSAGE "can not use the instrction PAGE"
   312            C        ELSE
   313            C        	IF        NUM == 0
   314            C                      BC        0X03,7
   315            C                      BC        0X03,6
   316            C                      BC        0X03,5
   317            C        	ELSEIF    NUM == 1
   318            C        	          BC        0X03,7
   319            C        	          BC        0X03,6
   320            C        	          BS        0X03,5
   321            C        	ELSEIF    NUM == 2
   322            C        	          BC        0X03,7
   323            C        	          BS        0X03,6
   324            C        	          BC        0X03,5
   325            C        	ELSEIF    NUM == 3
   326            C        	          BC        0X03,7
   327            C        	          BS        0X03,6
   328            C        	          BS        0X03,5
   329            C        	ELSEIF    NUM == 4
   330            C        	          BS        0X03,7
   331            C        	          BC        0X03,6
   332            C        	          BC        0X03,5
   333            C        	ELSEIF    NUM == 5
   334            C        	          BS        0X03,7
   335            C        	          BC        0X03,6
   336            C        	          BS        0X03,5
   337            C        	ELSEIF    NUM == 6
   338            C        	          BS        0X03,7
   339            C        	          BS        0X03,6
   340            C        	          BC        0X03,5
   341            C        	ELSEIF    NUM == 7
   342            C        	          BS        0X03,7
   343            C        	          BS        0X03,6
   344            C        	          BS        0X03,5
   345            C        	ELSE
   346            C        	          MESSAGE "WARRING: don't have specify page"
   347            C        	ENDIF
   348            C        ENDIF
   349            C        
   350            C        ENDM
   351            C        
   352            C        ;===================================================%
   353            C        ; 
   354            C        ;===================================================
   355            C        FCALL MACRO ADDRESS
   356            C        IFDEF     EM78P510.H
   357            C        	ERROR
   358            C        	MESSAGE "ERROR:THe EM78510 Not Support PAGE insruction but used LCALL or LJMP"
   359            C        	MESSAGE "can not use the instrction FCALL"
   360            C        ELSE
   361            C        	IF        ADDRESS/0X400 == $/0X400
   362            C        	          CALL      ADDRESS
   363            C        	ELSE
   364            C        	          PAGE      ADDRESS/0X400
   365            C        	          CALL      ADDRESS%0X400
   366            C        	          PAGE      $/0X400
   367            C        	ENDIF
   368            C        ENDIF
   369            C        ENDM
   370            C        
   371            C        ;===================================================
   372            C        ; 
   373            C        ; :NUM = ,  ADDRESS =  B
   374            C        ;===================================================
   375            C        FCALL MACRO NUM,ADDRESS
   376            C        IFDEF     EM78P510.H
   377            C        	ERROR
   378            C        	MESSAGE "ERROR:THe EM78510 Not Support PAGE insruction but used LCALL or LJMP"
   379            C        	MESSAGE "can not use the instrction FCALL"
   380            C        ELSE
   381            C        	PAGE      NUM
   382            C        	CALL      ADDRESS
   383            C        	PAGE      $/0X400
   384            C        ENDIF
   385            C        ENDM
   386            C        
   387            C        ;===================================================
   388            C        ; 
   389            C        ;===================================================
   390            C        FJMP MACRO ADDRESS
   391            C        IFDEF     EM78P510.H
   392            C        	ERROR
   393            C        	MESSAGE "ERROR:THe EM78510 Not Support PAGE insruction but used LCALL or LJMP"
   394            C        	MESSAGE "can not use the instrction FJMP"
   395            C        ELSE
   396            C        	IF        ADDRESS/0X400 == $/0X400
   397            C        	          JMP       ADDRESS
   398            C        	ELSE
   399            C        	          PAGE      ADDRESS/0X400
   400            C        	          JMP       ADDRESS%0X400
   401            C        	ENDIF
   402            C        ENDIF
   403            C        ENDM
   404            C        
   405            C        ;===================================================
   406            C        ;
   407            C        ; :NUM = ,  ADDRESS =  B
   408            C        ;===================================================
   409            C        FJMP MACRO NUM,ADDRESS
   410            C        IFDEF     EM78P510.H
   411            C        	ERROR
   412            C        	MESSAGE "ERROR:THe EM78510 Not Support PAGE insruction but used LCALL or LJMP"
   413            C        	MESSAGE "can not use the instrction FJMP"
   414            C        ELSE
   415            C        	PAGE      NUM
   416            C        	JMP       ADDRESS
   417            C        ENDIF
   418            C        ENDM
   419            C        
   420            C        ;===================================================
   421            C        ; 
   422            C        ;===================================================
   423            C        BANK MACRO @NUM
   424            C        IFDEF EM78M611.H
   425            C        	IF        @NUM == 0
   426            C                      BC        0X04,7
   427            C                      BC        0X04,6
   428            C        	ELSEIF    @NUM == 1
   429            C        	          BC        0X04,7
   430            C        	          BS        0X04,6
   431            C        	ELSEIF    @NUM == 2
   432            C        	          BS        0X04,7
   433            C        	          BC        0X04,6
   434            C        	ELSEIF    @NUM == 3
   435            C        	          BS        0X04,7
   436            C        	          BS        0X04,6
   437            C        	ENDIF
   438            C        
   439            C        ELSEIFDEF EM78M612.H
   440            C        	IF        @NUM == 0
   441            C                      BC        0X04,6
   442            C        	ELSEIF    @NUM == 1
   443            C        	          BS        0X04,6
   444            C        	ENDIF
   445            C        ELSE
   446            C        	MESSAGE "the MCU defualt have 'bank' intruction"
   447            C        ENDIF
   448            C        ENDM
   449            C        
   450            C        
   451            C        
   452            C        ;*******************************************
   453            C        ; RAM clear function
   454            C        ; [ELSE]: default the MCU have four bank
   455            C        ; others: xx.h must be define in "xx.h"
   456            C        ;*******************************************
   457            C        ClrRamBank MACRO
   458            C        IFDEF EM78P510.H
   459            C        	MOV     A, @0XE0        ; RAM 
   460            C        	MOV     R4, A           ;
   461            C        	CLR     BSR
   462            C        	;INC     BSR            ; BANK 0 is used for exchange reg(FIFO)
   463            C        ;CLEAR_RAM_LOOP_P510:
   464            C        	WDTC
   465            C        	CLR     R0
   466            C        	INC     R4
   467            C        	MOV     A, R4
   468            C        	AND     A, @0X3F
   469            C        	JBS     R3, Z
   470            C        	JMP     $-5            ; CLEAR_RAM_LOOP_P510
   471            C        	INC     BSR
   472            C        	MOV     A, BSR         ; BANK0 (BSR == 0X05)
   473            C        	AND     A, @0X07
   474            C        	BS      R4, 5
   475            C        	BS      R4, 6
   476            C        	JBS     R3, 2
   477            C        	JMP     $-13           ; CLEAR_RAM_LOOP_P510
   478            C        	CLR     R4
   479            C        	BS      R4,6
   480            C        
   481            C        ELSEIFDEF EM78M611.H
   482            C        	CLR     RC
   483            C        	CLR     RD
   484            C        	CLR     0X10
   485            C        	MOV     A,@0X2F
   486            C        	MOV     0X10,A
   487            C        
   488            C        	MOV     A,@0X11
   489            C        	MOV     RSR,A
   490            C        ;CLRLOOPU1:
   491            C        	CLR     R0
   492            C        	INC     RSR
   493            C        	DJZ     0X10
   494            C        	JMP     $-3        ;CLRLOOPU1
   495            C            CLR     R0
   496            C        	MOV     A,@0X20
   497            C        	MOV     0X10,A
   498            C        	MOV     A,@0X60
   499            C        	MOV     RSR,A
   500            C        
   501            C        ;CLRLOOPU2:
   502            C        	CLR     R0
   503            C        	INC     RSR
   504            C        	DJZ     0X10
   505            C        	JMP     $-3             ;CLRLOOPU2
   506            C        
   507            C        	CLR     R0
   508            C        	MOV     A,@0X20
   509            C        	MOV     0X10,A
   510            C        	MOV     A,@0XA0
   511            C        	MOV     RSR,A
   512            C        	
   513            C        ;CLRLOOPU3:
   514            C        	CLR     R0
   515            C        	INC     RSR
   516            C        	DJZ     0X10
   517            C        	JMP     $-3            ;CLRLOOPU3
   518            C        	CLR     R0
   519            C        
   520            C        	MOV     A,@0X11
   521            C        	MOV     RD,A
   522            C        	CLR     RE
   523            C        	MOV     A,@1
   524            C        	MOV     RD,A
   525            C        	MOV     A,@0X00
   526            C        	MOV     RE,A
   527            C        	MOV     RE,A
   528            C        	MOV     RE,A
   529            C        	MOV     RE,A
   530            C        	MOV     RE,A
   531            C        	MOV     RE,A
   532            C        	MOV     RE,A
   533            C        	MOV     RE,A
   534            C        	BS      RC,5
   535            C        
   536            C        
   537            C        ELSEIFDEF EM78P447.H
   538            C         	MOV     A,@0x10
   539            C        	MOV     R4,A
   540            C        ;CLEAR_RAM_LOOP_P447:
   541            C        	CLR     R0
   542            C        	INC     R4
   543            C        	JBC     R4,6
   544            C        	BS      R4,5
   545            C        	JBC     R4,7
   546            C        	BS      R4,5
   547            C        	JBS     R3,Z
   548            C        	JMP     $-7            ; CLEAR_RAM_LOOP_P447:
   549            C        	CLR     R4
   550            C        
   551            C        ELSEIFDEF EM78P468.H
   552            C        	MOV     A,@0X10
   553            C        	MOV     RSR,A
   554            C        ;CLEAR_RAM_LOOP_P468:
   555            C        	CLR     R0
   556            C        	INC     RSR
   557            C        	JBC     RSR,6
   558            C        	BS      RSR,5
   559            C        	JBC     RSR,7
   560            C        	BS      RSR,5
   561            C        	JBS     STATUS,Z
   562            C        	JMP     $-7            ; CLEAR_RAM_LOOP_P468
   563            C        	CLR     RSR
   564            C        
   565            C        ELSEIFDEF EM78P458.H
   566            C                MOV     A,@0X10
   567            C                MOV     RSR,A
   568            C        ;CLEAR_RAM_LOOP_P458:
   569            C                CLR     R0
   570            C                INC     RSR
   571            C                JBC     RSR,6
   572            C                BS      RSR,5
   573            C                JBS     RSR,7
   574            C                JMP     $-5        ; CLEAR_RAM_LOOP_P458
   575            C                CLR     RSR
   576            C        
   577            C        ELSEIFDEF EM78P451.H
   578            C                MOV     A,@0X10
   579            C                MOV     RSR,A
   580            C        ;CLEAR_RAM_LOOP_P451:
   581            C                CLR     R0
   582            C                INC     RSR
   583            C                JBC     RSR,6
   584            C                BS      RSR,5
   585            C                JBC     RSR,7
   586            C                BS      RSR,5
   587            C                JBS     STATUS,Z
   588            C                JMP     $-7        ; CLEAR_RAM_LOOP_P451
   589            C        
   590            C        ELSE
   591            C        	MOV     A,@0x10        ; clear all ram bank
   592            C        	MOV     R4,A
   593            C        ;CLEAR_RAM_LOOP:
   594            C        	CLR     R0
   595            C        	INC     R4
   596            C        	JBC     R4,6
   597            C        	BS      R4,5
   598            C        	JBC     R4,7
   599            C        	BS      R4,5
   600            C        	JBS     R3,Z
   601            C        	JMP     $-7            ; CLEAR_RAM_LOOP:
   602            C        	CLR     R4
   603            C        	MESSAGE "Clear all RAM bank"
   604            C        ENDIF
   605            C        ENDM
   606            C        
   607            C        ;*******************************************
   608            C        ; RAM clear function
   609            C        ; [ELSE]: default the MCU have four bank
   610            C        ; others: xx.h must be define in "xx.h"
   611            C        ;*******************************************
   612            C        Clr_10_1F_RamBank MACRO
   613            C        	MOV                 A, @0X10                ; RAM 
   614            C        	MOV                 R4, A
   615            C        CLEAR_10_1FH_RAM_LOOP:
   616            C        	WDTC
   617            C        	CLR                 R0
   618            C        	INC                 R4
   619            C        	MOV                 A, R4
   620            C        	XOR                 A, @0X20
   621            C        	JBS                 R3, Z
   622            C        	JMP                 CLEAR_10_1FH_RAM_LOOP
   623            C        	CLR                 RSR
   624            C        ENDM
   625            C        
   626            C        
    14                     include "P520txP48v10.H"
     1            C        ;==================================================================
     2            C        ;  Tilte:       EM78M198810 include file		;
     3            C        ;  NAME:        RF_EM78M612_RECEIVE.H
     4            C        ;  Description: The Definition of EM78M198810 for EM78612 Registers ;
     5            C        ;  Company:     Elan Electronic Corp.		;
     6            C        ;  Author:      YU.WEI				;
     7            C        ;  Date:        2009.02.26			;
     8            C        ;  Version:     v1.0				;
     9            C        ;  Tool:        wiceplus 2.7
    10            C        ;  Crystal:     12MHZ
    11            C        ;  Description: PAGE0: MCU initial
    12            C        ;               PAGE1: searchmode
    13            C        ;               PAGE2: normalmode
    14            C        ;               PAGE3: RF driver
    15            C        ;               PAGE4: key scan driver
    16            C        
    17            C        ;==========================================================================================
    18            C        P510PIN32TXv14.H                EQU     P510PIN32TXv14.H
    19            C        
    20            C        ;==========================================================================================
    21       0020 C        DataBufferBase                  EQU     0x20  ;address:0x20 ,bit6:select all bank
    22            C        
    23            C        
    24            C        ;============================================================================================
    25       0010 C        TEMP                            EQU     0X10
    26       0011 C        TEMP1                           EQU     0X11
    27       0012 C        TEMP2                           EQU     0X12
    28       0013 C        TEMP3                           EQU     0X13
    29       0014 C        TEMP4                           EQU     0X14
    30       0015 C        TEMP5                           EQU     0X15
    31            C        
    32       0016 C        ComuClock                       EQU     0X16  ;communicateion clock
    33       0017 C        ComuCycleNum                    EQU     0X17  ;communicateion time
    34       0018 C        ComuEndNum                      EQU     0X18  ;communicateion end time
    35       0019 C        Databytelength                  EQU     0X19  ;FIFO READ/WRITE DATA LENGTH
    36       001A C        DataShiftCounter                EQU     0X1A  ;data counter
    37       001B C        A_TEMP                          EQU     0X1B    ;TEMP1 - TEMP3 used for PUSH and POP
    38       001C C        RSR_TEMP                        EQU     0X1C
    39       001D C        STATUS_TEMP                     EQU     0X1D
    40            C        
    41       001E C        CommuStatusFlag                 EQU     0X1E
    42       001F C        GeneralStatusFlag               EQU     0X1F
    43            C        
    44            C        ;------------------------------------------------------------------
    45            C        ;r_acc1                          EQU     TEMP1
    46            C        ;r_acc2                          EQU     TEMP2
    47            C        ;r_acc3                          EQU     TEMP3
    48       0014 C        DataAddressInMCU                EQU     TEMP4         ;93C46
    49       0015 C        DataAddressInEEPROM             EQU     TEMP5
    50            C        
    51            C        ;------------------------------------------------------------------
    52       0018 C        FccFreqIndex                    EQU     ComuEndNum    ;FCC TEST
    53            C        
    54            C        
    55            C        ;============================ BANK 0 (data buffer)============================
    56            C        
    57            C        
    58            C        ;============================ BANK 1 (RF variable)============================
    59            C        
    60            C        
    61            C        ;============================ BANK 2 (key data)============================
    62            C        
    63            C        
    64            C        
    65            C        
    15                     include "UARTTest.ASM"
     1            C        /*****************************************************************
     2            C        * Filename     :  BMA020drvOnEM78P520.ASM
     3            C        * Author       :  yu.wei
     4            C        * Company      :  ELAN
     5            C        * VERSION      :  1.0
     6            C        * CRYSTAL      :  12MHZ
     7            C        * Creat date   :  2009/8/20
     8            C        * tool ver.    :  WicePlus 2.7
     9            C        * Description  :  modify for code conformity
    10            C        *****************************************************************/
    11            C        ;------------------------------------------------------------
    12            C        UARTTest.ASM    EQU    UARTTest.ASM
    13            C        
    14            C        include "UARTTest.H"
     1            C        /*****************************************************************
     2            C        * Filename     :  BMA020drvOnEM78P520.ASM
     3            C        * Author       :  yu.wei
     4            C        * Company      :  ELAN
     5            C        * VERSION      :  1.0
     6            C        * CRYSTAL      :  12MHZ
     7            C        * Creat date   :  2009/8/20
     8            C        * tool ver.    :  WicePlus 2.7
     9            C        * Description  :  modify for code conformity
    10            C        *****************************************************************/
    11            C        ;------------------------------------------------------------
    12            C        UARTTest.H    EQU    UARTTest.H
    13            C        
    14            C        ;-------------------------------------------------------------
    15            C        
    16            C        
    17            C        
    18            C        ;================== BANK 6 (COMS/G-Sensor interface)====================
    19            C        ;CMOS_PARAMETER                  EQU     0X20
    20            C        ;CMOS_STATUS                     EQU     0X21
    21            C        ;GS_PARAMETER                    EQU     0X22
    22            C        ;GS_STATUS                       EQU     0X23
    23            C        
    24            C        ;--------------------------------------------------------
    25       0024 C        CMOS_Preamble                   EQU     0X24
    26       0025 C        CMOS_Command                    EQU     0X25
    27       0026 C        CMOS_Length                     EQU     0X26
    28            C        ;CMOS_XPOINT_LOW                 EQU     0X27
    29            C        ;CMOS_YPOINT_LOW                 EQU     0X28
    30            C        ;CMOS_POINT_HIGH                 EQU     0X29
    31       002A C        GS_Preamble                     EQU     0X2A
    32       002B C        GS_Command                      EQU     0X2B
    33       002C C        GS_Length                       EQU     0X2C
    34            C        ;GS_XPOINT_LOW                   EQU     0X2D
    35            C        ;GS_YPOINT_LOW                   EQU     0X2E
    36            C        ;GS_ZPOINT_LOW                   EQU     0X2F
    37            C        ;GS_POINT_HIGH                   EQU     0X30
    38            C        ;--------------------------------------------------------
    39       0031 C        GeneralStatusFlag1              EQU     0X31
    40       0310 C        	InitGSCMOSFlag              ==      GeneralStatusFlag1*16+0 ; 
    41       0311 C        	TimeDelay12ms               ==      GeneralStatusFlag1*16+1 ;
    42            C        	
    43            C        
    44            C        /*
    45            C        CMOS_Preamble                   EQU     0XF0
    46            C        CMOS_Command                    EQU     0X80
    47            C        CMOS_Length                     EQU     0X03
    48            C        CMOS_XPOINT_LOW                 EQU     0XFF
    49            C        CMOS_YPOINT_LOW                 EQU     0XFF
    50            C        CMOS_POINT_HIGH                 EQU     0X7F
    51            C        
    52            C        GS_Preamble                     EQU     0XF0
    53            C        GS_Command                      EQU     0X00
    54            C        GS_Length                       EQU     0X04
    55            C        GS_XPOINT_LOW                   EQU     0X17
    56            C        GS_YPOINT_LOW                   EQU     0XD8
    57            C        GS_ZPOINT_LOW                   EQU     0XCF
    58            C        GS_POINT_HIGH                   EQU     0X0C
    59            C        */
    60            C        
    61            C        ;***********************************************************
    62            C        ;General RAM define
    63            C        ;***********************************************************
    64       000A C        SPI_BUS				==		0X0A
    65       0002 C        F_GS_SS				==		2
    66       0003 C        F_CMOS_SS			==		3
    67            C        
    68       000A C        GS_Margin			==		0X0A
    69       00FF C        CMOS_SIZE			==		0XFF
    70            C        ;***********************************************************
    71            C        ; Bank5
    72            C        ;***********************************************************
    73       000A C        CMOS_Addr			==		0X0A			;
    74       0020 C        CMOS_X1_H			==		0X20			;X1[9..8]
    75       0021 C        CMOS_X1_L			==		CMOS_X1_H+1		;X1[7..0]
    76       0022 C        CMOS_Y1_H			==		CMOS_X1_H+2		;Y1[9..8]
    77       0023 C        CMOS_Y1_L			==		CMOS_X1_H+3		;Y1[7..0]
    78       0024 C        CMOS_Size1			==		CMOS_X1_H+4		;Size1[3..0]
    79       0025 C        CMOS_X2_H			==		CMOS_X1_H+5		;X2[9..8]
    80       0026 C        CMOS_X2_L			==		CMOS_X1_H+6		;X2[7..0]
    81       0027 C        CMOS_Y2_H			==		CMOS_X1_H+7		;Y2[9..8]
    82       0028 C        CMOS_Y2_L			==		CMOS_X1_H+8		;Y2[7..0]
    83       0029 C        CMOS_Size2			==		CMOS_X1_H+9		;Size2[3..0] 0X29
    84            C        
    85       002A C        CMOS_XH_Median		==		0X2A
    86       002B C        CMOS_XL_Median		==		0X2B		;CMOS X axis 
    87       002C C        CMOS_YH_Median		==		0X2C
    88       002D C        CMOS_YL_Median		==		0X2D		;CMOS Y axis 
    89       002E C        Minus_Value_H  		==		0X2E
    90       002F C        Minus_Value_L  		==		0X2F		;
    91       0030 C        Y_Return_Value		==		0X30		;X axis compare return value
    92       0031 C        X_Return_Value		==		0X31		;Y axis compare return value
    93            C        
    94       0032 C        Receive_CMOS_Data	==		0X32
    95       0033 C        Receive_CMOS_Count	==		0X33
    96       0034 C        CMOS_Size_BAK		==		0X34
    97            C        
    98       0031 C        X1H					==		0X31
    99       0032 C        X1L					==		0X32
   100       0033 C        X2H					==		0X33
   101       0034 C        X2L					==		0X34
   102            C        
   103       0035 C        System_Flag			==		0X35
   104       0000 C        F_CMOS_First		==		0
   105            C        ;=====================================================================
   106            C        ;CMOS data handle buffer
   107            C        ;=====================================================================
   108       0036 C        CMOS_X1_H_1			==		0X36
   109       0037 C        CMOS_X1_L_1			==		CMOS_X1_H_1+1
   110       0038 C        CMOS_Y1_H_1			==		CMOS_X1_H_1+2
   111       0039 C        CMOS_Y1_L_1			==		CMOS_X1_H_1+3
   112       003A C        CMOS_Size1_1		==		CMOS_X1_H_1+4
   113       003B C        CMOS_X2_H_1			==		CMOS_X1_H_1+5
   114       003C C        CMOS_X2_L_1			==		CMOS_X1_H_1+6
   115       003D C        CMOS_Y2_H_1			==		CMOS_X1_H_1+7
   116       003E C        CMOS_Y2_L_1			==		CMOS_X1_H_1+8
   117       003F C        CMOS_Size2_1		==		CMOS_X1_H_1+9		;0X3F	
   118            C        
   119            C        ;***********************************************************
   120            C        ; Bank6
   121            C        ;***********************************************************
   122       0020 C        CMOS_PARAMETER		==		0X20
   123       0021 C        CMOS_STATUS			==		0X21
   124       0000 C        	F_CMOS_Init		==		0
   125       0001 C        	F_CMOS_Sleep	==		1
   126       0002 C        	F_CMOS_Valid	==		2	
   127       0022 C        GS_PARAMETER		==		0X22
   128       0023 C        GS_STATUS			==		0X23
   129       0000 C        	F_GS_Init		==		0
   130       0001 C        	F_GS_Sleep		==		1
   131       0002 C        	F_GS_New		==		2
   132            C        
   133       0027 C        CMOS_XPOINT_LOW		==		0X27
   134       0028 C        CMOS_YPOINT_LOW		==		0X28
   135       0029 C        CMOS_POINT_HIGH		==		0X29
   136            C        
   137       002D C        GS_XPOINT_LOW		==		0X2D
   138       002E C        GS_YPOINT_LOW		==		0X2E
   139       002F C        GS_ZPOINT_LOW		==		0X2F
   140       0030 C        GS_POINT_HIGH		==		0X30
   141            C        
   142       0032 C        Minus_High			==		0X32
   143       0033 C        Minus_Low			==		0X33
   144       0033 C        DATA_BAK			==		0X33
   145       0033 C        Cyc_Cnt				==		0X33
   146            C        ;--------------- GS data buffer ----------------------------
   147       0002 C        GS_Addr				==		0X02			;Gsensor Access Address
   148       0034 C        GS_X_High			==		0X34			;Gsensor X High Byte(8Bit)
   149       0035 C        GS_X_Low			==		GS_X_High+1		;0X35;Gsensor X Low Byte(2Bit)
   150       0036 C        GS_Y_High			==		GS_X_High+2		;0X36;Gsensor Y High Byte(8Bit)
   151       0037 C        GS_Y_Low			==		GS_X_High+3		;0X37;Gsensor Y Low Byte(2Bit)
   152       0038 C        GS_Z_High			==		GS_X_High+4		;0X38;Gsensor Z High Byte(8Bit)
   153       0039 C        GS_Z_Low			==		GS_X_High+5		;0X39;Gsensor Z Low Byte(2Bit)
   154            C        
   155            C        ;-----------------------------------------------------------
   156            C        ;GS data bak
   157            C        ;-----------------------------------------------------------
   158       003A C        GS_X_High_BAK		==		0X3A
   159       003B C        GS_X_Low_BAK		==		GS_X_High_BAK+1
   160       003C C        GS_Y_High_BAK		==		GS_X_High_BAK+2
   161       003D C        GS_Y_Low_BAK		==		GS_X_High_BAK+3
   162       003E C        GS_Z_High_BAK		==		GS_X_High_BAK+4
   163       003F C        GS_Z_Low_BAK		==		GS_X_High_BAK+5			;0X3F
   164            C        ;***********************************************************
   165            C        ; Bank7
   166            C        ;***********************************************************
   167       0020 C        CMOS_X1_H_2			==		0X20
   168       0021 C        CMOS_X1_L_2			==		CMOS_X1_H_2+1
   169       0022 C        CMOS_Y1_H_2			==		CMOS_X1_H_2+2
   170       0023 C        CMOS_Y1_L_2			==		CMOS_X1_H_2+3
   171       0024 C        CMOS_Size1_2		==		CMOS_X1_H_2+4
   172       0025 C        CMOS_X2_H_2			==		CMOS_X1_H_2+5
   173       0026 C        CMOS_X2_L_2			==		CMOS_X1_H_2+6
   174       0027 C        CMOS_Y2_H_2			==		CMOS_X1_H_2+7
   175       0028 C        CMOS_Y2_L_2			==		CMOS_X1_H_2+8
   176       0029 C        CMOS_Size2_2		==		CMOS_X1_H_2+9		;0X29
   177            C        
   178       002A C        CMOS_X1_H_3			==		0X2A
   179       002B C        CMOS_X1_L_3			==		CMOS_X1_H_3+1
   180       002C C        CMOS_Y1_H_3			==		CMOS_X1_H_3+2
   181       002D C        CMOS_Y1_L_3			==		CMOS_X1_H_3+3
   182       002E C        CMOS_Size1_3		==		CMOS_X1_H_3+4
   183       002F C        CMOS_X2_H_3			==		CMOS_X1_H_3+5
   184       0030 C        CMOS_X2_L_3			==		CMOS_X1_H_3+6
   185       0031 C        CMOS_Y2_H_3			==		CMOS_X1_H_3+7
   186       0032 C        CMOS_Y2_L_3			==		CMOS_X1_H_3+8
   187       0033 C        CMOS_Size2_3		==		CMOS_X1_H_3+9		;0X33
   188            C        
   189       0034 C        CMOS_X1_H_4			==		0X34
   190       0035 C        CMOS_X1_L_4			==		CMOS_X1_H_4+1
   191       0036 C        CMOS_Y1_H_4			==		CMOS_X1_H_4+2
   192       0037 C        CMOS_Y1_L_4			==		CMOS_X1_H_4+3
   193       0038 C        CMOS_Size1_4		==		CMOS_X1_H_4+4
   194       0039 C        CMOS_X2_H_4			==		CMOS_X1_H_4+5
   195       003A C        CMOS_X2_L_4			==		CMOS_X1_H_4+6
   196       003B C        CMOS_Y2_H_4			==		CMOS_X1_H_4+7
   197       003C C        CMOS_Y2_L_4			==		CMOS_X1_H_4+8
   198       003D C        CMOS_Size2_4		==		CMOS_X1_H_4+9		;0X3D
   199            C        
   200       003E C        Sum_High			==		0X3E
   201       003F C        Sum_Low				==		0X3F
   202            C        
   203            C        ;===========================================================
   204            C        ;sum=A+B
   205            C        ;===========================================================
   206            C        Sum_AB		MACRO	Sum_H,Sum_L,X1_H,X1_L,X2_H,X2_L
   207            C        	CLR		Sum_L
   208            C        	CLR		Sum_H
   209            C        	MOV		A,X1_L
   210            C        	ADD		A,X2_L
   211            C        	JBC		R3,0
   212            C        	INC		Sum_H
   213            C        	MOV		Sum_L,A
   214            C        	MOV		A,X1_H
   215            C        	ADD		A,X2_H
   216            C        	ADD		Sum_H,A
   217            C        	ENDM
   218            C        ;===========================================================
   219            C        ;Minus Value=X1-X2
   220            C        ;===========================================================
   221            C        Count_Minus_Value		MACRO		Minus_H,Minus_L,X1_H,X1_L,X2_H,X2_L
   222            C        	CLR		Minus_L
   223            C        	CLR		Minus_H
   224            C        	MOV		A,X2_L
   225            C        	SUB		A,X1_L
   226            C        	MOV		Minus_L,A
   227            C        	JBS		R3,0
   228            C        	DEC		Minus_H
   229            C        	MOV		A,X2_H
   230            C        	SUB		A,X1_H
   231            C        	ADD		Minus_H,A
   232            C        	ENDM
   233            C        ;===========================================================
   234            C        ;shift left/right
   235            C        ;===========================================================
   236            C        Shift_Left	MACRO	High_Byte,Low_Byte,@Cyc_Counter
   237            C        	MOV		A,@Cyc_Counter
   238            C        	MOV		Cyc_Cnt,A
   239            C        $L_LOOP:
   240            C        	BC		STATUS,C
   241            C        	RLC		High_Byte
   242            C        	RLC		Low_Byte
   243            C        	DJZ		Cyc_Cnt
   244            C        	JMP		$L_LOOP
   245            C        	ENDM
   246            C        ;===========================================================
   247            C        Shift_Right	MACRO	High_Byte,Low_Byte,@Cyc_Counter
   248            C        	MOV		A,@Cyc_Counter
   249            C        	MOV		Cyc_Cnt,A
   250            C        $R_LOOP:
   251            C        	BC		STATUS,C
   252            C        	RRC		High_Byte
   253            C        	RRC		Low_Byte
   254            C        	DJZ		Cyc_Cnt
   255            C        	JMP		$R_LOOP
   256            C        	ENDM
    15            C        ;include "MODULE.ASM"
    16            C        
    17            C        
    18            C        ;-------------------------------------------------------------------
    19            C        
    20            C        	ORG                 0X1E00
    21            C        ;====================== Initial GS CMOS =========================
    22 01E00      C        UART_Transmit_TEST:
    23 01E00 1E06 C        	BANK                6
    24 01E01 0C31 C        	JBC                 InitGSCMOSFlag/16,InitGSCMOSFlag%16
    25 01E02 160E C        	JMP                 CMOS_FUNCTION_UART
    26 01E03 0A31 C        	BS                  InitGSCMOSFlag/16,InitGSCMOSFlag%16
    27            C        	
    28 01E04      C        GS_Initial:
    29 01E04 1E06 C        	BANK                6
    30 01E05 1801 C        	MOV                 A,@0B00000001
    31 01E06 0062 C        	MOV                 GS_PARAMETER,A
    32 01E07 1000 C        	CALL                GS_FUNCTION
    33 01E08 0000 C        	NOP		
    34 01E09      C        CMOS_Initial:
    35 01E09 1801 C        	MOV                 A,@0B00000001
    36 01E0A 0060 C        	MOV                 CMOS_PARAMETER,A
    37 01E0B 1EA0 C        	LCALL               CMOS_FUNCTION
    37 01E0C 1837 C        	LCALL               CMOS_FUNCTION
    38 01E0D 0000 C        	NOP
    39            C        	
    40            C        ;===================== CMOS MODULE UART ==========================
    41 01E0E      C        CMOS_FUNCTION_UART:
    42 01E0E 1E06 C        	BANK                6
    43 01E0F 1804 C        	MOV                 A,@0B00000100
    44 01E10 0060 C        	MOV                 CMOS_PARAMETER,A
    45 01E11 1EA0 C        	LCALL               CMOS_FUNCTION
    45 01E12 1837 C        	LCALL               CMOS_FUNCTION
    46 01E13 0000 C        	NOP
    47            C        	
    48            C        ;====================== GS MODULE UART ===========================
    49 01E14      C        GS_FUNCTION_UART:
    50 01E14 1E06 C        	BANK                6
    51 01E15 1804 C        	MOV                 A,@0B00000100
    52 01E16 0062 C        	MOV                 GS_PARAMETER,A
    53 01E17 1000 C        	CALL                GS_FUNCTION
    54 01E18 0000 C        	NOP
    55            C        
    56 01E19 1E06 C        	BANK                6
    57 01E1A 18F0 C        	MOV                 A,@0XF0
    58 01E1B 0064 C        	MOV                 CMOS_Preamble,A
    59 01E1C 1880 C        	MOV                 A,@0X80
    60 01E1D 0065 C        	MOV                 CMOS_Command,A
    61 01E1E 1803 C        	MOV                 A,@0X03
    62 01E1F 0066 C        	MOV                 CMOS_Length,A
    63            C        	
    64 01E20 18F0 C        	MOV                 A,@0XF0
    65 01E21 006A C        	MOV                 GS_Preamble,A
    66 01E22 1800 C        	MOV                 A,@0X00
    67 01E23 006B C        	MOV                 GS_Command,A
    68 01E24 1806 C        	MOV                 A,@0X06
    69 01E25 006C C        	MOV                 GS_Length,A	
    70            C        
    71 01E26 0000 C        	NOP
    72 01E27 18E4 C        	MOV                 A,@0XE4
    73 01E28 0044 C        	MOV                 R4,A
    74            C        	
    75            C        	
    76            C        	
    77 01E29      C        UART_Transmit_LOOP:
    78 01E29 1E06 C        	BANK                6
    79 01E2A 0400 C        	MOV                 A,R0
    80 01E2B 1E03 C        	BANK                3
    81 01E2C 0A05 C        	BS                  URC,TXE        ; Enable transmission
    82 01E2D 0000 C        	NOP
    83 01E2E 0000 C        	NOP
    84 01E2F 0000 C        	NOP
    85 01E30 0048 C        	MOV                 URTD,A
    86 01E31 0000 C        	NOP
    87 01E32 0544 C        	INC                 R4
    88 01E33 0E45 C        	JBS                 URC,UTBE
    89 01E34 1633 C        	JMP                 $-1
    90 01E35 0404 C        	MOV                 A,R4
    91 01E36 1BF1 C        	XOR                 A,@0XF1        ; UART Bufer 0X24-0X30
    92 01E37 0E83 C        	JBS                 STATUS,Z
    93 01E38 1629 C        	JMP                 UART_Transmit_LOOP
    94 01E39 0012 C        	RET
    16                     include "MM0200DAdrvOnEM78P520.ASM"
     1            C        /*****************************************************************
     2            C        * Filename     :  BMA020drvOnEM78P520.ASM
     3            C        * Author       :  yu.wei
     4            C        * Company      :  ELAN
     5            C        * VERSION      :  1.0
     6            C        * CRYSTAL      :  12MHZ
     7            C        * Creat date   :  2009/8/20
     8            C        * tool ver.    :  WicePlus 2.7
     9            C        * Description  :  modify for code conformity
    10            C        *****************************************************************/
    11            C        ;------------------------------------------------------------
    12            C        MM0200DAdrvOnEM78P520.ASM    EQU    MM0200DAdrvOnEM78P520.ASM
    13            C        
    14            C        include "MM0200DAdrvOnEM78P520.H"
     1            C        /*****************************************************************
     2            C        * Filename     :  BMA020drvOnEM78P520.ASM
     3            C        * Author       :  yu.wei
     4            C        * Company      :  ELAN
     5            C        * VERSION      :  1.0
     6            C        * CRYSTAL      :  12MHZ
     7            C        * Creat date   :  2009/8/20
     8            C        * tool ver.    :  WicePlus 2.7
     9            C        * Description  :  modify for code conformity
    10            C        *****************************************************************/
    11            C        ;------------------------------------------------------------
    12            C        MM0200DAdrvOnEM78P520.H    EQU    MM0200DAdrvOnEM78P520.H
    13            C        
    14            C        ;-------------------------------------------------------------
    15            C        ;-------------------------------------------------------------------
    16            C        
    17            C        
    18            C        
    19            C        
    20            C        
    21            C        
    22            C        
    23            C        ;===================== CMOS MODULE UART ==========================
    24            C        /*
    25            C        CMOS_FUNCTION:
    26            C        	MOV                 A,@0XF0
    27            C        	MOV                 CMOS_Preamble,A
    28            C        	MOV                 A,@0X80
    29            C        	MOV                 CMOS_Command,A
    30            C        	MOV                 A,@0X03
    31            C        	MOV                 CMOS_Length,A
    32            C        	MOV                 A,@0XFF
    33            C        	MOV                 CMOS_XPOINT_LOW,A	
    34            C        	MOV                 A,@0XFF
    35            C        	MOV                 CMOS_YPOINT_LOW,A	
    36            C        	MOV                 A,@0X7F
    37            C        	MOV                 CMOS_POINT_HIGH,A	
    38            C        	RET
    39            C        */
    40            C        
    41            C        
    42            C        	ORG			0X1800
    43            C        ;===========================================================
    44            C        ;Subroutine
    45            C        ;===========================================================
    46            C        ;***********************************************************
    47            C        ;Delay 10us
    48            C        ;input:	  None
    49            C        ;output:  None
    50            C        ;***********************************************************
    51 01800      C        Delay_10us:
    52 01800 1E06 C        	BANK		6
    53 01801 180F C        	MOV			A,@0X0F
    54 01802 0073 C        	MOV			Cyc_Cnt,A
    55 01803      C        Delay_Loop:
    56 01803 05F3 C        	DJZ			Cyc_Cnt
    57 01804 1403 C        	JMP			Delay_Loop
    58 01805 0000 C        	NOP
    59 01806 0012 C        	RET
    60            C        ;***********************************************************
    61            C        ;Compare Data
    62            C        ;input:	  X1H,X1L,X2H,X2L
    63            C        ;output:  A
    64            C        ;***********************************************************
    65 01807      C        Compare_Data:
    66 01807 0433 C        	MOV		A,X2H
    67 01808 0131 C        	SUB		A,X1H
    68 01809 0C03 C        	JBC		R3,0
    69 0180A 140C C        	JMP		Judge_High_Equal
    70 0180B 1417 C        	JMP		Return_ZERO
    71 0180C      C        Judge_High_Equal:
    72 0180C 0C83 C        	JBC		R3,2
    73 0180D 140F C        	JMP		Judge_Low_Byte
    74 0180E 1419 C        	JMP		Return_ONE
    75 0180F      C        Judge_Low_Byte:
    76 0180F 0434 C        	MOV		A,X2L
    77 01810 0132 C        	SUB		A,X1L
    78 01811 0E03 C        	JBS		R3,0
    79 01812 1414 C        	JMP		Judge_lOW_Equal
    80 01813 1419 C        	JMP		Return_ONE
    81 01814      C        Judge_lOW_Equal:
    82 01814 0C83 C        	JBC		R3,2
    83 01815 141B C        	JMP		Return_TWO
    84 01816 1417 C        	JMP		Return_ZERO
    85 01817      C        Return_ZERO:
    86 01817 1800 C        	MOV		A,@0X00						;X1<X2
    87 01818 141C C        	JMP		Compare_Data_Return
    88 01819      C        Return_ONE:
    89 01819 1801 C        	MOV		A,@0X01						;X1>X2
    90 0181A 141C C        	JMP		Compare_Data_Return
    91 0181B      C        Return_TWO:
    92 0181B 1802 C        	MOV		A,@0X02						;X1=X2
    93 0181C      C        Compare_Data_Return:
    94 0181C 0012 C        	RET
    95            C        ;***********************************************************
    96            C        ;Function:   Write SPI communication
    97            C        ;SPI is ready data on rising edge and read data on falling edge
    98            C        ;Input:	   	TEMP(SPIWB)
    99            C        ;Output:	None
   100            C        ;***********************************************************
   101 0181D      C        SIM_SPI_WRITE:
   102 0181D 0011 C        	DISI
   103 0181E 1E02 C        	BANK    	2
   104 0181F 00CC C        	CLR     	SPIS
   105 01820 00CE C        	CLR     	SPIR
   106 01821 004F C        	MOV     	SPIW, A         ; Write data to buffer
   107 01822 0000 C        	NOP
   108 01823 0000 C        	NOP
   109 01824 0B0D C        	BS      	SPIC, SSE       ; Start to shift data
   110 01825 0D0D C        	JBC     	SPIC, SSE       ; Wait to finish shift data
   111 01826 1425 C        	JMP     	$-1
   112 01827 040E C        	MOV			A,SPIR
   113 01828 1E06 C        	BANK		6
   114 01829 0010 C        	ENI
   115 0182A 0012 C        	RET
   116            C        
   117            C        ;***********************************************************
   118            C        ;Function:  Read SPI communication subroutine
   119            C        ;Input:	   	None
   120            C        ;Output:	SPIRB(TEMP)
   121            C        ;***********************************************************
   122 0182B      C        SIM_SPI_READ:
   123 0182B 0011 C        	DISI
   124 0182C 1E02 C        	BANK		2
   125 0182D 00CC C        	CLR     	SPIS
   126 0182E 00CE C        	CLR     	SPIR
   127 0182F 00CF C        	CLR			SPIW
   128 01830 0B0D C        	BS      	SPIC, SSE       ; Start to shift data
   129 01831 0D0D C        	JBC     	SPIC, SSE       ; Wait to finish shift data
   130 01832 1431 C        	JMP     	$-1
   131 01833 040E C        	MOV    		A,SPIR
   132 01834 1E06 C        	BANK		6
   133 01835 0010 C        	ENI
   134 01836 0012 C           	RET
   135            C        ;***********************************************************
   136            C        ;CMOS Function Program
   137            C        ;input:	  CMOS_PARAMETER
   138            C        ;output:  CMOS_STATUS,CMOS_XPOINT_LOW,
   139            C        ;		  CMOS_YPOINT_LOW,CMOS_POINT_HIGH
   140            C        ;***********************************************************
   141 01837      C        CMOS_FUNCTION:
   142 01837 1E04 C        	BANK		4
   143 01838 0B0A C        	BS			PAIOCR,4
   144 01839 1E05 C        	BANK		5
   145 0183A 0B0A C        	BS			PAPHCR,4
   146 0183B 1E00 C        	BANK		0
   147 0183C 180C C        	MOV			A,@00001100B
   148 0183D 024A C        	OR			PORTA,A  
   149 0183E 1E02 C        	BANK		2
   150 0183F 1800 C        	MOV			A,@00000000B						; Shift left, SDO delay time: 16clk,
   151 01840 004C C        	MOV			SPIS, A								; disable open-drain
   152 01841 18CC C        	MOV 		A, @11001100B						;rising edge read data
   153 01842 004D C        	MOV 		SPIC, A
   154 01843 1E06 C        	BANK		6
   155 01844 18C0 C        	MOV			A,@11000000B
   156 01845 0244 C        	OR			RSR,A
   157 01846 0C20 C        	JBC			CMOS_PARAMETER,0
   158 01847 1451 C        	JMP			CMOS_Init
   159 01848 0CA0 C        	JBC			CMOS_PARAMETER,2
   160 01849 147D C        	JMP			Get_CMOS_Data
   161 0184A 0C60 C        	JBC			CMOS_PARAMETER,1
   162 0184B 1461 C        	JMP			CMOS_Power_Down
   163 0184C 1471 C        	JMP			CMOS_WakeUP
   164 0184D      C        EXIT_CMOS_FUNCTION:
   165 0184D 1E02 C        	BANK		2
   166 0184E 184A C        	MOV 		A, @01001010B						;falling edge read data
   167 0184F 004D C        	MOV 		SPIC, A
   168 01850 0012 C        	RET
   169            C        ;***********************************************************
   170            C        ;CMOS Initialize
   171            C        ;input:	  CMOS_PARAMETER
   172            C        ;output:  CMOS_STATUS
   173            C        ;***********************************************************	
   174 01851      C        CMOS_Init:
   175 01851 1E06 C        	BANK		6
   176 01852 0C21 C        	JBC			CMOS_STATUS,F_CMOS_Init
   177 01853 1460 C        	JMP			CMOS_Init_Exit
   178 01854 1E00 C        	BANK		0
   179 01855 08CA C        	BC 			SPI_BUS,F_CMOS_SS
   180 01856      C        Set_Init:
   181 01856 1888 C        	MOV 		A, @0X88
   182 01857 101D C        	CALL		SIM_SPI_WRITE
   183 01858 1BFF C        	XOR			A,@0XFF
   184 01859 0C83 C        	JBC			R3,2
   185 0185A 1460 C        	JMP			CMOS_Init_Exit
   186            C        ;	MOV			A,@0XFE					;Sensitivity 1
   187            C        ;	MOV			A,@0XB4					;Sensitivity 2
   188 0185B 1864 C        	MOV			A,@0X64					;Sensitivity 3
   189            C        ;	MOV			A,@0X36					;Sensitivity 4
   190            C        ;	MOV			A,@0X20					;Sensitivity 5
   191 0185C 101D C        	CALL 		SIM_SPI_WRITE
   192 0185D 0A21 C        	BS			CMOS_STATUS,F_CMOS_Init
   193 0185E 1E00 C        	BANK		0
   194 0185F 0ACA C        	BS  		SPI_BUS,F_CMOS_SS
   195 01860      C        CMOS_Init_Exit:
   196 01860 144D C        	JMP			EXIT_CMOS_FUNCTION
   197            C        ;***********************************************************
   198            C        ;CMOS Power Down
   199            C        ;input:	  CMOS_PARAMETER
   200            C        ;output:  CMOS_STATUS
   201            C        ;***********************************************************	
   202 01861      C        CMOS_Power_Down:
   203 01861 1E06 C        	BANK		6
   204 01862 0C61 C        	JBC			CMOS_STATUS,F_CMOS_Sleep
   205 01863 1470 C        	JMP			CMOS_Sleep_Exit
   206 01864 1E00 C        	BANK		0
   207 01865 08CA C        	BC 			SPI_BUS,F_CMOS_SS
   208 01866      C        Set_Power_Down:
   209 01866 18FF C        	MOV 		A, @0XFF
   210 01867 101D C        	CALL		SIM_SPI_WRITE
   211 01868 1BFF C        	XOR			A,@0XFF
   212 01869 0C83 C        	JBC			R3,2
   213 0186A 1470 C        	JMP			CMOS_Sleep_Exit
   214 0186B 1801 C        	MOV 		A, @0X01
   215 0186C 101D C        	CALL 		SIM_SPI_WRITE
   216 0186D 0A61 C        	BS			CMOS_STATUS,F_CMOS_Sleep
   217 0186E 1E00 C        	BANK		0
   218 0186F 0ACA C        	BS  		SPI_BUS,F_CMOS_SS
   219 01870      C        CMOS_Sleep_Exit:
   220 01870 144D C        	JMP			EXIT_CMOS_FUNCTION
   221            C        ;***********************************************************
   222            C        ;CMOS Wake Up -- SS5us
   223            C        ;input:	  CMOS_PARAMETER
   224            C        ;output:  CMOS_STATUS
   225            C        ;***********************************************************	
   226 01871      C        CMOS_WakeUP:
   227 01871 1E06 C        	BANK		6
   228 01872 0E61 C        	JBS			CMOS_STATUS,F_CMOS_Sleep
   229 01873 147A C        	JMP			CMOS_WakeUp_Exit
   230 01874 1E00 C        	BANK		0
   231 01875 0ACA C        	BS 			SPI_BUS,F_CMOS_SS
   232 01876 08CA C        	BC 			SPI_BUS,F_CMOS_SS
   233 01877 1000 C        	CALL		Delay_10us
   234 01878 1E00 C        	BANK		0
   235 01879 0ACA C        	BS 			SPI_BUS,F_CMOS_SS
   236 0187A      C        CMOS_WakeUp_Exit:
   237 0187A 1E06 C        	BANK		6
   238 0187B 0861 C        	BC			CMOS_STATUS,F_CMOS_Sleep
   239 0187C 144D C        	JMP			EXIT_CMOS_FUNCTION 
   240            C        ;***********************************************************
   241            C        ;Get CMOS Data
   242            C        ;input:	  CMOS_PARAMETER
   243            C        ;output:  CMOS_STATUS,CMOS_XPOINT_LOW,
   244            C        ;		  CMOS_YPOINT_LOW,CMOS_POINT_HIGH
   245            C        ;***********************************************************	
   246 0187D      C        Get_CMOS_Data:
   247            C        ;-----------------------------------------------------------
   248 0187D      C        Read_CMOS_Data:
   249 0187D 1E00 C        	BANK		0
   250 0187E 08CA C        	BC 			SPI_BUS,F_CMOS_SS
   251 0187F 1000 C        	CALL		Delay_10us
   252 01880 0000 C        	NOP
   253 01881      C        Set_Read_Command:
   254 01881 1837 C        	MOV			A, @0X37
   255 01882 101D C        	CALL		SIM_SPI_WRITE
   256 01883 0000 C        	NOP
   257 01884 1BFF C        	XOR			A,@0XFF
   258            C        	;JBC			R3,2
   259            C        	;JMP			Read_Exit
   260 01885 1000 C        	CALL		Delay_10us
   261 01886 102B C        	CALL 		SIM_SPI_READ
   262 01887 1E05 C        	BANK		5
   263 01888 0061 C        	MOV			CMOS_X1_L,A
   264 01889 1000 C        	CALL		Delay_10us
   265 0188A 102B C        	CALL 		SIM_SPI_READ
   266 0188B 1E05 C        	BANK		5
   267 0188C 0063 C        	MOV			CMOS_Y1_L,A
   268 0188D 1000 C        	CALL		Delay_10us
   269 0188E 102B C        	CALL 		SIM_SPI_READ
   270 0188F 1E05 C        	BANK		5
   271 01890 0064 C        	MOV			CMOS_Size1,A
   272 01891 1000 C        	CALL		Delay_10us
   273 01892 102B C        	CALL 		SIM_SPI_READ
   274 01893 1E05 C        	BANK		5
   275 01894 0066 C        	MOV			CMOS_X2_L,A
   276 01895 1000 C        	CALL		Delay_10us
   277 01896 102B C        	CALL 		SIM_SPI_READ
   278 01897 1E05 C        	BANK		5
   279 01898 0068 C        	MOV			CMOS_Y2_L,A
   280 01899 1000 C        	CALL		Delay_10us
   281 0189A 102B C        	CALL 		SIM_SPI_READ
   282 0189B 1E05 C        	BANK		5
   283 0189C 0069 C        	MOV			CMOS_Size2,A
   284 0189D 1806 C        	MOV			A,@0X06
   285 0189E 0073 C        	MOV			Receive_CMOS_Count,A
   286 0189F      C        Read_Receive_CMOS:	
   287 0189F 1000 C        	CALL		Delay_10us
   288 018A0 102B C        	CALL 		SIM_SPI_READ
   289 018A1 1E05 C        	BANK		5
   290 018A2 0072 C        	MOV			Receive_CMOS_Data,A
   291 018A3 05F3 C        	DJZ			Receive_CMOS_Count
   292 018A4 149F C        	JMP			Read_Receive_CMOS
   293 018A5 1E00 C        	BANK		0
   294 018A6 0ACA C        	BS 			SPI_BUS,F_CMOS_SS
   295 018A7 1E05 C        	BANK		5
   296 018A8 0724 C        	SWAPA		CMOS_Size1
   297 018A9 1A0C C        	AND			A,@0X0C
   298 018AA 0074 C        	MOV			CMOS_Size_BAK,A
   299 018AB 0803 C        	BC 			R3,0
   300 018AC 0674 C        	RRC			CMOS_Size_BAK
   301 018AD 0634 C        	RRCA		CMOS_Size_BAK
   302 018AE 0062 C        	MOV			CMOS_Y1_H,A
   303 018AF 0724 C        	SWAPA		CMOS_Size1
   304 018B0 1A03 C        	AND			A,@0X03
   305 018B1 0060 C        	MOV			CMOS_X1_H,A
   306 018B2 180F C        	MOV			A,@0X0F
   307 018B3 02E4 C        	AND			CMOS_Size1,A
   308            C        	
   309 018B4 0729 C        	SWAPA		CMOS_Size2
   310 018B5 1A0C C        	AND			A,@0X0C
   311 018B6 0074 C        	MOV			CMOS_Size_BAK,A
   312 018B7 0803 C        	BC 			R3,0
   313 018B8 0674 C        	RRC			CMOS_Size_BAK
   314 018B9 0634 C        	RRCA		CMOS_Size_BAK
   315 018BA 0067 C        	MOV			CMOS_Y2_H,A
   316 018BB 0729 C        	SWAPA		CMOS_Size2
   317 018BC 1A03 C        	AND			A,@0X03
   318 018BD 0065 C        	MOV			CMOS_X2_H,A
   319 018BE 180F C        	MOV			A,@0X0F
   320 018BF 02E9 C        	AND			CMOS_Size2,A
   321 018C0 14C6 C        	JMP			CMOS_Data_Handle			
   322 018C1      C        Read_Exit:
   323 018C1 1E00 C        	BANK		0
   324 018C2 0ACA C        	BS 			SPI_BUS,F_CMOS_SS
   325 018C3 1E06 C        	BANK		6
   326 018C4 08A1 C        	BC			CMOS_STATUS,F_CMOS_Valid
   327 018C5 144D C        	JMP			EXIT_CMOS_FUNCTION
   328            C        ;-----------------------------------------------------------
   329 018C6      C        CMOS_Data_Handle:
   330 018C6 0424 C        	MOV			A,CMOS_Size1
   331 018C7 0000 C        	NOP
   332 018C8 1BFF C        	XOR			A,@CMOS_SIZE
   333 018C9 0C83 C        	JBC			R3,2
   334 018CA 16BD C        	JMP			CMOS_Deal_End
   335 018CB      C        TransData_To_RAM:
   336 018CB 0C35 C        	JBC			System_Flag,F_CMOS_First
   337 018CC 1519 C        	JMP			Normal_Transmit
   338 018CD 0429 C        	MOV			A,CMOS_Size2
   339 018CE 1BFF C        	XOR			A,@CMOS_SIZE
   340 018CF 0C83 C        	JBC			R3,2
   341 018D0 16BD C        	JMP			CMOS_Deal_End
   342 018D1 0A35 C        	BS			System_Flag,F_CMOS_First
   343 018D2 12BF C        	CALL		CMOS_Data_Order
   344            C        ;
   345 018D3 0420 C        	MOV			A,CMOS_X1_H
   346 018D4 0076 C        	MOV			CMOS_X1_H_1,A
   347 018D5 1E07 C        	BANK		7
   348 018D6 0060 C        	MOV			CMOS_X1_H_2,A
   349 018D7 006A C        	MOV			CMOS_X1_H_3,A
   350 018D8 0074 C        	MOV			CMOS_X1_H_4,A
   351 018D9 1E05 C        	BANK		5
   352 018DA 0421 C        	MOV			A,CMOS_X1_L
   353 018DB 0077 C        	MOV			CMOS_X1_L_1,A
   354 018DC 1E07 C        	BANK		7
   355 018DD 0061 C        	MOV			CMOS_X1_L_2,A
   356 018DE 006B C        	MOV			CMOS_X1_L_3,A
   357 018DF 0075 C        	MOV			CMOS_X1_L_4,A
   358 018E0 1E05 C        	BANK		5
   359 018E1 0422 C        	MOV			A,CMOS_Y1_H
   360 018E2 0078 C        	MOV			CMOS_Y1_H_1,A
   361 018E3 1E07 C        	BANK		7
   362 018E4 0062 C        	MOV			CMOS_Y1_H_2,A
   363 018E5 006C C        	MOV			CMOS_Y1_H_3,A
   364 018E6 0076 C        	MOV			CMOS_Y1_H_4,A
   365 018E7 1E05 C        	BANK		5
   366 018E8 0423 C        	MOV			A,CMOS_Y1_L
   367 018E9 0079 C        	MOV			CMOS_Y1_L_1,A
   368 018EA 1E07 C        	BANK		7
   369 018EB 0063 C        	MOV			CMOS_Y1_L_2,A
   370 018EC 006D C        	MOV			CMOS_Y1_L_3,A
   371 018ED 0077 C        	MOV			CMOS_Y1_L_4,A
   372 018EE 1E05 C        	BANK		5
   373 018EF 0424 C        	MOV			A,CMOS_Size1
   374 018F0 007A C        	MOV			CMOS_Size1_1,A
   375 018F1 1E07 C        	BANK		7
   376 018F2 0064 C        	MOV			CMOS_Size1_2,A
   377 018F3 006E C        	MOV			CMOS_Size1_3,A
   378 018F4 0078 C        	MOV			CMOS_Size1_4,A
   379 018F5 1E05 C        	BANK		5
   380 018F6 0425 C        	MOV			A,CMOS_X2_H
   381 018F7 007B C        	MOV			CMOS_X2_H_1,A
   382 018F8 1E07 C        	BANK		7
   383 018F9 0065 C        	MOV			CMOS_X2_H_2,A
   384 018FA 006F C        	MOV			CMOS_X2_H_3,A
   385 018FB 0079 C        	MOV			CMOS_X2_H_4,A
   386 018FC 1E05 C        	BANK		5
   387 018FD 0426 C        	MOV			A,CMOS_X2_L
   388 018FE 007C C        	MOV			CMOS_X2_L_1,A
   389 018FF 1E07 C        	BANK		7
   390 01900 0066 C        	MOV			CMOS_X2_L_2,A
   391 01901 0070 C        	MOV			CMOS_X2_L_3,A
   392 01902 007A C        	MOV			CMOS_X2_L_4,A
   393 01903 1E05 C        	BANK		5
   394 01904 0427 C        	MOV			A,CMOS_Y2_H
   395 01905 007D C        	MOV			CMOS_Y2_H_1,A
   396 01906 1E07 C        	BANK		7
   397 01907 0067 C        	MOV			CMOS_Y2_H_2,A
   398 01908 0071 C        	MOV			CMOS_Y2_H_3,A
   399 01909 007B C        	MOV			CMOS_Y2_H_4,A
   400 0190A 1E05 C        	BANK		5
   401 0190B 0428 C        	MOV			A,CMOS_Y2_L
   402 0190C 007E C        	MOV			CMOS_Y2_L_1,A
   403 0190D 1E07 C        	BANK		7
   404 0190E 0068 C        	MOV			CMOS_Y2_L_2,A
   405 0190F 0072 C        	MOV			CMOS_Y2_L_3,A
   406 01910 007C C        	MOV			CMOS_Y2_L_4,A
   407 01911 1E05 C        	BANK		5
   408 01912 0429 C        	MOV			A,CMOS_Size2
   409 01913 007F C        	MOV			CMOS_Size2_1,A
   410 01914 1E07 C        	BANK		7
   411 01915 0069 C        	MOV			CMOS_Size2_2,A
   412 01916 0073 C        	MOV			CMOS_Size2_3,A
   413 01917 007D C        	MOV			CMOS_Size2_4,A
   414 01918 1603 C        	JMP			Average_CMOS_Data
   415 01919      C        Normal_Transmit:
   416 01919 0000 C        	NOP
   417 0191A 0429 C        	MOV			A,CMOS_Size2
   418 0191B 1BFF C        	XOR			A,@CMOS_SIZE
   419 0191C 0C83 C        	JBC			R3,2
   420 0191D 151F C        	JMP			Unkown_Data_Deal
   421 0191E 159A C        	JMP			Invoke_Data_Order
   422 0191F      C        Unkown_Data_Deal:
   423 0191F 043F C        	MOV			A,CMOS_Size2_1
   424 01920 0069 C        	MOV			CMOS_Size2,A
   425 01921 130E C        	CALL		Sum_XY_Median
   426 01922 0DEA C        	JBC			CMOS_XH_Median,7
   427 01923 1533 C        	JMP			Lose_Left_Ray
   428            C        ;-----------------------------------------------------------
   429            C        ;compare CMOS_X1 & CMOS_X_Median,Judge Lose Ray is Left or Right
   430 01924 0420 C        	MOV			A,CMOS_X1_H
   431 01925 0071 C        	MOV			X1H,A
   432 01926 0421 C        	MOV			A,CMOS_X1_L
   433 01927 0072 C        	MOV			X1L,A
   434 01928 042A C        	MOV			A,CMOS_XH_Median
   435 01929 0073 C        	MOV			X2H,A
   436 0192A 042B C        	MOV			A,CMOS_XL_Median
   437 0192B 0074 C        	MOV			X2L,A
   438 0192C 1007 C        	CALL		Compare_Data
   439            C        ;-----------------------------------------------------------
   440 0192D 1D01 C        	SUB			A,@0X01
   441 0192E 0E03 C        	JBS			R3,0
   442 0192F 1571 C        	JMP			Lose_Right_Ray
   443 01930 0E83 C        	JBS			R3,2
   444 01931 1571 C        	JMP			Lose_Right_Ray
   445 01932 1533 C        	JMP			Lose_Left_Ray
   446 01933      C        Lose_Left_Ray:
   447 01933 0421 C        	MOV			A,CMOS_X1_L
   448 01934 0126 C            SUB			A,CMOS_X2_L
   449 01935 03E1 C            ADD			CMOS_X1_L,A
   450 01936 0166 C            SUB			CMOS_X2_L,A
   451 01937 0420 C            MOV			A,CMOS_X1_H
   452 01938 0125 C            SUB			A,CMOS_X2_H
   453 01939 03E0 C            ADD			CMOS_X1_H,A
   454 0193A 0165 C            SUB			CMOS_X2_H,A
   455            C        
   456 0193B 0423 C        	MOV			A,CMOS_Y1_L
   457 0193C 0128 C            SUB			A,CMOS_Y2_L
   458 0193D 03E3 C            ADD			CMOS_Y1_L,A
   459 0193E 0168 C            SUB			CMOS_Y2_L,A
   460 0193F 0422 C            MOV			A,CMOS_Y1_H
   461 01940 0127 C            SUB			A,CMOS_Y2_H
   462 01941 03E2 C            ADD			CMOS_Y1_H,A
   463 01942 0167 C            SUB			CMOS_Y2_H,A
   464            C            
   465 01943 0424 C            MOV			A,CMOS_Size1
   466 01944 0129 C            SUB			A,CMOS_Size2
   467 01945 03E4 C            ADD			CMOS_Size1,A
   468 01946 0000 C            NOP
   469 01947 0169 C            SUB			CMOS_Size2,A
   470            C            
   471            C        ;Count_Minus_Value	Minus_Value_H,Minus_Value_L,CMOS_X2_H,CMOS_X2_L,CMOS_X2_H_1,CMOS_X2_L_1
   472            C        
   473 01948 00EF C        	CLR		Minus_Value_L
   474 01949 00EE C        	CLR		Minus_Value_H
   475 0194A 043C C        	MOV		A,CMOS_X2_L_1
   476 0194B 0126 C        	SUB		A,CMOS_X2_L
   477 0194C 006F C        	MOV		Minus_Value_L,A
   478 0194D 0E03 C        	JBS		R3,0
   479 0194E 01EE C        	DEC		Minus_Value_H
   480 0194F 043B C        	MOV		A,CMOS_X2_H_1
   481 01950 0125 C        	SUB		A,CMOS_X2_H
   482 01951 03EE C        	ADD		Minus_Value_H,A
   483            C        
   484            C        ;Sum_AB		CMOS_X1_H,CMOS_X1_L,CMOS_X1_H_1,CMOS_X1_L_1,Minus_Value_H,Minus_Value_L
   485            C        
   486 01952 00E1 C        	CLR		CMOS_X1_L
   487 01953 00E0 C        	CLR		CMOS_X1_H
   488 01954 0437 C        	MOV		A,CMOS_X1_L_1
   489 01955 03AF C        	ADD		A,Minus_Value_L
   490 01956 0C03 C        	JBC		R3,0
   491 01957 0560 C        	INC		CMOS_X1_H
   492 01958 0061 C        	MOV		CMOS_X1_L,A
   493 01959 0436 C        	MOV		A,CMOS_X1_H_1
   494 0195A 03AE C        	ADD		A,Minus_Value_H
   495 0195B 03E0 C        	ADD		CMOS_X1_H,A
   496            C        
   497            C        ;Count_Minus_Value		Minus_Value_H,Minus_Value_L,CMOS_Y2_H,CMOS_Y2_L,CMOS_Y2_H_1,CMOS_Y2_L_1
   498            C        
   499 0195C 00EF C        	CLR		Minus_Value_L
   500 0195D 00EE C        	CLR		Minus_Value_H
   501 0195E 043E C        	MOV		A,CMOS_Y2_L_1
   502 0195F 0128 C        	SUB		A,CMOS_Y2_L
   503 01960 006F C        	MOV		Minus_Value_L,A
   504 01961 0E03 C        	JBS		R3,0
   505 01962 01EE C        	DEC		Minus_Value_H
   506 01963 043D C        	MOV		A,CMOS_Y2_H_1
   507 01964 0127 C        	SUB		A,CMOS_Y2_H
   508 01965 03EE C        	ADD		Minus_Value_H,A
   509            C        
   510            C        ;Sum_AB		CMOS_Y1_H,CMOS_Y1_L,CMOS_Y1_H_1,CMOS_Y1_L_1,Minus_Value_H,Minus_Value_L	
   511            C        
   512 01966 00E3 C        	CLR		CMOS_Y1_L
   513 01967 00E2 C        	CLR		CMOS_Y1_H
   514 01968 0439 C        	MOV		A,CMOS_Y1_L_1
   515 01969 03AF C        	ADD		A,Minus_Value_L
   516 0196A 0C03 C        	JBC		R3,0
   517 0196B 0562 C        	INC		CMOS_Y1_H
   518 0196C 0063 C        	MOV		CMOS_Y1_L,A
   519 0196D 0438 C        	MOV		A,CMOS_Y1_H_1
   520 0196E 03AE C        	ADD		A,Minus_Value_H
   521 0196F 03E2 C        	ADD		CMOS_Y1_H,A
   522 01970 159C C        	JMP			CMOS_Data_Trans
   523 01971      C        Lose_Right_Ray:
   524            C        
   525            C        ;Count_Minus_Value		Minus_Value_H,Minus_Value_L,CMOS_X1_H,CMOS_X1_L,CMOS_X1_H_1,CMOS_X1_L_1
   526            C        
   527 01971 00EF C        	CLR		Minus_Value_L
   528 01972 00EE C        	CLR		Minus_Value_H
   529 01973 0437 C        	MOV		A,CMOS_X1_L_1
   530 01974 0121 C        	SUB		A,CMOS_X1_L
   531 01975 006F C        	MOV		Minus_Value_L,A
   532 01976 0E03 C        	JBS		R3,0
   533 01977 01EE C        	DEC		Minus_Value_H
   534 01978 0436 C        	MOV		A,CMOS_X1_H_1
   535 01979 0120 C        	SUB		A,CMOS_X1_H
   536 0197A 03EE C        	ADD		Minus_Value_H,A
   537            C        
   538            C        ;Sum_AB				CMOS_X2_H,CMOS_X2_L,CMOS_X2_H_1,CMOS_X2_L_1,Minus_Value_H,Minus_Value_L
   539            C        
   540 0197B 00E6 C        	CLR		CMOS_X2_L
   541 0197C 00E5 C        	CLR		CMOS_X2_H
   542 0197D 043C C        	MOV		A,CMOS_X2_L_1
   543 0197E 03AF C        	ADD		A,Minus_Value_L
   544 0197F 0C03 C        	JBC		R3,0
   545 01980 0565 C        	INC		CMOS_X2_H
   546 01981 0066 C        	MOV		CMOS_X2_L,A
   547 01982 043B C        	MOV		A,CMOS_X2_H_1
   548 01983 03AE C        	ADD		A,Minus_Value_H
   549 01984 03E5 C        	ADD		CMOS_X2_H,A
   550            C        	
   551            C        ;Count_Minus_Value	Minus_Value_H,Minus_Value_L,CMOS_Y1_H,CMOS_Y1_L,CMOS_Y1_H_1,CMOS_Y1_L_1
   552            C        
   553 01985 00EF C        	CLR		Minus_Value_L
   554 01986 00EE C        	CLR		Minus_Value_H
   555 01987 0439 C        	MOV		A,CMOS_Y1_L_1
   556 01988 0123 C        	SUB		A,CMOS_Y1_L
   557 01989 006F C        	MOV		Minus_Value_L,A
   558 0198A 0E03 C        	JBS		R3,0
   559 0198B 01EE C        	DEC		Minus_Value_H
   560 0198C 0438 C        	MOV		A,CMOS_Y1_H_1
   561 0198D 0122 C        	SUB		A,CMOS_Y1_H
   562 0198E 03EE C        	ADD		Minus_Value_H,A
   563            C        
   564            C        ;Sum_AB				CMOS_Y2_H,CMOS_Y2_L,CMOS_Y2_H_1,CMOS_Y2_L_1,Minus_Value_H,Minus_Value_L
   565            C        
   566 0198F 00E8 C        	CLR		CMOS_Y2_L
   567 01990 00E7 C        	CLR		CMOS_Y2_H
   568 01991 042F C        	MOV		A,Minus_Value_L
   569 01992 03BE C        	ADD		A,CMOS_Y2_L_1
   570 01993 0C03 C        	JBC		R3,0
   571 01994 0567 C        	INC		CMOS_Y2_H
   572 01995 0068 C        	MOV		CMOS_Y2_L,A
   573 01996 042E C        	MOV		A,Minus_Value_H
   574 01997 03BD C        	ADD		A,CMOS_Y2_H_1
   575 01998 03E7 C        	ADD		CMOS_Y2_H,A
   576            C        	
   577 01999 159C C        	JMP			CMOS_Data_Trans
   578            C        
   579            C        ;-----------------------------------------------------------
   580 0199A      C        Invoke_Data_Order:	
   581 0199A 12BF C        	CALL		CMOS_Data_Order
   582 0199B 159C C        	JMP			CMOS_Data_Trans
   583            C        ;-----------------------------------------------------------	
   584 0199C      C        CMOS_Data_Trans:
   585 0199C 1E07 C        	BANK		7
   586 0199D 042A C        	MOV			A,CMOS_X1_H_3
   587 0199E 0074 C        	MOV			CMOS_X1_H_4,A
   588 0199F 042B C        	MOV			A,CMOS_X1_L_3
   589 019A0 0075 C        	MOV			CMOS_X1_L_4,A
   590 019A1 042C C        	MOV			A,CMOS_Y1_H_3
   591 019A2 0076 C        	MOV			CMOS_Y1_H_4,A
   592 019A3 042D C        	MOV			A,CMOS_Y1_L_3
   593 019A4 0077 C        	MOV			CMOS_Y1_L_4,A
   594 019A5 042E C        	MOV			A,CMOS_Size1_3
   595 019A6 0078 C        	MOV			CMOS_Size1_4,A
   596 019A7 042F C        	MOV			A,CMOS_X2_H_3
   597 019A8 0079 C        	MOV			CMOS_X2_H_4,A
   598 019A9 0430 C        	MOV			A,CMOS_X2_L_3
   599 019AA 007A C        	MOV			CMOS_X2_L_4,A
   600 019AB 0431 C        	MOV			A,CMOS_Y2_H_3
   601 019AC 007B C        	MOV			CMOS_Y2_H_4,A
   602 019AD 0432 C        	MOV			A,CMOS_Y2_L_3
   603 019AE 007C C        	MOV			CMOS_Y2_L_4,A
   604 019AF 0433 C        	MOV			A,CMOS_Size2_3
   605 019B0 007D C        	MOV			CMOS_Size2_4,A
   606            C        	
   607 019B1 0420 C        	MOV			A,CMOS_X1_H_2
   608 019B2 006A C        	MOV			CMOS_X1_H_3,A
   609 019B3 0421 C        	MOV			A,CMOS_X1_L_2
   610 019B4 006B C        	MOV			CMOS_X1_L_3,A
   611 019B5 0422 C        	MOV			A,CMOS_Y1_H_2
   612 019B6 006C C        	MOV			CMOS_Y1_H_3,A
   613 019B7 0423 C        	MOV			A,CMOS_Y1_L_2
   614 019B8 006D C        	MOV			CMOS_Y1_L_3,A
   615 019B9 0424 C        	MOV			A,CMOS_Size1_2
   616 019BA 006E C        	MOV			CMOS_Size1_3,A
   617 019BB 0425 C        	MOV			A,CMOS_X2_H_2
   618 019BC 006F C        	MOV			CMOS_X2_H_3,A
   619 019BD 0426 C        	MOV			A,CMOS_X2_L_2
   620 019BE 0070 C        	MOV			CMOS_X2_L_3,A
   621 019BF 0427 C        	MOV			A,CMOS_Y2_H_2
   622 019C0 0071 C        	MOV			CMOS_Y2_H_3,A
   623 019C1 0428 C        	MOV			A,CMOS_Y2_L_2
   624 019C2 0072 C        	MOV			CMOS_Y2_L_3,A
   625 019C3 0429 C        	MOV			A,CMOS_Size2_2
   626 019C4 0073 C        	MOV			CMOS_Size2_3,A
   627            C        	
   628 019C5 1E05 C        	BANK		5
   629 019C6 0436 C        	MOV			A,CMOS_X1_H_1
   630 019C7 1E07 C        	BANK		7
   631 019C8 0060 C        	MOV			CMOS_X1_H_2,A
   632 019C9 1E05 C        	BANK		5
   633 019CA 0437 C        	MOV			A,CMOS_X1_L_1
   634 019CB 1E07 C        	BANK		7
   635 019CC 0061 C        	MOV			CMOS_X1_L_2,A
   636 019CD 1E05 C        	BANK		5
   637 019CE 0438 C        	MOV			A,CMOS_Y1_H_1
   638 019CF 1E07 C        	BANK		7
   639 019D0 0062 C        	MOV			CMOS_Y1_H_2,A
   640 019D1 1E05 C        	BANK		5
   641 019D2 0439 C        	MOV			A,CMOS_Y1_L_1
   642 019D3 1E07 C        	BANK		7
   643 019D4 0063 C        	MOV			CMOS_Y1_L_2,A
   644 019D5 1E05 C        	BANK		5
   645 019D6 043A C        	MOV			A,CMOS_Size1_1
   646 019D7 1E07 C        	BANK		7
   647 019D8 0064 C        	MOV			CMOS_Size1_2,A
   648 019D9 1E05 C        	BANK		5
   649 019DA 043B C        	MOV			A,CMOS_X2_H_1
   650 019DB 1E07 C        	BANK		7
   651 019DC 0065 C        	MOV			CMOS_X2_H_2,A
   652 019DD 1E05 C        	BANK		5
   653 019DE 043C C        	MOV			A,CMOS_X2_L_1
   654 019DF 1E07 C        	BANK		7
   655 019E0 0066 C        	MOV			CMOS_X2_L_2,A
   656 019E1 1E05 C        	BANK		5
   657 019E2 043D C        	MOV			A,CMOS_Y2_H_1
   658 019E3 1E07 C        	BANK		7
   659 019E4 0067 C        	MOV			CMOS_Y2_H_2,A
   660 019E5 1E05 C        	BANK		5
   661 019E6 043E C        	MOV			A,CMOS_Y2_L_1
   662 019E7 1E07 C        	BANK		7
   663 019E8 0068 C        	MOV			CMOS_Y2_L_2,A
   664 019E9 1E05 C        	BANK		5
   665 019EA 043F C        	MOV			A,CMOS_Size2_1
   666 019EB 1E07 C        	BANK		7
   667 019EC 0069 C        	MOV			CMOS_Size2_2,A
   668            C        	
   669 019ED 1E05 C        	BANK		5
   670 019EE 0420 C        	MOV			A,CMOS_X1_H
   671 019EF 0076 C        	MOV			CMOS_X1_H_1,A
   672 019F0 0421 C        	MOV			A,CMOS_X1_L
   673 019F1 0077 C        	MOV			CMOS_X1_L_1,A
   674 019F2 0422 C        	MOV			A,CMOS_Y1_H
   675 019F3 0078 C        	MOV			CMOS_Y1_H_1,A
   676 019F4 0423 C        	MOV			A,CMOS_Y1_L
   677 019F5 0079 C        	MOV			CMOS_Y1_L_1,A
   678 019F6 0424 C        	MOV			A,CMOS_Size1
   679 019F7 007A C        	MOV			CMOS_Size1_1,A
   680 019F8 0425 C        	MOV			A,CMOS_X2_H
   681 019F9 007B C        	MOV			CMOS_X2_H_1,A
   682 019FA 0426 C        	MOV			A,CMOS_X2_L
   683 019FB 007C C        	MOV			CMOS_X2_L_1,A
   684 019FC 0427 C        	MOV			A,CMOS_Y2_H
   685 019FD 007D C        	MOV			CMOS_Y2_H_1,A
   686 019FE 0428 C        	MOV			A,CMOS_Y2_L
   687 019FF 007E C        	MOV			CMOS_Y2_L_1,A
   688 01A00 0429 C        	MOV			A,CMOS_Size2
   689 01A01 007F C        	MOV			CMOS_Size2_1,A
   690 01A02 1603 C        	JMP			Average_CMOS_Data
   691            C        ;===========================================================
   692 01A03      C        Average_CMOS_Data:
   693 01A03 0803 C        	BC			STATUS,C
   694            C        ;2009/08/19  (X1*4+X2*4)/8=X1=X2
   695            C        ;---------------------- X Axis Data Deal -------------------
   696 01A04 1E06 C        	BANK		6
   697 01A05 00E7 C        	CLR			CMOS_XPOINT_LOW
   698 01A06 00E8 C        	CLR			CMOS_YPOINT_LOW
   699 01A07 00E9 C        	CLR			CMOS_POINT_HIGH
   700 01A08 1E07 C        	BANK		7
   701 01A09 00FE C        	CLR			Sum_High
   702 01A0A 00FF C        	CLR			Sum_Low
   703 01A0B 042B C        	MOV			A,CMOS_X1_L_3
   704 01A0C 03B5 C        	ADD			A,CMOS_X1_L_4
   705 01A0D 007F C        	MOV			Sum_Low,A
   706 01A0E 0C03 C        	JBC			R3,0
   707 01A0F 057E C        	INC			Sum_High
   708 01A10 042A C        	MOV			A,CMOS_X1_H_3
   709 01A11 03B4 C        	ADD			A,CMOS_X1_H_4
   710 01A12 03FE C        	ADD			Sum_High,A
   711            C        	
   712 01A13 0430 C        	MOV			A,CMOS_X2_L_3
   713 01A14 03BA C        	ADD			A,CMOS_X2_L_4
   714 01A15 0C03 C        	JBC			R3,0
   715 01A16 057E C        	INC			Sum_High
   716 01A17 03FF C        	ADD			Sum_Low,A
   717 01A18 0C03 C        	JBC			R3,0
   718 01A19 057E C        	INC			Sum_High
   719 01A1A 042F C        	MOV			A,CMOS_X2_H_3
   720 01A1B 03B9 C        	ADD			A,CMOS_X2_H_4
   721 01A1C 03FE C        	ADD			Sum_High,A
   722            C        	
   723 01A1D 0421 C        	MOV			A,CMOS_X1_L_2
   724 01A1E 03A6 C        	ADD			A,CMOS_X2_L_2
   725 01A1F 0C03 C        	JBC			R3,0
   726 01A20 057E C        	INC			Sum_High
   727 01A21 03FF C        	ADD			Sum_Low,A
   728 01A22 0C03 C        	JBC			R3,0
   729 01A23 057E C        	INC			Sum_High
   730 01A24 0420 C        	MOV			A,CMOS_X1_H_2
   731 01A25 03A5 C        	ADD			A,CMOS_X2_H_2
   732 01A26 03FE C        	ADD			Sum_High,A
   733            C        	
   734 01A27 1E05 C        	BANK		5
   735 01A28 0437 C        	MOV			A,CMOS_X1_L_1
   736 01A29 03BC C        	ADD			A,CMOS_X2_L_1
   737 01A2A 1E07 C        	BANK		7
   738 01A2B 0C03 C        	JBC			R3,0
   739 01A2C 057E C        	INC			Sum_High
   740 01A2D 03FF C        	ADD			Sum_Low,A
   741 01A2E 0C03 C        	JBC			R3,0
   742 01A2F 057E C        	INC			Sum_High
   743 01A30 1E05 C        	BANK		5
   744 01A31 0436 C        	MOV			A,CMOS_X1_H_1
   745 01A32 03BB C        	ADD			A,CMOS_X2_H_1
   746 01A33 1E07 C        	BANK		7
   747 01A34 03FE C        	ADD			Sum_High,A
   748 01A35 0DFE C        	JBC			Sum_High,7
   749 01A36 1646 C        	JMP			X_CLR_Result
   750 01A37 0803 C        	BC			R3,0
   751 01A38 067E C        	RRC			Sum_High
   752 01A39 067F C        	RRC			Sum_Low
   753 01A3A 0803 C        	BC			R3,0
   754 01A3B 067E C        	RRC			Sum_High
   755 01A3C 067F C        	RRC			Sum_Low
   756 01A3D 0803 C        	BC			R3,0
   757 01A3E 067E C        	RRC			Sum_High
   758 01A3F 067F C        	RRC			Sum_Low
   759 01A40 0000 C        	NOP
   760 01A41 1804 C        	MOV			A,@0X04
   761 01A42 013E C        	SUB			A,Sum_High
   762 01A43 0C03 C        	JBC			R3,0
   763 01A44 1649 C        	JMP			X_Reset_Result
   764 01A45 164D C        	JMP			Average_XData_End
   765 01A46      C        X_CLR_Result:
   766 01A46 00FE C        	CLR			Sum_High
   767 01A47 00FF C        	CLR			Sum_Low
   768 01A48 164D C        	JMP			Average_XData_End
   769 01A49      C        X_Reset_Result:
   770 01A49 18FF C        	MOV			A,@0XFF
   771 01A4A 007F C        	MOV			Sum_Low,A
   772 01A4B 1803 C        	MOV			A,@0X03
   773 01A4C 007E C        	MOV			Sum_High,A
   774 01A4D      C        Average_XData_End:
   775 01A4D 073E C        	SWAPA		Sum_High
   776 01A4E 1E06 C        	BANK		6
   777 01A4F 0269 C        	OR			CMOS_POINT_HIGH,A
   778 01A50 1E07 C        	BANK		7
   779 01A51 043F C        	MOV			A,Sum_Low
   780 01A52 1E06 C        	BANK		6
   781 01A53 0067 C        	MOV			CMOS_XPOINT_LOW,A
   782            C        ;---------------------- Y Axis Data Deal -------------------
   783 01A54 1E07 C        	BANK		7
   784 01A55 00FE C        	CLR			Sum_High
   785 01A56 00FF C        	CLR			Sum_Low
   786 01A57 042D C        	MOV			A,CMOS_Y1_L_3
   787 01A58 03B7 C        	ADD			A,CMOS_Y1_L_4
   788 01A59 007F C        	MOV			Sum_Low,A
   789 01A5A 0C03 C        	JBC			R3,0
   790 01A5B 057E C        	INC			Sum_High
   791 01A5C 042C C        	MOV			A,CMOS_Y1_H_3
   792 01A5D 03B6 C        	ADD			A,CMOS_Y1_H_4
   793 01A5E 03FE C        	ADD			Sum_High,A
   794            C        	
   795 01A5F 0432 C        	MOV			A,CMOS_Y2_L_3
   796 01A60 03BC C        	ADD			A,CMOS_Y2_L_4
   797 01A61 0C03 C        	JBC			R3,0
   798 01A62 057E C        	INC			Sum_High
   799 01A63 03FF C        	ADD			Sum_Low,A
   800 01A64 0C03 C        	JBC			R3,0
   801 01A65 057E C        	INC			Sum_High
   802 01A66 0431 C        	MOV			A,CMOS_Y2_H_3
   803 01A67 03BB C        	ADD			A,CMOS_Y2_H_4
   804 01A68 03FE C        	ADD			Sum_High,A
   805            C        	
   806 01A69 0423 C        	MOV			A,CMOS_Y1_L_2
   807 01A6A 03A8 C        	ADD			A,CMOS_Y2_L_2
   808 01A6B 0C03 C        	JBC			R3,0
   809 01A6C 057E C        	INC			Sum_High
   810 01A6D 03FF C        	ADD			Sum_Low,A
   811 01A6E 0C03 C        	JBC			R3,0
   812 01A6F 057E C        	INC			Sum_High
   813 01A70 0422 C        	MOV			A,CMOS_Y1_H_2
   814 01A71 03A7 C        	ADD			A,CMOS_Y2_H_2
   815 01A72 03FE C        	ADD			Sum_High,A
   816            C        	
   817 01A73 1E05 C        	BANK		5
   818 01A74 0439 C        	MOV			A,CMOS_Y1_L_1
   819 01A75 03BE C        	ADD			A,CMOS_Y2_L_1
   820 01A76 1E07 C        	BANK		7
   821 01A77 0C03 C        	JBC			R3,0
   822 01A78 057E C        	INC			Sum_High
   823 01A79 03FF C        	ADD			Sum_Low,A
   824 01A7A 0C03 C        	JBC			R3,0
   825 01A7B 057E C        	INC			Sum_High
   826 01A7C 1E05 C        	BANK		5
   827 01A7D 0438 C        	MOV			A,CMOS_Y1_H_1
   828 01A7E 03BD C        	ADD			A,CMOS_Y2_H_1
   829 01A7F 1E07 C        	BANK		7
   830 01A80 03FE C        	ADD			Sum_High,A
   831 01A81 0DFE C        	JBC			Sum_High,7
   832 01A82 1692 C        	JMP			Y_CLR_Result
   833 01A83 0803 C        	BC			R3,0
   834 01A84 067E C        	RRC			Sum_High
   835 01A85 067F C        	RRC			Sum_Low
   836 01A86 0803 C        	BC			R3,0
   837 01A87 067E C        	RRC			Sum_High
   838 01A88 067F C        	RRC			Sum_Low
   839 01A89 0803 C        	BC			R3,0
   840 01A8A 067E C        	RRC			Sum_High
   841 01A8B 067F C        	RRC			Sum_Low
   842 01A8C 0000 C        	NOP
   843 01A8D 1803 C        	MOV			A,@0X03
   844 01A8E 013E C        	SUB			A,Sum_High
   845 01A8F 0C03 C        	JBC			R3,0
   846 01A90 1695 C        	JMP			Y_Reset_Result
   847 01A91 1699 C        	JMP			Average_YData_End
   848 01A92      C        Y_CLR_Result:
   849 01A92 00FE C        	CLR			Sum_High
   850 01A93 00FF C        	CLR			Sum_Low
   851 01A94 1699 C        	JMP			Average_YData_End
   852 01A95      C        Y_Reset_Result:
   853 01A95 18FF C        	MOV			A,@0XFF
   854 01A96 007F C        	MOV			Sum_Low,A
   855 01A97 1802 C        	MOV			A,@0X02
   856 01A98 007E C        	MOV			Sum_High,A
   857 01A99      C        Average_YData_End:
   858 01A99 077E C        	SWAP		Sum_High
   859 01A9A 0803 C        	BC			R3,0
   860 01A9B 06FE C        	RLC			Sum_High
   861 01A9C 0803 C        	BC			R3,0
   862 01A9D 06BE C        	RLCA		Sum_High
   863 01A9E 1E06 C        	BANK		6
   864 01A9F 0269 C        	OR			CMOS_POINT_HIGH,A
   865 01AA0 1E07 C        	BANK		7
   866 01AA1 043F C        	MOV			A,Sum_Low
   867 01AA2 1E06 C        	BANK		6
   868 01AA3 0068 C        	MOV			CMOS_YPOINT_LOW,A
   869            C        ;---------------------- Size Deal --------------------------
   870 01AA4 1E07 C        	BANK		7
   871 01AA5 00FF C        	CLR			Sum_Low
   872 01AA6 0424 C        	MOV			A,CMOS_Size1_2
   873 01AA7 03A9 C        	ADD			A,CMOS_Size2_2
   874 01AA8 007F C        	MOV			Sum_Low,A
   875 01AA9 042E C        	MOV			A,CMOS_Size1_3
   876 01AAA 03B3 C        	ADD			A,CMOS_Size2_3
   877 01AAB 03FF C        	ADD			Sum_Low,A
   878 01AAC 0438 C        	MOV			A,CMOS_Size1_4
   879 01AAD 03BD C        	ADD			A,CMOS_Size2_4
   880 01AAE 03FF C        	ADD			Sum_Low,A
   881 01AAF 1E05 C        	BANK		5
   882 01AB0 043A C        	MOV			A,CMOS_Size1_1
   883 01AB1 03BF C        	ADD			A,CMOS_Size2_1
   884 01AB2 1E07 C        	BANK		7
   885 01AB3 03FF C        	ADD			Sum_Low,A
   886 01AB4 0803 C        	BC			R3,0
   887 01AB5 067F C        	RRC			Sum_Low
   888 01AB6 0803 C        	BC			R3,0
   889 01AB7 067F C        	RRC			Sum_Low
   890 01AB8 0803 C        	BC			R3,0
   891 01AB9 067F C        	RRC			Sum_Low
   892 01ABA 043F C        	MOV			A,Sum_Low
   893 01ABB 1E06 C        	BANK		6
   894 01ABC 0269 C        	OR			CMOS_POINT_HIGH,A
   895 01ABD      C        CMOS_Deal_End:
   896 01ABD 0AA1 C        	BS			CMOS_STATUS,F_CMOS_Valid
   897 01ABE 144D C        	JMP			EXIT_CMOS_FUNCTION
   898            C        ;-----------------------------------------------------------
   899            C        ; CMOS Data Order 
   900            C        ;X->
   901            C        ;-----------------------------------------------------------
   902 01ABF      C        CMOS_Data_Order:
   903            C        ;-----------------------------------------------------------
   904            C        ;compare CMOS_X1 & CMOS_X2,Judge IF require change
   905 01ABF 0420 C        	MOV			A,CMOS_X1_H
   906 01AC0 0071 C        	MOV			X1H,A
   907 01AC1 0421 C        	MOV			A,CMOS_X1_L
   908 01AC2 0072 C        	MOV			X1L,A
   909 01AC3 0425 C        	MOV			A,CMOS_X2_H
   910 01AC4 0073 C        	MOV			X2H,A
   911 01AC5 0426 C        	MOV			A,CMOS_X2_L
   912 01AC6 0074 C        	MOV			X2L,A
   913 01AC7 1007 C        	CALL		Compare_Data
   914            C        ;-----------------------------------------------------------
   915 01AC8 0000 C        	NOP
   916 01AC9 1D01 C        	SUB			A,@0X01
   917 01ACA 0E03 C        	JBS			R3,0
   918 01ACB 16CF C        	JMP			Foregone_Y_Axis
   919 01ACC 0E83 C        	JBS			R3,2
   920 01ACD 170D C        	JMP			Data_Order_End
   921 01ACE 16F8 C        	JMP			Exchange_Ray_data
   922 01ACF      C        Foregone_Y_Axis:
   923            C        ;X1=X2,Y11,Y21
   924            C        ;-----------------------------------------------------------
   925            C        ;compare CMOS_Y11 & CMOS_Y21,Judge IF require taxis
   926 01ACF 0438 C        	MOV			A,CMOS_Y1_H_1
   927 01AD0 0071 C        	MOV			X1H,A
   928 01AD1 0439 C        	MOV			A,CMOS_Y1_L_1
   929 01AD2 0072 C        	MOV			X1L,A
   930 01AD3 043D C        	MOV			A,CMOS_Y2_H_1
   931 01AD4 0073 C        	MOV			X2H,A
   932 01AD5 043E C        	MOV			A,CMOS_Y2_L_1
   933 01AD6 0074 C        	MOV			X2L,A
   934 01AD7 1007 C        	CALL		Compare_Data
   935            C        ;-----------------------------------------------------------
   936 01AD8 0000 C        	NOP
   937 01AD9 0070 C        	MOV			Y_Return_Value,A
   938            C        ;-----------------------------------------------------------
   939            C        ;compare CMOS_Y1 & CMOS_Y2,Judge IF require change
   940 01ADA 0422 C        	MOV			A,CMOS_Y1_H
   941 01ADB 0071 C        	MOV			X1H,A
   942 01ADC 0423 C        	MOV			A,CMOS_Y1_L
   943 01ADD 0072 C        	MOV			X1L,A
   944 01ADE 0427 C        	MOV			A,CMOS_Y2_H
   945 01ADF 0073 C        	MOV			X2H,A
   946 01AE0 0428 C        	MOV			A,CMOS_Y2_L
   947 01AE1 0074 C        	MOV			X2L,A
   948 01AE2 1007 C        	CALL		Compare_Data
   949            C        ;-----------------------------------------------------------
   950 01AE3 0000 C        	NOP
   951 01AE4 1D01 C        	SUB			A,@0X01
   952 01AE5 0E03 C        	JBS			R3,0
   953 01AE6 170D C        	JMP			Data_Order_End
   954 01AE7 0E83 C        	JBS			R3,2
   955 01AE8 16EA C        	JMP			Current_Y_Axis_A
   956 01AE9 16F1 C        	JMP			Current_Y_Axis_B
   957 01AEA      C        Current_Y_Axis_A:
   958 01AEA 0430 C        	MOV			A,Y_Return_Value
   959 01AEB 1D01 C        	SUB			A,@0X01
   960 01AEC 0E03 C        	JBS			R3,0
   961 01AED 170D C        	JMP			Data_Order_End
   962 01AEE 0E83 C        	JBS			R3,2
   963 01AEF 170D C        	JMP			Data_Order_End
   964 01AF0 16F8 C        	JMP			Exchange_Ray_data
   965 01AF1      C        Current_Y_Axis_B:
   966 01AF1 0430 C        	MOV			A,Y_Return_Value
   967 01AF2 1D01 C        	SUB			A,@0X01
   968 01AF3 0E03 C        	JBS			R3,0
   969 01AF4 170D C        	JMP			Data_Order_End
   970 01AF5 0E83 C        	JBS			R3,2
   971 01AF6 16F8 C        	JMP			Exchange_Ray_data
   972 01AF7 170D C        	JMP			Data_Order_End
   973 01AF8      C        Exchange_Ray_data:
   974 01AF8 0421 C        	MOV			A,CMOS_X1_L
   975 01AF9 0126 C            SUB			A,CMOS_X2_L
   976 01AFA 03E1 C            ADD			CMOS_X1_L,A
   977 01AFB 0166 C            SUB			CMOS_X2_L,A
   978 01AFC 0420 C            MOV			A,CMOS_X1_H
   979 01AFD 0125 C            SUB			A,CMOS_X2_H
   980 01AFE 03E0 C            ADD			CMOS_X1_H,A
   981 01AFF 0165 C            SUB			CMOS_X2_H,A
   982            C        
   983 01B00 0423 C        	MOV			A,CMOS_Y1_L
   984 01B01 0128 C            SUB			A,CMOS_Y2_L
   985 01B02 03E3 C            ADD			CMOS_Y1_L,A
   986 01B03 0168 C            SUB			CMOS_Y2_L,A
   987 01B04 0422 C            MOV			A,CMOS_Y1_H
   988 01B05 0127 C            SUB			A,CMOS_Y2_H
   989 01B06 03E2 C            ADD			CMOS_Y1_H,A
   990 01B07 0167 C            SUB			CMOS_Y2_H,A
   991            C            
   992 01B08 0424 C            MOV			A,CMOS_Size1
   993 01B09 0129 C            SUB			A,CMOS_Size2
   994 01B0A 03E4 C            ADD			CMOS_Size1,A
   995 01B0B 0169 C            SUB			CMOS_Size2,A
   996            C            
   997 01B0C 170D C            JMP			Data_Order_End	
   998 01B0D      C        Data_Order_End:
   999 01B0D 0012 C        	RET
  1000            C        ;---------------------- sum=(A+B)/2 ------------------------
  1001 01B0E      C        Sum_XY_Median:
  1002 01B0E 00EB C        	CLR			CMOS_XL_Median
  1003 01B0F 00EA C        	CLR			CMOS_XH_Median
  1004 01B10 0437 C        	MOV			A,CMOS_X1_L_1
  1005 01B11 03BC C        	ADD			A,CMOS_X2_L_1
  1006 01B12 006B C        	MOV			CMOS_XL_Median,A
  1007 01B13 0C03 C        	JBC			R3,0
  1008 01B14 056A C        	INC			CMOS_XH_Median
  1009 01B15 0436 C        	MOV			A,CMOS_X1_H_1
  1010 01B16 03BB C        	ADD			A,CMOS_X2_H_1
  1011 01B17 03EA C        	ADD			CMOS_XH_Median,A	
  1012            C        	
  1013 01B18 00ED C        	CLR			CMOS_YL_Median
  1014 01B19 00EC C        	CLR			CMOS_YH_Median
  1015 01B1A 0439 C        	MOV			A,CMOS_Y1_L_1
  1016 01B1B 03BE C        	ADD			A,CMOS_Y2_L_1
  1017 01B1C 006D C        	MOV			CMOS_YL_Median,A
  1018 01B1D 0C03 C        	JBC			R3,0
  1019 01B1E 056C C        	INC			CMOS_YH_Median
  1020 01B1F 0438 C        	MOV			A,CMOS_Y1_H_1
  1021 01B20 03BD C        	ADD			A,CMOS_Y2_H_1
  1022 01B21 03EC C        	ADD			CMOS_YH_Median,A
  1023 01B22 0DEA C        	JBC			CMOS_XH_Median,7
  1024 01B23 1728 C        	JMP			Reload_X_Median
  1025 01B24 0803 C        	BC			R3,0
  1026 01B25 066A C        	RRC			CMOS_XH_Median
  1027 01B26 066B C        	RRC			CMOS_XL_Median
  1028 01B27 172B C        	JMP			Gain_Y_Median
  1029 01B28      C        Reload_X_Median:
  1030 01B28 18FF C        	MOV			A,@0X0FF
  1031 01B29 006B C        	MOV			CMOS_XL_Median,A
  1032 01B2A 006A C        	MOV			CMOS_XH_Median,A
  1033 01B2B      C        Gain_Y_Median:
  1034 01B2B 0DEC C        	JBC			CMOS_YH_Median,7
  1035 01B2C 1731 C        	JMP			Reload_Y_Median
  1036 01B2D 0803 C        	BC			R3,0
  1037 01B2E 066C C        	RRC			CMOS_YH_Median
  1038 01B2F 066D C        	RRC			CMOS_YL_Median
  1039 01B30 1734 C        	JMP			Gain_Median_End
  1040 01B31      C        Reload_Y_Median:
  1041 01B31 18FF C        	MOV			A,@0X0FF
  1042 01B32 006D C        	MOV			CMOS_YL_Median,A
  1043 01B33 006C C        	MOV			CMOS_YH_Median,A
  1044 01B34      C        Gain_Median_End:
  1045 01B34 0012 C        	RET
    17                     include "BMA020drvOnEM78P520.ASM"
     1            C        /*****************************************************************
     2            C        * Filename     :  BMA020drvOnEM78P520.ASM
     3            C        * Author       :  yu.wei
     4            C        * Company      :  ELAN
     5            C        * VERSION      :  1.0
     6            C        * CRYSTAL      :  12MHZ
     7            C        * Creat date   :  2009/8/20
     8            C        * tool ver.    :  WicePlus 2.7
     9            C        * Description  :  modify for code conformity
    10            C        *****************************************************************/
    11            C        ;------------------------------------------------------------
    12            C        BMA020drvOnEM78P520.ASM    EQU    BMA020drvOnEM78P520.ASM
    13            C        
    14            C        include "BMA020drvOnEM78P520.H"
     1            C        /*****************************************************************
     2            C        * Filename     :  BMA020drvOnEM78P520.ASM
     3            C        * Author       :  yu.wei
     4            C        * Company      :  ELAN
     5            C        * VERSION      :  1.0
     6            C        * CRYSTAL      :  12MHZ
     7            C        * Creat date   :  2009/8/20
     8            C        * tool ver.    :  WicePlus 2.7
     9            C        * Description  :  modify for code conformity
    10            C        *****************************************************************/
    11            C        ;------------------------------------------------------------
    12            C        BMA020drvOnEM78P520.H    EQU    BMA020drvOnEM78P520.H
    13            C        
    14            C        ;-------------------------------------------------------------
    15            C        ;-------------------------------------------------------------------
    16            C        
    17            C        
    18            C        
    19            C        ;===================== GS MODULE UART TEST =======================
    20            C        /*
    21            C        GS_FUNCTION:
    22            C        	MOV                 A,@0XF0
    23            C        	MOV                 GS_Preamble,A
    24            C        	MOV                 A,@0X00
    25            C        	MOV                 GS_Command,A
    26            C        	MOV                 A,@0X04
    27            C        	MOV                 GS_Length,A
    28            C        	MOV                 A,@0X17
    29            C        	MOV                 GS_XPOINT_LOW,A	
    30            C        	MOV                 A,@0XD8
    31            C        	MOV                 GS_YPOINT_LOW,A	
    32            C        	MOV                 A,@0XCF
    33            C        	MOV                 GS_ZPOINT_LOW,A	
    34            C        	MOV                 A,@0X0C
    35            C        	MOV                 GS_POINT_HIGH,A	
    36            C        	RET
    37            C        */
    38            C        
    39            C        
    40            C        	ORG			0X1C00
    41            C        ;***********************************************************
    42            C        ;G-Sensor Function Program
    43            C        ;input:	  GS_PARAMETER
    44            C        ;output:  GS_STATUS,GS_XPOINT_LOW,GS_YPOINT_LOW,
    45            C        ;		  GS_ZPOINT_LOW,GS_POINT_HIGH
    46            C        ;***********************************************************
    47 01C00      C        GS_FUNCTION:
    48 01C00 1E04 C        	BANK		4
    49 01C01 0B0A C        	BS			PAIOCR,4
    50 01C02 1E05 C        	BANK		5
    51 01C03 0B0A C        	BS			PAPHCR,4
    52 01C04 1E00 C        	BANK		0
    53 01C05 180C C        	MOV			A,@00001100B
    54 01C06 024A C        	OR			PORTA,A  
    55 01C07 1E02 C        	BANK		2
    56 01C08 1800 C        	MOV			A,@00000000B						; Shift left, SDO delay time: 16clk,
    57 01C09 004C C        	MOV			SPIS, A								; disable open-drain
    58 01C0A 18C9 C        	MOV 		A, @11001001B						;rising edge read data
    59 01C0B 004D C        	MOV 		SPIC, A
    60 01C0C 1E06 C        	BANK		6
    61 01C0D 18C0 C        	MOV			A,@11000000B
    62 01C0E 0244 C        	OR			RSR,A
    63 01C0F 0C22 C        	JBC			GS_PARAMETER,0
    64 01C10 141A C        	JMP			GS_Init
    65 01C11 0CA2 C        	JBC			GS_PARAMETER,2
    66 01C12 148C C        	JMP			Get_GS_Data
    67 01C13 0C62 C        	JBC			GS_PARAMETER,1
    68 01C14 146A C        	JMP			GS_Enter_Sleep
    69 01C15 147B C        	JMP			GS_WakeUP
    70 01C16      C        EXIT_GS_FUNCTION:
    71 01C16 1E02 C        	BANK		2
    72 01C17 184A C        	MOV 		A, @01001010B						;falling edge read data
    73 01C18 004D C        	MOV 		SPIC, A
    74 01C19 0012 C        	RET
    75            C        ;***********************************************************
    76            C        ;GS Initialize
    77            C        ;input:	  GS_PARAMETER
    78            C        ;output:  GS_STATUS
    79            C        ;***********************************************************	
    80 01C1A      C        GS_Init:
    81 01C1A 1E06 C        	BANK		6
    82 01C1B 0C23 C        	JBC			GS_STATUS,F_GS_Init
    83 01C1C 1469 C        	JMP			GS_Init_Exit
    84 01C1D 1E00 C        	BANK		0
    85 01C1E 088A C        	BC			SPI_BUS, F_GS_SS
    86 01C1F 1E06 C        	BANK		6
    87 01C20 180A C        	MOV			A, @0X0A							;address of sleep register is 0X0A 
    88 01C21 1EA0 C        	LCALL		SIM_SPI_WRITE
    88 01C22 181D C        	LCALL		SIM_SPI_WRITE
    89 01C23 1EA0 C        	LCALL		Delay_10us
    89 01C24 1800 C        	LCALL		Delay_10us
    90 01C25 1802 C        	MOV			A, @0X02							;set reset bit=1,sleep bit=0	
    91 01C26 1EA0 C        	LCALL		SIM_SPI_WRITE
    91 01C27 181D C        	LCALL		SIM_SPI_WRITE
    92 01C28 1E00 C        	BANK		0
    93 01C29 0A8A C        	BS			SPI_BUS, F_GS_SS
    94 01C2A 1EA0 C        	LCALL		Delay_10us
    94 01C2B 1800 C        	LCALL		Delay_10us
    95 01C2C 1E00 C        	BANK		0
    96 01C2D 088A C        	BC			SPI_BUS, F_GS_SS
    97 01C2E 1815 C        	MOV			A, @0X15							;address of INT register is 0X15
    98 01C2F 1EA0 C        	LCALL		SIM_SPI_WRITE
    98 01C30 181D C        	LCALL		SIM_SPI_WRITE
    99 01C31 1EA0 C        	LCALL		Delay_10us
    99 01C32 1800 C        	LCALL		Delay_10us
   100 01C33 18C0 C        	MOV			A, @11000000B						;set SPI4,Disable_adv_int
   101 01C34 1EA0 C        	LCALL		SIM_SPI_WRITE
   101 01C35 181D C        	LCALL		SIM_SPI_WRITE
   102 01C36 1E00 C        	BANK		0
   103 01C37 0A8A C        	BS			SPI_BUS, F_GS_SS
   104 01C38 1EA0 C        	LCALL		Delay_10us
   104 01C39 1800 C        	LCALL		Delay_10us
   105 01C3A 1E00 C        	BANK		0
   106 01C3B 088A C        	BC			SPI_BUS, F_GS_SS
   107 01C3C 180B C        	MOV			A, @0X0B							;address of range & bandwidth register is 0X14
   108 01C3D 1EA0 C        	LCALL		SIM_SPI_WRITE	
   108 01C3E 181D C        	LCALL		SIM_SPI_WRITE	
   109 01C3F 1EA0 C        	LCALL		Delay_10us
   109 01C40 1800 C        	LCALL		Delay_10us
   110 01C41 1840 C        	MOV			A,@01000000B
   111 01C42 1EA0 C        	LCALL		SIM_SPI_WRITE
   111 01C43 181D C        	LCALL		SIM_SPI_WRITE
   112 01C44 1E00 C        	BANK		0
   113 01C45 0A8A C        	BS			SPI_BUS, F_GS_SS
   114 01C46 1EA0 C        	LCALL		Delay_10us
   114 01C47 1800 C        	LCALL		Delay_10us
   115 01C48 1E00 C        	BANK		0
   116 01C49 088A C        	BC			SPI_BUS, F_GS_SS
   117 01C4A 1814 C        	MOV			A, @0X14							;address of range & bandwidth register is 0X14
   118 01C4B 1980 C        	OR			A,@10000000B
   119 01C4C 1EA0 C        	LCALL		SIM_SPI_WRITE
   119 01C4D 181D C        	LCALL		SIM_SPI_WRITE
   120 01C4E 1EA0 C        	LCALL		Delay_10us
   120 01C4F 1800 C        	LCALL		Delay_10us
   121 01C50 1EA0 C        	LCALL		SIM_SPI_READ
   121 01C51 182B C        	LCALL		SIM_SPI_READ
   122 01C52 1E00 C        	BANK		0
   123 01C53 0A8A C        	BS			SPI_BUS, F_GS_SS
   124 01C54 1AE0 C        	AND			A,@11100000B						
   125 01C55 1900 C        	OR			A,@00000000B						;rang=2g,bandwidth=25Hz
   126 01C56 1E06 C        	BANK		6
   127 01C57 0073 C        	MOV			DATA_BAK,A
   128 01C58 1E00 C        	BANK		0
   129 01C59 088A C        	BC			SPI_BUS, F_GS_SS
   130 01C5A 1814 C        	MOV			A, @0X14							;address of range & bandwidth register is 0X14
   131 01C5B 1EA0 C        	LCALL		SIM_SPI_WRITE
   131 01C5C 181D C        	LCALL		SIM_SPI_WRITE
   132 01C5D 0000 C        	NOP
   133 01C5E 0000 C        	NOP
   134 01C5F 0000 C        	NOP
   135 01C60 0000 C        	NOP
   136 01C61 0000 C        	NOP
   137 01C62 0433 C        	MOV			A,DATA_BAK
   138 01C63 1EA0 C        	LCALL		SIM_SPI_WRITE
   138 01C64 181D C        	LCALL		SIM_SPI_WRITE
   139            C        	;...
   140 01C65 1E00 C        	BANK		0
   141 01C66 0A8A C        	BS			SPI_BUS, F_GS_SS
   142 01C67 1E06 C        	BANK		6
   143 01C68 0A23 C        	BS			GS_STATUS,F_GS_Init
   144 01C69      C        GS_Init_Exit:
   145 01C69 1416 C        	JMP			EXIT_GS_FUNCTION
   146            C        ;***********************************************************
   147            C        ;GS Enter Sleep
   148            C        ;input:	  GS_PARAMETER
   149            C        ;output:  GS_STATUS
   150            C        ;***********************************************************	
   151 01C6A      C        GS_Enter_Sleep:
   152 01C6A 1E06 C        	BANK		6
   153 01C6B 0C63 C        	JBC			GS_STATUS,F_GS_Sleep
   154 01C6C 147A C        	JMP			GS_Enter_Sleep_Exit
   155 01C6D 1E00 C        	BANK		0
   156 01C6E 088A C        	BC			SPI_BUS, F_GS_SS	
   157 01C6F 180A C        	MOV			A, @0X0A							;address of sleep register is 0X0A 
   158 01C70 1EA0 C        	LCALL		SIM_SPI_WRITE
   158 01C71 181D C        	LCALL		SIM_SPI_WRITE
   159 01C72 1EA0 C        	LCALL		Delay_10us
   159 01C73 1800 C        	LCALL		Delay_10us
   160 01C74 1801 C        	MOV			A, @0X01							;set sleep bit=1	
   161 01C75 1EA0 C        	LCALL		SIM_SPI_WRITE
   161 01C76 181D C        	LCALL		SIM_SPI_WRITE
   162 01C77 0A63 C        	BS			GS_STATUS,F_GS_Sleep
   163 01C78 1E00 C        	BANK		0
   164 01C79 0A8A C        	BS			SPI_BUS, F_GS_SS
   165 01C7A      C        GS_Enter_Sleep_Exit:
   166 01C7A 1416 C        	JMP			EXIT_GS_FUNCTION
   167            C        ;***********************************************************
   168            C        ;GS Wake Up
   169            C        ;input:	  GS_PARAMETER
   170            C        ;output:  GS_STATUS
   171            C        ;***********************************************************	
   172 01C7B      C        GS_WakeUP:
   173 01C7B 1E06 C        	BANK		6
   174 01C7C 0E63 C        	JBS			GS_STATUS,F_GS_Sleep
   175 01C7D 148B C        	JMP			GS_WakeUp_Exit
   176 01C7E 1E00 C        	BANK		0
   177 01C7F 088A C        	BC			SPI_BUS, F_GS_SS
   178 01C80 1815 C        	MOV			A,@0X15							;address of wakeup register is 0X15 
   179 01C81 1EA0 C        	LCALL		SIM_SPI_WRITE
   179 01C82 181D C        	LCALL		SIM_SPI_WRITE
   180 01C83 1EA0 C        	LCALL		Delay_10us
   180 01C84 1800 C        	LCALL		Delay_10us
   181 01C85 18C1 C        	MOV			A,@11000001B
   182 01C86 1EA0 C        	LCALL		SIM_SPI_WRITE
   182 01C87 181D C        	LCALL		SIM_SPI_WRITE
   183 01C88 0863 C        	BC			GS_STATUS,F_GS_Sleep
   184 01C89 1E00 C        	BANK		0
   185 01C8A 0A8A C        	BS			SPI_BUS, F_GS_SS
   186 01C8B      C        GS_WakeUp_Exit:
   187 01C8B 1416 C        	JMP			EXIT_GS_FUNCTION
   188            C        ;***********************************************************
   189            C        ;Get GS Data
   190            C        ;input:	  GS_PARAMETER
   191            C        ;output:  GS_STATUS,GS_XPOINT_LOW,GS_YPOINT_LOW,
   192            C        ;		  GS_ZPOINT_LOW,GS_POINT_HIGH
   193            C        ;***********************************************************
   194 01C8C      C        Get_GS_Data:	
   195 01C8C 1E00 C        	BANK		0
   196 01C8D 088A C        	BC			SPI_BUS,F_GS_SS					;enable Gsensor SPI BUS
   197 01C8E 1802 C        	MOV 		A, @GS_Addr
   198 01C8F 1980 C        	OR 			A, @0X80
   199 01C90 1EA0 C        	LCALL 		SIM_SPI_WRITE
   199 01C91 181D C        	LCALL 		SIM_SPI_WRITE
   200 01C92 1EA0 C        	LCALL		Delay_10us
   200 01C93 1800 C        	LCALL		Delay_10us
   201 01C94 1EA0 C        	LCALL		SIM_SPI_READ
   201 01C95 182B C        	LCALL		SIM_SPI_READ
   202 01C96 0075 C        	MOV			GS_X_Low,A							;get gsensor X low byte
   203 01C97 1EA0 C        	LCALL		Delay_10us
   203 01C98 1800 C        	LCALL		Delay_10us
   204 01C99 1EA0 C        	LCALL		SIM_SPI_READ
   204 01C9A 182B C        	LCALL		SIM_SPI_READ
   205 01C9B 0074 C        	MOV			GS_X_High,A							;get gsensor X high byte(2bit)
   206 01C9C 1EA0 C        	LCALL		Delay_10us
   206 01C9D 1800 C        	LCALL		Delay_10us
   207 01C9E 1EA0 C        	LCALL		SIM_SPI_READ
   207 01C9F 182B C        	LCALL		SIM_SPI_READ
   208 01CA0 0077 C        	MOV			GS_Y_Low,A							;get gsensor Y low byte			
   209 01CA1 1EA0 C        	LCALL		Delay_10us
   209 01CA2 1800 C        	LCALL		Delay_10us
   210 01CA3 1EA0 C        	LCALL		SIM_SPI_READ
   210 01CA4 182B C        	LCALL		SIM_SPI_READ
   211 01CA5 0076 C        	MOV			GS_Y_High,A							;get gsensor Y high byte(2bit)
   212 01CA6 1EA0 C        	LCALL		Delay_10us
   212 01CA7 1800 C        	LCALL		Delay_10us
   213 01CA8 1EA0 C        	LCALL		SIM_SPI_READ
   213 01CA9 182B C        	LCALL		SIM_SPI_READ
   214 01CAA 0079 C        	MOV			GS_Z_Low,A							;get gsensor Z low byte			
   215 01CAB 1EA0 C        	LCALL		Delay_10us
   215 01CAC 1800 C        	LCALL		Delay_10us
   216 01CAD 1EA0 C        	LCALL		SIM_SPI_READ
   216 01CAE 182B C        	LCALL		SIM_SPI_READ
   217 01CAF 0078 C        	MOV			GS_Z_High,A							;get gsensor Z high byte(2bit)
   218 01CB0 1EA0 C        	LCALL		Delay_10us
   218 01CB1 1800 C        	LCALL		Delay_10us
   219 01CB2 1E00 C        	BANK		0
   220 01CB3 0A8A C        	BS			SPI_BUS,F_GS_SS						;disable gsensor SPI BUS
   221 01CB4 1E06 C        	BANK		6
   222 01CB5 1806 C        	MOV			A,@0X06
   223 01CB6 0073 C        	MOV			Cyc_Cnt,A
   224 01CB7      C        XR_LOOP:
   225 01CB7 0803 C        	BC			STATUS,C
   226 01CB8 0674 C        	RRC			GS_X_High
   227 01CB9 0675 C        	RRC			GS_X_Low
   228 01CBA 05F3 C        	DJZ			Cyc_Cnt
   229 01CBB 14B7 C        	JMP			XR_LOOP
   230 01CBC 0435 C        	MOV			A,GS_X_Low
   231 01CBD 006D C        	MOV			GS_XPOINT_LOW,A
   232 01CBE 1806 C        	MOV			A,@0X06
   233 01CBF 0073 C        	MOV			Cyc_Cnt,A
   234 01CC0      C        YR_LOOP:
   235 01CC0 0803 C        	BC			STATUS,C
   236 01CC1 0676 C        	RRC			GS_Y_High
   237 01CC2 0677 C        	RRC			GS_Y_Low
   238 01CC3 05F3 C        	DJZ			Cyc_Cnt
   239 01CC4 14C0 C        	JMP			YR_LOOP
   240 01CC5 0437 C        	MOV			A,GS_Y_Low
   241 01CC6 006E C        	MOV			GS_YPOINT_LOW,A
   242 01CC7 1806 C        	MOV			A,@0X06
   243 01CC8 0073 C        	MOV			Cyc_Cnt,A
   244 01CC9      C        ZR_LOOP:
   245 01CC9 0803 C        	BC			STATUS,C
   246 01CCA 0678 C        	RRC			GS_Z_High
   247 01CCB 0679 C        	RRC			GS_Z_Low
   248 01CCC 05F3 C        	DJZ			Cyc_Cnt
   249 01CCD 14C9 C        	JMP			ZR_LOOP
   250 01CCE 0439 C        	MOV			A,GS_Z_Low
   251 01CCF 006F C        	MOV			GS_ZPOINT_LOW,A
   252 01CD0 00F0 C        	CLR			GS_POINT_HIGH
   253 01CD1 0438 C        	MOV			A,GS_Z_High
   254 01CD2 0270 C        	OR			GS_POINT_HIGH,A
   255 01CD3 0734 C        	SWAPA		GS_X_High
   256 01CD4 0270 C        	OR			GS_POINT_HIGH,A
   257 01CD5 0803 C        	BC			STATUS,C
   258 01CD6 06B6 C        	RLCA		GS_Y_High
   259 01CD7 0073 C        	MOV			DATA_BAK,A
   260 01CD8 06B3 C        	RLCA		DATA_BAK
   261 01CD9 0270 C        	OR			GS_POINT_HIGH,A
   262 01CDA 0000 C        	NOP
   263            C        ;-----------------------------------------------------------
   264            C        ;Gsensor data switch to unsigned int(0000000000~1111111111)
   265            C        ;-----------------------------------------------------------
   266 01CDB      C        SWITCH_X_Data:
   267 01CDB 1802 C        	MOV			A,@0X02
   268 01CDC 0134 C        	SUB			A,GS_X_High
   269 01CDD 0E03 C        	JBS			STATUS,C
   270 01CDE 14E0 C        	JMP			X_Plus
   271 01CDF 14E3 C        	JMP			X_Minus
   272 01CE0      C        X_Plus:
   273 01CE0 1802 C        	MOV			A,@0X02
   274 01CE1 03F4 C        	ADD			GS_X_High,A
   275 01CE2 14E5 C        	JMP			SWITCH_Y_Data
   276 01CE3      C        X_Minus:
   277 01CE3 1802 C        	MOV			A,@0X02
   278 01CE4 0174 C        	SUB			GS_X_High,A
   279 01CE5      C        SWITCH_Y_Data:
   280 01CE5 1802 C        	MOV			A,@0X02
   281 01CE6 0136 C        	SUB			A,GS_Y_High
   282 01CE7 0E03 C        	JBS			STATUS,C
   283 01CE8 14EA C        	JMP			Y_Plus
   284 01CE9 14ED C        	JMP			Y_Minus	
   285 01CEA      C        Y_Plus:
   286 01CEA 1802 C        	MOV			A,@0X02
   287 01CEB 03F6 C        	ADD			GS_Y_High,A
   288 01CEC 14EF C        	JMP			SWITCH_Z_Data	
   289 01CED      C        Y_Minus:	
   290 01CED 1802 C        	MOV			A,@0X02
   291 01CEE 0176 C        	SUB			GS_Y_High,A
   292 01CEF      C        SWITCH_Z_Data:
   293 01CEF 1802 C        	MOV			A,@0X02
   294 01CF0 0138 C        	SUB			A,GS_Z_High
   295 01CF1 0E03 C        	JBS			STATUS,C
   296 01CF2 14F4 C        	JMP			Z_Plus
   297 01CF3 14F7 C        	JMP			Z_Minus	
   298 01CF4      C        Z_Plus:
   299 01CF4 1802 C        	MOV			A,@0X02
   300 01CF5 03F8 C        	ADD			GS_Z_High,A
   301 01CF6 14F9 C        	JMP			GS_Data_Compare	
   302 01CF7      C        Z_Minus:	
   303 01CF7 1802 C        	MOV			A,@0X02
   304 01CF8 0176 C        	SUB			GS_Y_High,A
   305            C        ;-----------------------------------------------------------
   306            C        ;FUNCTION:x/y/z, 					
   307            C        ;GS_Margint		   					
   308            C        ;input:  GS_X_LOW,GS_Y_LOW,GS_Z_LOW,GS_POINT_HIGH		   					
   309            C        ;OUTPUT: F_GS_New								
   310            C        ;-----------------------------------------------------------
   311 01CF9      C        GS_Data_Compare:
   312 01CF9 08A3 C        	BC			GS_STATUS,F_GS_New
   313 01CFA      C        Judge_X_Axis:
   314 01CFA 043B C        	MOV			A,GS_X_Low_BAK
   315 01CFB 0135 C        	SUB			A,GS_X_Low
   316 01CFC 0073 C        	MOV			Minus_Low,A
   317 01CFD 0C03 C        	JBC			STATUS,C
   318 01CFE 1500 C        	JMP			Compare_X_High
   319 01CFF 01F4 C        	DEC			GS_X_High
   320 01D00      C        Compare_X_High:
   321 01D00 043A C        	MOV			A,GS_X_High_BAK
   322 01D01 0134 C        	SUB			A,GS_X_High
   323 01D02 0072 C        	MOV			Minus_High,A
   324 01D03 0C03 C        	JBC			STATUS,C
   325 01D04 150B C        	JMP			Compare_X_Margin
   326 01D05 04F3 C        	COM			Minus_Low
   327 01D06 04F2 C        	COM			Minus_High
   328 01D07 1801 C        	MOV			A,@0X01
   329 01D08 03F3 C        	ADD			Minus_Low,A
   330 01D09 0C03 C        	JBC			STATUS,C
   331 01D0A 0572 C        	INC			Minus_High
   332 01D0B      C        Compare_X_Margin:
   333 01D0B 0432 C        	MOV			A,Minus_High
   334 01D0C 0E83 C        	JBS			STATUS,Z
   335 01D0D 1543 C        	JMP			Set_New_Flag
   336 01D0E 0433 C        	MOV			A,Minus_Low
   337 01D0F 1D0A C        	SUB			A,@GS_Margin
   338 01D10 0E03 C        	JBS			STATUS,C
   339 01D11 1543 C        	JMP			Set_New_Flag
   340 01D12      C        Judge_Y_Axis:
   341 01D12 043D C        	MOV			A,GS_Y_Low_BAK
   342 01D13 0137 C        	SUB			A,GS_Y_Low
   343 01D14 0073 C        	MOV			Minus_Low,A
   344 01D15 0C03 C        	JBC			STATUS,C
   345 01D16 1518 C        	JMP			Compare_Y_High
   346 01D17 01F6 C        	DEC			GS_Y_High
   347 01D18      C        Compare_Y_High:
   348 01D18 043C C        	MOV			A,GS_Y_High_BAK
   349 01D19 0136 C        	SUB			A,GS_Y_High
   350 01D1A 0072 C        	MOV			Minus_High,A
   351 01D1B 0C03 C        	JBC			STATUS,C
   352 01D1C 1523 C        	JMP			Compare_Y_Margin
   353 01D1D 04F3 C        	COM			Minus_Low
   354 01D1E 04F2 C        	COM			Minus_High
   355 01D1F 1801 C        	MOV			A,@0X01
   356 01D20 03F3 C        	ADD			Minus_Low,A
   357 01D21 0C03 C        	JBC			STATUS,C
   358 01D22 0572 C        	INC			Minus_High
   359 01D23      C        Compare_Y_Margin:
   360 01D23 0432 C        	MOV			A,Minus_High
   361 01D24 0E83 C        	JBS			STATUS,Z
   362 01D25 1543 C        	JMP			Set_New_Flag
   363 01D26 0433 C        	MOV			A,Minus_Low
   364 01D27 1D0A C        	SUB			A,@GS_Margin
   365 01D28 0E03 C        	JBS			STATUS,C
   366 01D29 1543 C        	JMP			Set_New_Flag
   367 01D2A      C        Judge_Z_Axis:
   368 01D2A 043F C        	MOV			A,GS_Z_Low_BAK
   369 01D2B 0139 C        	SUB			A,GS_Z_Low
   370 01D2C 0073 C        	MOV			Minus_Low,A
   371 01D2D 0C03 C        	JBC			STATUS,C
   372 01D2E 1530 C        	JMP			Compare_Z_High
   373 01D2F 01F8 C        	DEC			GS_Z_High
   374 01D30      C        Compare_Z_High:
   375 01D30 043E C        	MOV			A,GS_Z_High_BAK
   376 01D31 0138 C        	SUB			A,GS_Z_High
   377 01D32 0072 C        	MOV			Minus_High,A
   378 01D33 0C03 C        	JBC			STATUS,C
   379 01D34 153B C        	JMP			Compare_Z_Margin
   380 01D35 04F3 C        	COM			Minus_Low
   381 01D36 04F2 C        	COM			Minus_High
   382 01D37 1801 C        	MOV			A,@0X01
   383 01D38 03F3 C        	ADD			Minus_Low,A
   384 01D39 0C03 C        	JBC			STATUS,C
   385 01D3A 0572 C        	INC			Minus_High
   386 01D3B      C        Compare_Z_Margin:
   387 01D3B 0432 C        	MOV			A,Minus_High
   388 01D3C 0E83 C        	JBS			STATUS,Z
   389 01D3D 1543 C        	JMP			Set_New_Flag
   390 01D3E 0433 C        	MOV			A,Minus_Low
   391 01D3F 1D0A C        	SUB			A,@GS_Margin
   392 01D40 0E03 C        	JBS			STATUS,C
   393 01D41 1543 C        	JMP			Set_New_Flag
   394 01D42 1544 C        	JMP			BAK_Data_Updata
   395 01D43      C        Set_New_Flag:
   396 01D43 0AA3 C        	BS			GS_STATUS,F_GS_New
   397 01D44      C        BAK_Data_Updata:
   398 01D44 0434 C        	MOV			A,GS_X_High
   399 01D45 007A C        	MOV			GS_X_High_BAK,A
   400 01D46 0435 C        	MOV			A,GS_X_Low
   401 01D47 007B C        	MOV			GS_X_Low_BAK,A
   402 01D48 0436 C        	MOV			A,GS_Y_High
   403 01D49 007C C        	MOV			GS_Y_High_BAK,A
   404 01D4A 0437 C        	MOV			A,GS_Y_Low
   405 01D4B 007D C        	MOV			GS_Y_Low_BAK,A
   406 01D4C 0438 C        	MOV			A,GS_Z_High
   407 01D4D 007E C        	MOV			GS_Z_High_BAK,A
   408 01D4E 0439 C        	MOV			A,GS_Z_Low
   409 01D4F 007F C        	MOV			GS_Z_Low_BAK,A
   410 01D50      C        Compare_End:
   411 01D50 1416 C        	JMP			EXIT_GS_FUNCTION	
   412            C        ;===========================================================
    18                     
    19                     
    20                     ;-----------------------------------------------------------------
    21                     
    22                     
    23                     ;==================================================================
    24                     ;--------------------------MAIN PROGRAM---------------------------
    25                     	ORG                 0X00
    26 00000 151F          	JMP                 INITIAL
    27                     	ORG                 0X03
    28 00003 1500          	JMP                 TCC_INT
    29                     	ORG                 0X06
    30 00006 1517          	JMP                 EXTERNAL_INT
    31                     	ORG                 0X09
    32 00009 1518          	JMP                 WDT_INT
    33                     	ORG                 0X0C
    34 0000C 151A          	JMP                 TIMER1_INT
    35                     	ORG                 0X0F
    36 0000F 151B          	JMP                 TIMER2_INT
    37                     	ORG                 0X12
    38 00012 1519          	JMP                 AD_INT
    39                     	ORG                 0X15
    40 00015 151C          	JMP                 UART_INT
    41                     	ORG                 0X18
    42 00018 151D          	JMP                 SPI_INT
    43                     	ORG                 0X1B
    44 0001B 151E          	JMP                 LVD_INT
    45                     
    46                     
    47                     	ORG                 0X100
    48                     ;========================= TCC Interrupt Service ==================================
    49 00100               TCC_INT:
    50                   M 	PUSH
       00100 005B     1     MOV  A_TEMP ,A
       00101 075B     1     SWAP  A_TEMP ,
       00102 0703     1     SWAPA  3 ,
       00103 005D     1     MOV  STATUS_TEMP ,A
       00104 0705     1     SWAPA  5 ,
       00105 005C     1     MOV  RSR_TEMP ,A
       00106 00C3     1     CLR  3 ,
    51 00107 1E00          	BANK                0
    52 00108 080F          	BC                  ISR, TCIF				;clear TCC interrupt flag
    53 00109 180E          	MOV                 A,@0B00001110           ; N=25,P=16  Fs=32768  T=12MS
    54 0010A 004D          	MOV                 TWTCR,A
    55 0010B 18CD          	MOV                 A,@(255-50)           ;load initial value
    56 0010C 0041          	MOV                 TCC,A
    57 0010D 1880          	MOV                 A,@0X80      ; (test)P87 exchange when intrrupt
    58 0010E 0348          	XOR                 PORT8,A
    59 0010F 1E06          	BANK                6
    60 00110 0A71          	BS                  TimeDelay12ms/16,TimeDelay12ms%16
    61                   M 	POP
       00111 071D     1     SWAPA  STATUS_TEMP ,
       00112 0043     1     MOV  3 ,A
       00113 071C     1     SWAPA  RSR_TEMP ,
       00114 0045     1     MOV  5 ,A
       00115 071B     1     SWAPA  A_TEMP ,
    62 00116 0013          	RETI
    63                     
    64 00117               EXTERNAL_INT:
    65 00117 0013          	RETI
    66 00118               WDT_INT:
    67 00118 0013          	RETI
    68 00119               AD_INT:
    69 00119 0013          	RETI
    70 0011A               TIMER1_INT:
    71 0011A 0013          	RETI
    72 0011B               TIMER2_INT:
    73 0011B 0013          	RETI
    74 0011C               UART_INT:
    75 0011C 0013          	RETI
    76 0011D               SPI_INT:
    77 0011D 0013          	RETI
    78 0011E               LVD_INT:
    79 0011E 0013          	RETI
    80                     
    81                     ;=======================================================================
    82                     ;============================ Begin Program ============================
    83 0011F               INITIAL:
    84 0011F 0000          	NOP
    85 00120 0011          	DISI
    86 00121 0000          	NOP
    87                   M 	ClrRamBank
       00122 18E0     1     MOV A,@( 224 )
       00123 0044     1     MOV  R4 ,A
       00124 00C5     1     CLR  BSR ,
       00125 0004     1     WDTC 
       00126 00C0     1     CLR  R0 ,
       00127 0544     1     INC  R4 ,
       00128 0404     1     MOV A, R4 
       00129 1A3F     1     AND A,@( 63 )
       0012A 0E83     1     JBS  R3 , Z 
       0012B 1526     1     JMP ( $ - 5 ),
       0012C 0545     1     INC  BSR ,
       0012D 0405     1     MOV A, BSR 
       0012E 1A07     1     AND A,@( 7 )
       0012F 0B44     1     BS  R4 , 5 
       00130 0B84     1     BS  R4 , 6 
       00131 0E83     1     JBS  R3 , 2 
       00132 1525     1     JMP ( $ - 13 ),
       00133 00C4     1     CLR  R4 ,
       00134 0B84     1     BS  R4 , 6 
    88 00135 0000          	NOP
    89 00136 1EA0          	LCALL               IO_INITIAL
    89 00137 0146          	LCALL               IO_INITIAL
***     Warning A053:The call/jmp address is not over page.
    90 00138 0000          	NOP
    91 00139 0010          	ENI
    92                     ;-------------------------------------------------------------
    93 0013A 1E06          	BANK                6
    94 0013B 0871          	BC                  TimeDelay12ms/16,TimeDelay12ms%16
    95                     
    96                     
    97                     ;=============================================================================
    98 0013C               MAIN:
    99                     ;==================================================================	
   100 0013C 1EA0          	LCALL               UART_Transmit_TEST
   100 0013D 1E00          	LCALL               UART_Transmit_TEST
   101 0013E 0000          	NOP
   102                     ;-------------------- time delay 12ms ------------------------
   103 0013F               Time_Delay_12ms:
   104 0013F 1E06          	BANK                6
   105 00140 0E71          	JBS                 TimeDelay12ms/16,TimeDelay12ms%16	
   106 00141 1540          	JMP                 $-1
   107 00142 0000          	NOP	
   108 00143 0000          	NOP
   109 00144 0871          	BC                  TimeDelay12ms/16,TimeDelay12ms%16
   110 00145 153C          	JMP                 MAIN
   111                     
   112                     
   113                     ;*****************************************************************
   114                     ;Function:   IO INITIAL SET
   115                     ;Input:	   None
   116                     ;Output:	   None
   117                     ;*****************************************************************
   118 00146               IO_INITIAL:
   119                     ;================================ TCC config =====================================
   120 00146 1E00          	BANK                0
   121 00147 1807          	MOV                 A,@0X07      	;Set  TCCS=0,tcc source=fM,TPSR2~TPSR0=000(1:1)
   122 00148 004D          	MOV                 TWTCR, A
   123 00149 1805          	MOV                 A,@(255-250)
   124 0014A 0041          	MOV                 TCC,A			;TCC INITIAL VALUE
   125 0014B 1801          	MOV                 A,@0X01
   126 0014C 004E          	MOV                 IMR, A        	;set   TCIE=1  tcc enable interrupt
   127 0014D 00CF          	CLR                 ISR             ;clear interrupt flag
   128 0014E 00CA          	CLR                 PORTA           ;Porta output logic "0"
   129 0014F 1801          	MOV                 A,@0x01
   130 00150 1E01          	BANK                1
   131 00151 00CF          	CLR                 EISR            	;CLEAR EXTERNAL INTERRUPT STATUS REGISTER
   132 00152 00CE          	CLR                 EIMR            	;CLEAR EXTERNAL INTERRUPT MASK  REGISTER
   133                     
   134                     ;==================================PORT A/B======================================
   135 00153 1E04          	BANK                4		        ; POWER ON DISABLE PA PB PULL HIGH
   136 00154 1810          	MOV                 A,@0B00010000   ; Set PA4(SI) as input pin
   137 00155 004A          	MOV                 PAIOCR,A        ; SO/SCK/RF_SS/GS_SS/CMOS_SS  as output pin
   138                     
   139 00156 1E02          	BANK                2
   140 00157 1800          	MOV                 A,@0B00000000   ; Shift left, SDO delay time: 16clk,
   141 00158 004C          	MOV                 SPIS,A          ; disable open-drain
   142 00159 18C9          	MOV                 A,@0B11001001   ; Data shift out falling edge, is on hold during high
   143 0015A 004D          	MOV                 SPIC,A          ; Enable SPI mode, after data output sdo remain low
   144                     
   145 0015B 1E03          	BANK                3
   146 0015C 1820          	MOV                 A,@0B00100000   ; 8-Bit Mode,Fc=12MHz,Baud=57600
   147 0015D 0045          	MOV                 URC,A           ; Disable TXE
   148 0015E 1800          	MOV                 A,@0B00000000
   149 0015F 0046          	MOV                 URS,A           ; disable parity, Odd parity
   150 00160 1E05          	BANK                5
   151 00161 1820          	MOV                 A,@0B00100000   ; Enable uart function
   152 00162 0046          	MOV                 UARC2,A
   153                     ;======================PORT 7/8/9 INITIAL==================================
   154 00163 1800           	MOV                 A,@0B00000000
   155 00164 0048           	MOV                 IOC8,A          ;P87(TEST)Output
   156 00165 1E01           	BANK                1
   157 00166 1800           	MOV                 A,@0B00000000	;Disable LCD common dirver pin
   158 00167 02CA           	AND                 LCDSCR0,A
   159 00168 02CB           	AND                 LCDSCR1,A
   160 00169 02CC           	AND                 LCDSCR2,A
   161 0016A 0012          	RET
  0 Error(s), 1 Warning(s), 0 User Message(s)